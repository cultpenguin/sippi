<?xml version="1.0"?>
<fo:root xmlns:fo="http://www.w3.org/1999/XSL/Format" font-family="serif,Symbol,ZapfDingbats" font-size="10pt" text-align="justify" line-height="normal" font-selection-strategy="character-by-character" line-height-shift-adjustment="disregard-shifts" writing-mode="lr-tb" language="en"><fo:layout-master-set><fo:simple-page-master master-name="blank" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body display-align="center" margin-bottom="0.5in" margin-top="0.5in" margin-left="0in" margin-right="0in" region-name="blank-body"/><fo:region-before region-name="xsl-region-before-blank" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-blank" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-blank" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-blank" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-first" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-odd" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="titlepage-even" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="lot-first" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="lot-odd" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="lot-even" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="front-first" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="front-odd" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="front-even" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="body-first" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="body-odd" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="body-even" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="back-first" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="back-odd" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="back-even" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="1" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="index-first" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-first" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-first" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-first" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-first" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="index-odd" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-odd" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-odd" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-odd" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-odd" precedence="false" extent="0in"/></fo:simple-page-master><fo:simple-page-master master-name="index-even" page-width="8.5in" page-height="11in" margin-top="0.5in" margin-bottom="0.5in" margin-left="1in" margin-right="1in"><fo:region-body margin-bottom="0.5in" margin-top="0.5in" column-gap="12pt" column-count="2" margin-left="0in" margin-right="0in"/><fo:region-before region-name="xsl-region-before-even" extent="0.4in" precedence="true" display-align="before"/><fo:region-after region-name="xsl-region-after-even" extent="0.4in" precedence="true" display-align="after"/><fo:region-start border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-outer-even" precedence="false" extent="0in"/><fo:region-end border-width="0" padding="0" reference-orientation="90" region-name="xsl-region-inner-even" precedence="false" extent="0in"/></fo:simple-page-master><fo:page-sequence-master master-name="titlepage"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="titlepage-first" page-position="first"/><fo:conditional-page-master-reference master-reference="titlepage-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="titlepage-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="lot"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="lot-first" page-position="first"/><fo:conditional-page-master-reference master-reference="lot-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="lot-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="front"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="front-first" page-position="first"/><fo:conditional-page-master-reference master-reference="front-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="front-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="body"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="body-first" page-position="first"/><fo:conditional-page-master-reference master-reference="body-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="body-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="back"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="back-first" page-position="first"/><fo:conditional-page-master-reference master-reference="back-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="back-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master><fo:page-sequence-master master-name="index"><fo:repeatable-page-master-alternatives><fo:conditional-page-master-reference master-reference="blank" blank-or-not-blank="blank"/><fo:conditional-page-master-reference master-reference="index-first" page-position="first"/><fo:conditional-page-master-reference master-reference="index-odd" odd-or-even="odd"/><fo:conditional-page-master-reference odd-or-even="even" master-reference="index-odd"/></fo:repeatable-page-master-alternatives></fo:page-sequence-master></fo:layout-master-set><fo:page-sequence hyphenate="true" master-reference="titlepage" language="en" format="i" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"/></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-inner-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"/></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body"><fo:block id="idm45886875850256"><fo:block><fo:block><fo:block text-align="center" font-size="24.8832pt" space-before="18.6624pt" font-weight="bold" font-family="sans-serif,Symbol,ZapfDingbats"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" keep-with-next.within-column="always" hyphenate="false">SIPPI (v1.5
 - Aug 19, 2016
)</fo:block></fo:block><fo:block space-before="2in" font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" font-size="12pt" text-align="center"><fo:block><fo:block>Thomas Mejer Hansen</fo:block><fo:block>Knud Skou Cordua</fo:block></fo:block></fo:block></fo:block><fo:block><fo:block break-after="page"/><fo:block font-size="14.4pt" font-weight="bold" font-family="sans-serif,Symbol,ZapfDingbats"><fo:block>SIPPI (v1.5
 - Aug 19, 2016
)</fo:block></fo:block><fo:block font-size="10pt"><fo:block>by Thomas Mejer Hansen and Knud Skou Cordua</fo:block></fo:block><fo:block space-before="1em" font-size="10pt"><fo:block>Publication date Aug 19, 2016
</fo:block></fo:block></fo:block><fo:block break-after="page"/></fo:block></fo:block></fo:flow></fo:page-sequence><fo:page-sequence hyphenate="true" master-reference="lot" language="en" format="i" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Example</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Example</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-inner-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="4pc" end-indent="0pt"><fo:block id="toc...idm45886875850256" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block><fo:block><fo:block space-before.minimum="1em" space-before.optimum="1.5em" space-before.maximum="2em" space-after="0.5em" start-indent="0pt" font-size="17.28pt" font-weight="bold" font-family="sans-serif,Symbol,ZapfDingbats">Table of Contents</fo:block></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875836320">About</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875836320"><fo:page-number-citation ref-id="idm45886875836320"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="Installation">1. Installation</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="Installation"><fo:page-number-citation ref-id="Installation"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.Installation" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="InstallSippi">Install SIPPI</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="InstallSippi"><fo:page-number-citation ref-id="InstallSippi"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.InstallSippi" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="SippiGithub">Install SIPPI manually from github</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="SippiGithub"><fo:page-number-citation ref-id="SippiGithub"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="SGEMS">SGeMS (optional)</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="SGEMS"><fo:page-number-citation ref-id="SGEMS"/></fo:basic-link></fo:inline></fo:block></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="chapSippi">2. Setting up SIPPI</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="chapSippi"><fo:page-number-citation ref-id="chapSippi"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.chapSippi" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="chapprior"><fo:inline font-family="monospace">prior</fo:inline>: The a priori model</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="chapprior"><fo:page-number-citation ref-id="chapprior"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.chapprior" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="prior_types">Types of a priori models</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="prior_types"><fo:page-number-citation ref-id="prior_types"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="prior_sampling">Sampling the prior</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="prior_sampling"><fo:page-number-citation ref-id="prior_sampling"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_seq_gibbs">Sequential Gibbs sampling / Conditional Re-sampling</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_seq_gibbs"><fo:page-number-citation ref-id="sec_seq_gibbs"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="chapdata"><fo:inline font-family="monospace">data</fo:inline>: Data and data uncertainties/noise </fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="chapdata"><fo:page-number-citation ref-id="chapdata"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.chapdata" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_meas_noise_gauss">Gaussian measurement noise</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_meas_noise_gauss"><fo:page-number-citation ref-id="sec_meas_noise_gauss"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_model_noise_gauss">Gaussian modeling error</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_model_noise_gauss"><fo:page-number-citation ref-id="sec_model_noise_gauss"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="chapforward"><fo:inline font-family="monospace">forward</fo:inline>: The forward model</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="chapforward"><fo:page-number-citation ref-id="chapforward"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="secTestSetup">Validating <fo:inline font-family="monospace">prior</fo:inline>, <fo:inline font-family="monospace">data</fo:inline>, and <fo:inline font-family="monospace">forward</fo:inline></fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="secTestSetup"><fo:page-number-citation ref-id="secTestSetup"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="chapPosterior">3. Sampling the a posteriori distribution</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="chapPosterior"><fo:page-number-citation ref-id="chapPosterior"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.chapPosterior" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_rejection">The rejection sampler</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_rejection"><fo:page-number-citation ref-id="sec_rejection"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_extendedmetropolis">The extended Metropolis sampler</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_extendedmetropolis"><fo:page-number-citation ref-id="sec_extendedmetropolis"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.sec_extendedmetropolis" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_controling_step_length">Controlling the step length</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_controling_step_length"><fo:page-number-citation ref-id="sec_controling_step_length"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_independentmetropolis">The independent extended Metropolis sampler</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_independentmetropolis"><fo:page-number-citation ref-id="sec_independentmetropolis"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_metropolis_annealing">Annealing schedule</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_metropolis_annealing"><fo:page-number-citation ref-id="sec_metropolis_annealing"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_tempering">Parallel tempering</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_tempering"><fo:page-number-citation ref-id="sec_tempering"/></fo:basic-link></fo:inline></fo:block></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="chapExamples">4. Examples</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="chapExamples"><fo:page-number-citation ref-id="chapExamples"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.chapExamples" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_ex_prior">Examples of A priori models</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_ex_prior"><fo:page-number-citation ref-id="sec_ex_prior"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.sec_ex_prior" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_ex_prior_multi_1d_gauss">Multiple 1D Gaussian prior model</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_ex_prior_multi_1d_gauss"><fo:page-number-citation ref-id="sec_ex_prior_multi_1d_gauss"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_ex_prior_multi_fft_ma_cov">Multivariate Gaussian prior with unknown covariance model properties.</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_ex_prior_multi_fft_ma_cov"><fo:page-number-citation ref-id="sec_ex_prior_multi_fft_ma_cov"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_ex_linefit">Polynomial line fitting</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_ex_linefit"><fo:page-number-citation ref-id="sec_ex_linefit"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.sec_ex_linefit" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="linefit_forward">The forward problem</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="linefit_forward"><fo:page-number-citation ref-id="linefit_forward"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="linefit_data">Reference data, data, forward</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="linefit_data"><fo:page-number-citation ref-id="linefit_data"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875464480">The prior model</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875464480"><fo:page-number-citation ref-id="idm45886875464480"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875459456">Setup and run the Metropolis sampler</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875459456"><fo:page-number-citation ref-id="idm45886875459456"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875451488">Setup and run the rejection sampler</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875451488"><fo:page-number-citation ref-id="idm45886875451488"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_ex_tomography">Cross hole tomography</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_ex_tomography"><fo:page-number-citation ref-id="sec_ex_tomography"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.sec_ex_tomography" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="arrenaes_data">Reference data set from Arrens</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="arrenaes_data"><fo:page-number-citation ref-id="arrenaes_data"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="forward_traveltime">Travel delay computation: The forward problem</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="forward_traveltime"><fo:page-number-citation ref-id="forward_traveltime"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="AM13_gaussian">AM13 Gaussian: Inversion of cross hole GPR data from Arrenaes data with a Gaussian type a priori model</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="AM13_gaussian"><fo:page-number-citation ref-id="AM13_gaussian"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="AM13_gaussian_modeling_error">AM13 Gaussian, accounting for modeling errors</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="AM13_gaussian_modeling_error"><fo:page-number-citation ref-id="AM13_gaussian_modeling_error"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="AM13_bimodal">AM13 Gaussian with bimodal velocity distribution</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="AM13_bimodal"><fo:page-number-citation ref-id="AM13_bimodal"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="AM13_gaussian_covariance_infer">AM13 Gaussian with unknown Gaussian model parameters</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="AM13_gaussian_covariance_infer"><fo:page-number-citation ref-id="AM13_gaussian_covariance_infer"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sec_ex_covarianceinference">Probilistic covariance/semivariogram indeference</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sec_ex_covarianceinference"><fo:page-number-citation ref-id="sec_ex_covarianceinference"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.sec_ex_covarianceinference" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875289904">Specification of covariance model parameters</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875289904"><fo:page-number-citation ref-id="idm45886875289904"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875276960">Inferring a 2D covariance model from the Jura data set - Example of point support</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875276960"><fo:page-number-citation ref-id="idm45886875276960"/></fo:basic-link></fo:inline></fo:block></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875257440">Bibliography</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875257440"><fo:page-number-citation ref-id="idm45886875257440"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="chapReference">5. Reference</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="chapReference"><fo:page-number-citation ref-id="chapReference"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.chapReference" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875169392">SIPPI</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875169392"><fo:page-number-citation ref-id="idm45886875169392"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.idm45886875169392" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_adjust_step_size">sippi_adjust_step_size</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_adjust_step_size"><fo:page-number-citation ref-id="sippi_adjust_step_size"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_anneal_temperature">sippi_anneal_temperature</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_anneal_temperature"><fo:page-number-citation ref-id="sippi_anneal_temperature"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_compute_acceptance_rate">sippi_compute_acceptance_rate</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_compute_acceptance_rate"><fo:page-number-citation ref-id="sippi_compute_acceptance_rate"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_compute_modelization_forward_error">sippi_compute_modelization_forward_error</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_compute_modelization_forward_error"><fo:page-number-citation ref-id="sippi_compute_modelization_forward_error"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_forward">sippi_forward</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_forward"><fo:page-number-citation ref-id="sippi_forward"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_forward_linear">sippi_forward_linear</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_forward_linear"><fo:page-number-citation ref-id="sippi_forward_linear"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_get_resim_data">sippi_get_resim_data</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_get_resim_data"><fo:page-number-citation ref-id="sippi_get_resim_data"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_get_sample">sippi_get_sample</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_get_sample"><fo:page-number-citation ref-id="sippi_get_sample"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_least_squares">sippi_least_squares</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_least_squares"><fo:page-number-citation ref-id="sippi_least_squares"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_likelihood">sippi_likelihood</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_likelihood"><fo:page-number-citation ref-id="sippi_likelihood"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_mcmc_init">sippi_mcmc_init</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_mcmc_init"><fo:page-number-citation ref-id="sippi_mcmc_init"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_metropolis">sippi_metropolis</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_metropolis"><fo:page-number-citation ref-id="sippi_metropolis"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior">sippi_prior</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior"><fo:page-number-citation ref-id="sippi_prior"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior_cholesky">sippi_prior_cholesky</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior_cholesky"><fo:page-number-citation ref-id="sippi_prior_cholesky"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior_dsim">sippi_prior_dsim</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior_dsim"><fo:page-number-citation ref-id="sippi_prior_dsim"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior_init">sippi_prior_init</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior_init"><fo:page-number-citation ref-id="sippi_prior_init"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior_mps">sippi_prior_mps</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior_mps"><fo:page-number-citation ref-id="sippi_prior_mps"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior_plurigaussian">sippi_prior_plurigaussian</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior_plurigaussian"><fo:page-number-citation ref-id="sippi_prior_plurigaussian"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior_set_steplength">sippi_prior_set_steplength</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior_set_steplength"><fo:page-number-citation ref-id="sippi_prior_set_steplength"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior_sisim">sippi_prior_sisim</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior_sisim"><fo:page-number-citation ref-id="sippi_prior_sisim"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior_snesim">sippi_prior_snesim</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior_snesim"><fo:page-number-citation ref-id="sippi_prior_snesim"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior_snesim_std">sippi_prior_snesim_std</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior_snesim_std"><fo:page-number-citation ref-id="sippi_prior_snesim_std"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior_uniform">sippi_prior_uniform</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior_uniform"><fo:page-number-citation ref-id="sippi_prior_uniform"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior_visim">sippi_prior_visim</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior_visim"><fo:page-number-citation ref-id="sippi_prior_visim"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_prior_voronoi">sippi_prior_voronoi</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_prior_voronoi"><fo:page-number-citation ref-id="sippi_prior_voronoi"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_rejection">sippi_rejection</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_rejection"><fo:page-number-citation ref-id="sippi_rejection"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_set_path">sippi_set_path</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_set_path"><fo:page-number-citation ref-id="sippi_set_path"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875169072">SIPPI plotting commands</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875169072"><fo:page-number-citation ref-id="idm45886875169072"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.idm45886875169072" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_colormap">sippi_colormap</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_colormap"><fo:page-number-citation ref-id="sippi_colormap"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_get_posterior_data">sippi_get_posterior_data</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_get_posterior_data"><fo:page-number-citation ref-id="sippi_get_posterior_data"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_current_model">sippi_plot_current_model</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_current_model"><fo:page-number-citation ref-id="sippi_plot_current_model"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_data">sippi_plot_data</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_data"><fo:page-number-citation ref-id="sippi_plot_data"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_defaults">sippi_plot_defaults</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_defaults"><fo:page-number-citation ref-id="sippi_plot_defaults"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_loglikelihood">sippi_plot_loglikelihood</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_loglikelihood"><fo:page-number-citation ref-id="sippi_plot_loglikelihood"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_model">sippi_plot_model</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_model"><fo:page-number-citation ref-id="sippi_plot_model"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_movie">sippi_plot_movie</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_movie"><fo:page-number-citation ref-id="sippi_plot_movie"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_posterior">sippi_plot_posterior</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_posterior"><fo:page-number-citation ref-id="sippi_plot_posterior"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_posterior_2d_marg">sippi_plot_posterior_2d_marg</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_posterior_2d_marg"><fo:page-number-citation ref-id="sippi_plot_posterior_2d_marg"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_posterior_data">sippi_plot_posterior_data</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_posterior_data"><fo:page-number-citation ref-id="sippi_plot_posterior_data"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_posterior_loglikelihood">sippi_plot_posterior_loglikelihood</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_posterior_loglikelihood"><fo:page-number-citation ref-id="sippi_plot_posterior_loglikelihood"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_posterior_sample">sippi_plot_posterior_sample</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_posterior_sample"><fo:page-number-citation ref-id="sippi_plot_posterior_sample"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_prior">sippi_plot_prior</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_prior"><fo:page-number-citation ref-id="sippi_plot_prior"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_prior_movie">sippi_plot_prior_movie</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_prior_movie"><fo:page-number-citation ref-id="sippi_plot_prior_movie"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_prior_sample">sippi_plot_prior_sample</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_prior_sample"><fo:page-number-citation ref-id="sippi_plot_prior_sample"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_set_axis">sippi_plot_set_axis</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_set_axis"><fo:page-number-citation ref-id="sippi_plot_set_axis"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="wiggle">wiggle</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="wiggle"><fo:page-number-citation ref-id="wiggle"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875168816">SIPPI toolbox: Traveltime tomography</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875168816"><fo:page-number-citation ref-id="idm45886875168816"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.idm45886875168816" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="calc_Cd">calc_Cd</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="calc_Cd"><fo:page-number-citation ref-id="calc_Cd"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="eikonal">eikonal</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="eikonal"><fo:page-number-citation ref-id="eikonal"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="eikonal_raylength">eikonal_raylength</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="eikonal_raylength"><fo:page-number-citation ref-id="eikonal_raylength"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="eikonal_traveltime">eikonal_traveltime</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="eikonal_traveltime"><fo:page-number-citation ref-id="eikonal_traveltime"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="kernel_buursink_2d">kernel_buursink_2d</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="kernel_buursink_2d"><fo:page-number-citation ref-id="kernel_buursink_2d"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="kernel_finite_2d">kernel_finite_2d</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="kernel_finite_2d"><fo:page-number-citation ref-id="kernel_finite_2d"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="kernel_fresnel_2d">kernel_fresnel_2d</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="kernel_fresnel_2d"><fo:page-number-citation ref-id="kernel_fresnel_2d"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="kernel_fresnel_monochrome_2d">kernel_fresnel_monochrome_2d</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="kernel_fresnel_monochrome_2d"><fo:page-number-citation ref-id="kernel_fresnel_monochrome_2d"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="kernel_multiple">kernel_multiple</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="kernel_multiple"><fo:page-number-citation ref-id="kernel_multiple"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="kernel_slowness_to_velocity">kernel_slowness_to_velocity</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="kernel_slowness_to_velocity"><fo:page-number-citation ref-id="kernel_slowness_to_velocity"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="mspectrum">mspectrum</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="mspectrum"><fo:page-number-citation ref-id="mspectrum"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="munk_fresnel_2d">munk_fresnel_2d</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="munk_fresnel_2d"><fo:page-number-citation ref-id="munk_fresnel_2d"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="munk_fresnel_3d">munk_fresnel_3d</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="munk_fresnel_3d"><fo:page-number-citation ref-id="munk_fresnel_3d"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="pick_first_arrival">pick_first_arrival</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="pick_first_arrival"><fo:page-number-citation ref-id="pick_first_arrival"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="plot_traveltime_sr">plot_traveltime_sr</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="plot_traveltime_sr"><fo:page-number-citation ref-id="plot_traveltime_sr"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_forward_traveltime">sippi_forward_traveltime</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_forward_traveltime"><fo:page-number-citation ref-id="sippi_forward_traveltime"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_forward_traveltime_example">sippi_forward_traveltime_example</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_forward_traveltime_example"><fo:page-number-citation ref-id="sippi_forward_traveltime_example"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="tomography_kernel">tomography_kernel</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="tomography_kernel"><fo:page-number-citation ref-id="tomography_kernel"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875063120">SIPPI toolbox: 2D Full Waveform GPR modeling</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875063120"><fo:page-number-citation ref-id="idm45886875063120"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.idm45886875063120" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="FDTD_fwi">FDTD_fwi</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="FDTD_fwi"><fo:page-number-citation ref-id="FDTD_fwi"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="LoadTraceM">LoadTraceM</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="LoadTraceM"><fo:page-number-citation ref-id="LoadTraceM"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="ant_geometry">ant_geometry</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="ant_geometry"><fo:page-number-citation ref-id="ant_geometry"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="disc_freq">disc_freq</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="disc_freq"><fo:page-number-citation ref-id="disc_freq"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="distribute_to_cores">distribute_to_cores</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="distribute_to_cores"><fo:page-number-citation ref-id="distribute_to_cores"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="freq_int_diff_1D">freq_int_diff_1D</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="freq_int_diff_1D"><fo:page-number-citation ref-id="freq_int_diff_1D"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="fwi_ant_geometry">fwi_ant_geometry</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="fwi_ant_geometry"><fo:page-number-citation ref-id="fwi_ant_geometry"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="fwi_execute">fwi_execute</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="fwi_execute"><fo:page-number-citation ref-id="fwi_execute"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="fwi_execute_parfor">fwi_execute_parfor</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="fwi_execute_parfor"><fo:page-number-citation ref-id="fwi_execute_parfor"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="image_snapshots">image_snapshots</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="image_snapshots"><fo:page-number-citation ref-id="image_snapshots"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="iseven">iseven</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="iseven"><fo:page-number-citation ref-id="iseven"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="load2Dbin">load2Dbin</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="load2Dbin"><fo:page-number-citation ref-id="load2Dbin"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="load_wavelet">load_wavelet</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="load_wavelet"><fo:page-number-citation ref-id="load_wavelet"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="resize">resize</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="resize"><fo:page-number-citation ref-id="resize"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="save1Dbin">save1Dbin</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="save1Dbin"><fo:page-number-citation ref-id="save1Dbin"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="save2Dbin">save2Dbin</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="save2Dbin"><fo:page-number-citation ref-id="save2Dbin"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="save_wavelet">save_wavelet</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="save_wavelet"><fo:page-number-citation ref-id="save_wavelet"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="setup_input_parameters">setup_input_parameters</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="setup_input_parameters"><fo:page-number-citation ref-id="setup_input_parameters"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="shift_signal">shift_signal</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="shift_signal"><fo:page-number-citation ref-id="shift_signal"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_forward_gpr_fd">sippi_forward_gpr_fd</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_forward_gpr_fd"><fo:page-number-citation ref-id="sippi_forward_gpr_fd"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_gpr_fd_example">sippi_gpr_fd_example</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_gpr_fd_example"><fo:page-number-citation ref-id="sippi_gpr_fd_example"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_plot_data_gpr">sippi_plot_data_gpr</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_plot_data_gpr"><fo:page-number-citation ref-id="sippi_plot_data_gpr"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="velocity_to_eps">velocity_to_eps</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="velocity_to_eps"><fo:page-number-citation ref-id="velocity_to_eps"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="write_parameters_to_screen">write_parameters_to_screen</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="write_parameters_to_screen"><fo:page-number-citation ref-id="write_parameters_to_screen"/></fo:basic-link></fo:inline></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875024048">SIPPI toolbox: Covariance inference</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875024048"><fo:page-number-citation ref-id="idm45886875024048"/></fo:basic-link></fo:inline></fo:block><fo:block id="toc.idm45886875850256.idm45886875024048" margin-left="24pt"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="sippi_forward_covariance_inference">sippi_forward_covariance_inference</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="sippi_forward_covariance_inference"><fo:page-number-citation ref-id="sippi_forward_covariance_inference"/></fo:basic-link></fo:inline></fo:block></fo:block></fo:block></fo:block></fo:flow></fo:page-sequence><fo:page-sequence hyphenate="true" master-reference="lot" language="en" format="i" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Example</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Example</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-inner-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="4pc" end-indent="0pt"><fo:block id="lot...figure...idm45886875850256" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em"><fo:block><fo:block><fo:block space-before.minimum="1em" space-before.optimum="1.5em" space-before.maximum="2em" space-after="0.5em" start-indent="0pt" font-size="17.28pt" font-weight="bold" font-family="sans-serif,Symbol,ZapfDingbats">List of Figures</fo:block></fo:block></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875436704">4.1. Location of boreholes AM1, AM2, AM3, and AM4 at Arrens.</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875436704"><fo:page-number-citation ref-id="idm45886875436704"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875425344">4.2. Ray coverage between wells left) AM1-AM3, middle) AM2-AM4, right) AM1-4.</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875425344"><fo:page-number-citation ref-id="idm45886875425344"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875377216">4.3. AM13: One sample (15 realizations) of the prior (Gaussian) model.</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875377216"><fo:page-number-citation ref-id="idm45886875377216"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="idm45886875372544">4.4. AM13: Data response from one realization of the prior.</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="idm45886875372544"><fo:page-number-citation ref-id="idm45886875372544"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="gaussian_bimodal_sample">4.5. 5 realizations from a FFTMA prior model type with top) Gaussian and b) Bimodal distribution</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="gaussian_bimodal_sample"><fo:page-number-citation ref-id="gaussian_bimodal_sample"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="gaussian_bimodal_dist">4.6. Distribution of one realization using a Gaussian Bimodal target distribution</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="gaussian_bimodal_dist"><fo:page-number-citation ref-id="gaussian_bimodal_dist"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="gaussian_covariance_sample">4.7. A sample from a FFTMA type prior model with varying range_1, range_2, and ang_1.</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="gaussian_covariance_sample"><fo:page-number-citation ref-id="gaussian_covariance_sample"/></fo:basic-link></fo:inline></fo:block><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" text-align-last="justify" text-align="start" end-indent="24pt" last-line-end-indent="-24pt"><fo:inline keep-with-next.within-line="always"><fo:basic-link internal-destination="gaussian_covariance_sample_1d">4.8. Distribution of one sample of a 1D Gaussian distribution describing range_1, range_2, and ang_1</fo:basic-link></fo:inline><fo:inline keep-together.within-line="always"><fo:leader leader-pattern="dots" leader-pattern-width="3pt" leader-alignment="reference-area" padding-left="3pt" padding-right="3pt"/><fo:basic-link internal-destination="gaussian_covariance_sample_1d"><fo:page-number-citation ref-id="gaussian_covariance_sample_1d"/></fo:basic-link></fo:inline></fo:block></fo:block></fo:flow></fo:page-sequence>
  
  

  

  
    <fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="true" master-reference="front" language="en" format="i" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>About</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>About</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-inner-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="4pc" end-indent="0pt"><fo:block id="idm45886875836320"><fo:block><fo:block><fo:block margin-left="0pt" font-size="24.8832pt" font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="10pt" space-before.minimum="10pt * 0.8" space-before.maximum="10pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">About</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
SIPPI is a Matlab toolbox (compatible with GNU Octave) that allows Sampling the solution of non-linear Inverse Problems with realistic a Priori Information.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
In order to make use of SIPPI one has to

<fo:list-block id="idm45886875834336" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45886875833504" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Install and setup SIPPI</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45886875832640" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Define the <fo:basic-link internal-destination="chapprior"><fo:inline>prior model</fo:inline></fo:basic-link>, in form of the prior data structure</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45886875830848" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Define the <fo:basic-link internal-destination="chapforward"><fo:inline>forward model</fo:inline></fo:basic-link>, in form of the forward data structure, and the sippi_forward.m m-file</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45886875829184" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Define the <fo:basic-link internal-destination="chapdata"><fo:inline>data and noise model</fo:inline></fo:basic-link>, in form of the prior data structure</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45886875827472" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Choose a method for <fo:basic-link internal-destination="chapPosterior"><fo:inline>sampling the a posteriori probability density (i.e., solution) of the inverse problem</fo:inline></fo:basic-link>.</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Details about the implementation and the methods implemented in SIPPI can be found in 
[<fo:basic-link internal-destination="HansenetalGibbs2012">HCM12</fo:basic-link>], 
[<fo:basic-link internal-destination="CorduaFWI">CHM12</fo:basic-link>],
[<fo:basic-link internal-destination="sippipart1">HCLM13a</fo:basic-link>],
[<fo:basic-link internal-destination="sippipart2">HCLM13b</fo:basic-link>] and,
[<fo:basic-link internal-destination="hansen2014modelingerror">HCM14</fo:basic-link>].
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
This version of the documentation was compiled on Aug 19, 2016
, and refer to SIPPI version 1.5
.
</fo:block></fo:flow></fo:page-sequence>




  

  
  <fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="true" master-reference="body" language="en" format="1" initial-page-number="1" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Installation</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Installation</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-inner-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="4pc" end-indent="0pt"><fo:block id="Installation"><fo:block font-family="sans-serif,Symbol,ZapfDingbats"><fo:block margin-left="0pt"><fo:block font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="10pt" space-before.minimum="10pt * 0.8" space-before.maximum="10pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Chapter1.Installation</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="InstallSippi"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Install SIPPI</fo:marker><fo:block font-size="20.736pt">Install SIPPI</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The latest stable version  (v 1.5
) of SIPPI can be downloaded from <fo:basic-link external-destination="url(http://sippi.sourceforge.net)"><fo:inline hyphenate="false">http://sippi.sourceforge.net</fo:inline></fo:basic-link> as <fo:basic-link external-destination="url(https://sourceforge.net/projects/sippi/files/latest/download?source=fileshttps://sourceforge.net/projects/sippi/files/latest/download?source=files)">SIPPI.zip</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://sourceforge.net/projects/sippi/files/latest/download?source=fileshttps://sourceforge.net/projects/sippi/files/latest/download?source=files)">https://sourceforge.net/projects/sippi/files/latest/download?source=fileshttps://sourceforge.net/projects/sippi/files/latest/download?source=files</fo:basic-link>]</fo:inline>. This version includes
<fo:basic-link external-destination="url(http://github.com/cultpenghin/mgstat/)">mGstat</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://github.com/cultpenghin/mgstat/)">http://github.com/cultpenghin/mgstat/</fo:basic-link>]</fo:inline>, VISIM,
<fo:basic-link external-destination="url(https://github.com/SCRFpublic/snesim-standalone)">SNESIM</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://github.com/SCRFpublic/snesim-standalone)">https://github.com/SCRFpublic/snesim-standalone</fo:basic-link>]</fo:inline>, and
<fo:basic-link external-destination="url(http://github.com/ergosimulation/mpslib/)">MPSlib(C++)</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://github.com/ergosimulation/mpslib/)">http://github.com/ergosimulation/mpslib/</fo:basic-link>]</fo:inline>.

</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Unpack ZIPPI.zip somewhere, for example to 'c:\Users\tmh\SIPPI'. Then setup the Matlab path to point to the appropriate SIPPI directories by typing:
</fo:block><fo:block id="idm45886875814528" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
addpath c:\Users\tmh\SIPPI
sippi_set_path
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
For use on Windows, no other setup should be needed.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
For use on Linux, no other setup should be needed
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
For use on OS X, Xcode with gcc libraries but be available to run some of the
compiled programs. In addition, the 'DYLD_LIBRARY_PATH' must be set to point to the shared libraries neeeded by the compiled programs for OSX. In Matlab this can be set using:
<fo:block id="idm45886875812656" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
setenv('DYLD_LIBRARY_PATH', '/usr/local/bin');
</fo:block>

</fo:block><fo:block id="SippiGithub"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Install SIPPI manually from github</fo:marker><fo:block font-size="17.28pt">Install SIPPI manually from github</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The current development version  of SIPPI (less stable and documented) is hosted on github and can be downloaded (including  mGstat, SNESIM, VISIM and MPSlib(C++)) 
using git:
<fo:block id="idm45886875848960" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
cd INSTALL_DIR
git clone  https://github.com/cultpenguin/sippi.git SIPPI
git clone  https://github.com/cultpenguin/mgstat.git mGstat
git clone  https://github.com/ergosimulation/mps.git MPS
</fo:block>
Then add a path to both SIPPI, mGstat and MPS in Matlab using
<fo:block id="idm45886875809760" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
&gt;&gt; addpath INSTALL_DIR/mGstat
&gt;&gt; addpath INSTALL_DIR/SIPPI
&gt;&gt; addpath INSTALL_DIR/MPS/matlab
&gt;&gt; sippi_set_path
</fo:block>
</fo:block><fo:block id="idm45886875809120"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Manual compilation</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
SIPPI (optionally) make use of standalone programs from
MPS,
(<fo:basic-link external-destination="url(https://github.com/ergosimulation/mps)">github</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://github.com/ergosimulation/mps)">https://github.com/ergosimulation/mps</fo:basic-link>]</fo:inline>)
SNESIM
(<fo:basic-link external-destination="url(https://github.com/SCRFpublic/snesim-standalone)">github</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://github.com/SCRFpublic/snesim-standalone)">https://github.com/SCRFpublic/snesim-standalone</fo:basic-link>]</fo:inline>)
and mGstat
(VISIM <fo:basic-link external-destination="url(https://github.com/cultpenguin/mgstat)">github</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://github.com/cultpenguin/mgstat)">https://github.com/cultpenguin/mgstat</fo:basic-link>]</fo:inline>)
 .
 Pre-compiled slef-contained binaries are available for windows and Linux, but for use on OS-X one may need to manually these programs
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
These programs are needed to make use of the  <fo:basic-link internal-destination="prior_mps"><fo:inline>MPS</fo:inline></fo:basic-link>, <fo:basic-link internal-destination="prior_visim"><fo:inline>VISIM</fo:inline></fo:basic-link>  and <fo:basic-link internal-destination="prior_snesim"><fo:inline>SNESIM</fo:inline></fo:basic-link> type <fo:basic-link internal-destination="prior_types"><fo:inline>a priori models</fo:inline></fo:basic-link> (and can hence be ignored if not used).
</fo:block><fo:block id="idm45886875802896"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Compiling VISIM</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The source code for VISIM is located in <fo:inline font-family="monospace">mGstat/visim/visim_src</fo:inline>. The compiled program should be placed in <fo:inline font-family="monospace">mGstat/bin</fo:inline> and called <fo:inline font-family="monospace">visim</fo:inline>.
</fo:block></fo:block><fo:block id="idm45886875800304"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Compiling SNESIM</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The source code for SNESIM is available from <fo:basic-link external-destination="url(https://github.com/SCRFpublic/snesim-standalone)">github</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://github.com/SCRFpublic/snesim-standalone)">https://github.com/SCRFpublic/snesim-standalone</fo:basic-link>]</fo:inline>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The compiled program should be placed in <fo:inline font-family="monospace">mGstat/bin</fo:inline> and
called
<fo:inline font-family="monospace">snesim.exe</fo:inline> (windows)
<fo:inline font-family="monospace">snesim_glnxa64.exe</fo:inline> (64 bit Linux)
<fo:inline font-family="monospace">snesim_maci64.exe</fo:inline> (64 but OS X).
.
</fo:block></fo:block><fo:block id="idm45886875796016"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Compiling MPSlib(C++)</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The source code for MPSlib(C++) is available from <fo:basic-link external-destination="url(https://github.com/cultpenguin/mps)">github</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://github.com/cultpenguin/mps)">https://github.com/cultpenguin/mps</fo:basic-link>]</fo:inline>.
To dowload and compile MPSlib(C++) use for example
<fo:block id="idm45886875794320" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
cd INSTALL_DIR
git clone  https://github.com/ergosimulation/mpslib.git MPSLIB
cd MPS
make all
</fo:block>
Matlabs path should be updated to include <fo:inline font-family="monospace">INSTALL_DIR/MPSLIB/matlab</fo:inline>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
</fo:block></fo:block></fo:block></fo:block><fo:block id="SGEMS"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">SGeMS (optional)</fo:marker><fo:block font-size="17.28pt">SGeMS (optional)</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
To make use of the SISIM and SNESIM_STD type prior models, SGeMS needs to be available.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Currently only SGeMS version 2.1 (<fo:basic-link external-destination="url(http://sourceforge.net/projects/sgems/files/sgems/sgems-2.1Beta/sgems_2.1beta_installer.exe/download)">download</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://sourceforge.net/projects/sgems/files/sgems/sgems-2.1Beta/sgems_2.1beta_installer.exe/download)">http://sourceforge.net/projects/sgems/files/sgems/sgems-2.1Beta/sgems_2.1beta_installer.exe/download</fo:basic-link>]</fo:inline>) for Windows is supported by SIPPI
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Support for SGeMS will be discontinued after relevase v1.5, as the <fo:basic-link external-destination="url(http://github.com/cultpenguin/mps/)">MPSlib(C++)</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://github.com/cultpenguin/mps/)">http://github.com/cultpenguin/mps/</fo:basic-link>]</fo:inline> library will be used instead.
</fo:block></fo:block></fo:block></fo:flow></fo:page-sequence>

  
  <fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="true" master-reference="body" language="en" format="1" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Setting up SIPPI</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Setting up SIPPI</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-inner-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="4pc" end-indent="0pt"><fo:block id="chapSippi"><fo:block font-family="sans-serif,Symbol,ZapfDingbats"><fo:block margin-left="0pt"><fo:block font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="10pt" space-before.minimum="10pt * 0.8" space-before.maximum="10pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Chapter2.Setting up SIPPI</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:basic-link internal-destination="sec_ex_tomography"><fo:inline>tomography example</fo:inline></fo:basic-link>
This section contains information about how to use and control SIPPI, which requires one to   
<fo:list-block id="idm45886875785872" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-label-separation="0.2em" provisional-distance-between-starts="1.0em"><fo:list-item id="idm45886875785376" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Define the <fo:basic-link internal-destination="chapprior"><fo:inline>prior model</fo:inline></fo:basic-link>, in form of the prior data structure</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45886875783712" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Define the <fo:basic-link internal-destination="chapforward"><fo:inline>forward model</fo:inline></fo:basic-link>, in form of the forward data structure, and the sippi_forward.m m-file</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45886875782144" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block></fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">Define the <fo:basic-link internal-destination="chapdata"><fo:inline>data and noise model</fo:inline></fo:basic-link>, in form of the prior data structure</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
[For examples of how to apply SIPPI for different problems, see <fo:basic-link internal-destination="chapExamples"><fo:inline>the section with examples</fo:inline></fo:basic-link>].
</fo:block><fo:block id="chapprior"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker"><fo:inline font-family="monospace">prior</fo:inline>: The a priori model</fo:marker><fo:block font-size="20.736pt"><fo:inline font-family="monospace">prior</fo:inline>: The a priori model</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A priori information is defined by the <fo:inline font-family="monospace">prior</fo:inline> Matlab structure. Any number of different types of a priori models can be defined. For example a 1D uniform prior can be defined in <fo:inline font-family="monospace">prior{1}</fo:inline>, and 2D Gaussian prior can be defined in <fo:inline font-family="monospace">prior{2}</fo:inline>.   
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Once a prior data structure has been defined (see examples below), a realization from the prior model can be generated using 
<fo:block id="idm45886875775168" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
m=sippi_prior(prior);
</fo:block>
The realization from the prior can be visualized using 
<fo:block id="idm45886875774752" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
sippi_plot_prior(prior,m);
</fo:block>
A sample (many realizations) from the prior can be visualized using
<fo:block id="idm45886875774304" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
m=sippi_plot_prior_sample(prior);
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
All a priori model types in SIPPI allow to generate a new model in the vicinity of a current model using
<fo:block id="idm45886875773408" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
[m_new,prior]=sippi_prior(prior,m);
</fo:block>
in such a way that the prior model will be sampled if the process is repeated (see <fo:basic-link internal-destination="sec_seq_gibbs"><fo:inline>Sequential Gibbs Sampling</fo:inline></fo:basic-link>).
</fo:block><fo:block id="prior_types"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Types of a priori models</fo:marker><fo:block font-size="17.28pt">Types of a priori models</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Six types of a priori models are available, and can be selected by setting the <fo:inline font-family="monospace">type
</fo:inline> in the <fo:inline font-family="monospace">prior</fo:inline> structure using e.q. <fo:inline font-family="monospace">
prior{1}.type='gaussian'</fo:inline>.  
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="prior_uniform"><fo:inline>UNIFORM</fo:inline></fo:basic-link> type prior specifies an uncorrelated ND uniform model.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="prior_gaussian"><fo:inline>GAUSSIAN</fo:inline></fo:basic-link> type prior specifies a 1D generalized Gaussian model.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="prior_fftma"><fo:inline>FFTMA</fo:inline></fo:basic-link> type prior specifies a 1D-3D Gaussian type a priori model based on the FFT Moving Average method, which is very efficient for unconditional sampling, and for defining a prior Gaussian model with variable/uncertain mean, variance,  ranges, and rotation.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="prior_cholesky"><fo:inline>CHOLESKY</fo:inline></fo:basic-link> type prior specifies a 1D-3D Gaussian type a priori model based on Cholesky decomposition of the covariance model,
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="prior_visim"><fo:inline>VISIM</fo:inline></fo:basic-link> type prior model specifies 1D-3D Gaussian models, utilizing both sequential Gaussian simulation (SGSIM) and direct sequential simulation (DSSIM) that can be conditioned to data of both point- and volume support and linear average data. 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="prior_plurigaussian"><fo:inline>PLURIGAUSSIAN</fo:inline></fo:basic-link> type prior model specifies 1D-3D pluriGaussian. It is a type if truncated Gaussian model that can be used for efficient simulation of categorical values.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="prior_mps"><fo:inline>MPS</fo:inline></fo:basic-link> type prior model specifies a 1D-3D multiple-point-based statistical prior model, based on the  <fo:basic-link external-destination="url(https://github.com/cultpenguin/mps)">MPSlib(C++)</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://github.com/cultpenguin/mps)">https://github.com/cultpenguin/mps</fo:basic-link>]</fo:inline> C++ library. Simulation types includes SNESIM (based on a search tree or list), ENESIM, and GENESIM (generalized ENESIM).
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="prior_snesim"><fo:inline>SNESIM</fo:inline></fo:basic-link> type prior model specifies a 1D-3D multiple-point-based statistical prior model based on the SNESIM code from <fo:basic-link external-destination="url(https://github.com/SCRFpublic/snesim-standalone)">Stanford/SCRF</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://github.com/SCRFpublic/snesim-standalone)">https://github.com/SCRFpublic/snesim-standalone</fo:basic-link>]</fo:inline>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="prior_snesim_std"><fo:inline>SNESIM_STD</fo:inline></fo:basic-link> is similar to the 'SNESIM' type prior, but is based on <fo:basic-link internal-destination="SGEMS"><fo:inline>SGEMS</fo:inline></fo:basic-link>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The following section documents the properties of each type of prior model.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Examples of using different types of prior models or combining prior models can be found in the <fo:basic-link internal-destination="sec_ex_prior"><fo:inline>examples section</fo:inline></fo:basic-link>. 
</fo:block><fo:block id="prior_uniform"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Uniform distribution</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A uniform prior model can be specified using the 'uniform' type prior model
</fo:block><fo:block id="idm45886875749632" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{1}.type='uniform';
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The only parameters needed are the minimum (<fo:inline font-family="monospace">min</fo:inline>) and maximum (<fo:inline font-family="monospace">max</fo:inline>) values. A 1D uniform distribution between -1 and 1 can be specified as 
</fo:block><fo:block id="idm45886875747712" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{1}.type='uniform';
prior{1}.min=-1;
prior{1}.max=1;
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
By setting the <fo:inline font-family="monospace">x</fo:inline>, <fo:inline font-family="monospace">y</fo:inline>, and <fo:inline font-family="monospace">z</fo:inline> parameter, a higher order prior (uncorrelated) can be set. For example 3 independent model parameters with a uniform prior distribution between 20 and 50, can be defined as
</fo:block><fo:block id="idm45886875745312" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{1}.type='uniform';
prior{1}.x=[1 2 3];
prior{1}.min=20;
prior{1}.max=50;
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Note that using the 'uniform' type priori model, is slightly more computational efficient than using a '<fo:basic-link internal-destination="prior_gaussian"><fo:inline>gaussian</fo:inline></fo:basic-link>' type prior model with a high norm.
</fo:block></fo:block><fo:block id="prior_gaussian"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">1D Generalized Gaussian</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A 1D generalized Gaussian prior model can be specified using the 'gaussian' type prior model
</fo:block><fo:block id="idm45886875741424" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{1}.type='gaussian';
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A simple  1D Gaussian distribution with mean 10, and standard deviation 2, can be specified using
</fo:block><fo:block id="idm45886875740448" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
ip=1;
prior{ip}.type='gaussian';
prior{ip}.m0=10;
prior{ip}.std=2;
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The norm of a generalized Gaussian can be set using the 'norm' field. A generalized 1D Gaussian with mean 10, standard deviation of 2, and a norm of 70, can be specified using 
(The norm is equivalent to the beta factor referenced in <fo:basic-link external-destination="url(http://en.wikipedia.org/wiki/Generalized_normal_distribution)">Wikipedia:Generalized_normal_distribution</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://en.wikipedia.org/wiki/Generalized_normal_distribution)">http://en.wikipedia.org/wiki/Generalized_normal_distribution</fo:basic-link>]</fo:inline>)
</fo:block><fo:block id="idm45886875738704" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
ip=2;
prior{ip}.type='gaussian';
prior{ip}.m0=10;
prior{ip}.std=2;
prior{ip}.norm=70;
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A 1D distribution with an arbitrary shape can be defined by setting <fo:inline font-family="monospace">d_target</fo:inline>, which must contain a sample of the distribution that one would like to replicate. For example, to generate a sample from a non-symmetric bimodal distribution, one can use e.g.
</fo:block><fo:block id="idm45886875737136" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
% Create target distribution
N=10000;
prob_chan=0.3;
d1=randn(1,ceil(N*(1-prob_chan)))*.5+8.5;
d2=randn(1,ceil(N*(prob_chan)))*.5+11.5;
d_target=[d1(:);d2(:)];

% set the target distribution
ip=3;
prior{ip}.type='gaussian';
prior{ip}.d_target=d_target;
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The following figure shows the 1D histogram of a sample, consisting of 8000 realizations, generated using 
<fo:block id="idm45886875736016" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
sippi_plot_prior_sample(prior,1:ip,8000);
</fo:block>
</fo:block><fo:block id="idm45886875735408"><fo:external-graphic src="url(figures/prior_gaussian_1d.png)" width="100%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block><fo:block id="prior_fftma"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">FFTMA - 3D Gaussian model</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The FFT moving average method provides an efficient approach for computing unconditional realizations of a Gaussian random field.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The mean and the covariance model must be specified in the <fo:inline font-family="monospace">m0</fo:inline> and <fo:inline font-family="monospace">Cm</fo:inline> fields. The format for describing the covariance model follows 'gstat' notation, and is described in more details in the <fo:basic-link external-destination="url(http://mgstat.sourceforge.net/htmldoc/Spatial.html)">mGstat manual</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://mgstat.sourceforge.net/htmldoc/Spatial.html)">http://mgstat.sourceforge.net/htmldoc/Spatial.html</fo:basic-link>]</fo:inline>.  
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A 2D covariance model with mean 10, and a Spherical type covariance model can be defined in a 101x101 size grid (1 unit (e.g., meters) between the cells) using
</fo:block><fo:block id="idm45886875727424" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=1;
prior{im}.type='FFTMA';
prior{im}.x=[0:1:100];
prior{im}.y=[0:1:100];
prior{im}.m0=10;
prior{im}.Cm='1 Sph(10)';
</fo:block><fo:block id="idm45886875726896"><fo:external-graphic src="url(figures/prior_fftma_2d_gaussian.png)" width="100%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Optionally one can translate the output of the Gaussian simulation into an arbitrarily shaped 'target' distribution, using normal score transformation. Note that this transformation will ensure a certain 1D distribution of the model parameters to be reproduced, but will alter the assumed covariance model such that the properties of covariance model are not necessarily reproduced. To ensure that both the covariance model properties and the 1D distribution are reproduced, make use of the VISIM type prior model instead because it utilizes direct sequential simulation. 
</fo:block><fo:block id="idm45886875722896" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=1;
prior{im}.type='FFTMA';
prior{im}.x=[0:1:100];
prior{im}.y=[0:1:100];
prior{im}.Cm='1 Sph(10)';

% Create target distribution
N=10000;
prob_chan=0.5;
d1=randn(1,ceil(N*(1-prob_chan)))*.5+8.5;
d2=randn(1,ceil(N*(prob_chan)))*.5+11.5;
d_target=[d1(:);d2(:)];
prior{im}.d_target=d_target;
prior{im}.m0=0; % to make sure no trend model is assumed.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Alternatively, the normal score transformation can be defined manually such that the tail behavior can be controlled:
</fo:block><fo:block id="idm45886875721632" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
N=10000;
prob_chan=0.5;
d1=randn(1,ceil(N*(1-prob_chan)))*.5+8.5;
d2=randn(1,ceil(N*(prob_chan)))*.5+11.5;
d_target=[d1(:);d2(:)];
[d_nscore,o_nscore]=nscore(d_target,1,1,min(d_target),max(d_target),0);
prior{im}.o_nscore=o_nscore;
</fo:block><fo:block id="idm45886875720992"><fo:external-graphic src="url(figures/prior_fftma_2d_target.png)" width="100%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block><fo:block id="prior_fftma_variable_par"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">FFTMA - 3D Gaussian model wuth variable model properties</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The FFTMA method also allows treating the parameters defining the Gaussian model, such as the mean, variance, ranges and angles of rotation as a priori model parameters (that can be inferred as part of inversion, see e.g. <fo:basic-link internal-destination="sec_ex_prior_multi_fft_ma_cov"><fo:inline>an example</fo:inline></fo:basic-link>).
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
First a prior type defining the Gaussian model must be defined (exactly as listed <fo:basic-link internal-destination="prior_fftma"><fo:inline>above</fo:inline></fo:basic-link>):
<fo:block id="idm45886875714608" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=im+1; 
prior{im}.type='FFTMA';
prior{im}.x=[0:.1:10]; % X array 
prior{im}.y=[0:.1:20]; % Y array 
prior{im}.m0=10;
prior{im}.Cm='1 Sph(10,90,.25)';
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Now, all parameter such as the mean, variance, ranges and angles of rotations, can be randomized by defining a 1D a priori model type ('uniform' or 'gaussian'), and with a specific 'name' indicating the parameter (see <fo:basic-link internal-destination="sec_ex_prior_multi_fft_ma_cov"><fo:inline>this example</fo:inline></fo:basic-link> for a complete list of names), and by assigning the <fo:inline font-family="monospace">prior_master</fo:inline> field that points the prior model id for which the parameters should randomized.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"> 
For example the range along the direction of maximum continuty can be randomized by defining a prior entry named 'range_1', and settting the <fo:inline font-family="monospace">prior_master</fo:inline> to point to the prior with id 1:
<fo:block id="idm45886875711280" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=2;
prior{im}.type='uniform';
prior{im}.name='range_1';
prior{im}.min=2;
prior{im}.max=14;
prior{im}.prior_master=1;
I this case the range is randomized following a uniform distribution U[2,14].
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Likewise, the first angle of rotation can be randomized using for example
<fo:block id="idm45886875710112" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=3;
prior{im}.type='gaussian';
prior{im}.name='ang_1';
prior{im}.m0=90;
prior{im}.std=10;
prior{im}.prior_master=1;
</fo:block>
A sample from such a prior type model will thus show variability also in the range and angle of rotation, as seen here 
<fo:block id="idm45886875710304"><fo:external-graphic src="url(figures/prior_reals_fftma_cov.png)" width="100%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block>


</fo:block></fo:block><fo:block id="prior_visim"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">VISIM</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
</fo:block><fo:block id="idm45886875704640" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=im+1;
prior{im}.type='VISIM';
prior{im}.x=[0:1:100];
prior{im}.y=[0:1:100];
prior{im}.m0=10;
prior{im}.Cm='1 Sph(10)';
</fo:block><fo:block id="idm45886875704112"><fo:external-graphic src="url(figures/prior_visim_2d_gaussian.png)" width="100%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
As with the FFTMA prior model the VISIM prior can make use of a target distribution. However, if a target distribution is set, the use of the VISIM prior model will utilize direct sequential simulation, which will ensure both histogram and covariance reproduction. 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Using a target distribution together with the VISIM prior model is similar to that for the FFTMA prior model. Simply the <fo:inline font-family="monospace">type</fo:inline> has to be changed from FFTMA to VISIM:
</fo:block><fo:block id="idm45886875699664" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
clear all;close all;
im=1;
prior{im}.type='VISIM';
prior{im}.x=[0:1:40];
prior{im}.y=[0:1:40];
prior{im}.m0=10;
prior{im}.Cm='1 Sph(10)';

% Create target distribution
N=10000;
prob_chan=0.5;
d1=randn(1,ceil(N*(1-prob_chan)))*.5+8.5;
d2=randn(1,ceil(N*(prob_chan)))*.5+11.5;
d_target=[d1(:);d2(:)];
prior{im}.d_target=d_target;
</fo:block><fo:block id="idm45886875698928"><fo:external-graphic src="url(figures/prior_visim_2d_target.png)" width="100%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block><fo:block id="prior_cholesky"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">CHOLESKY - 3D Gaussian model</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The CHOLESKY type prior utilizes Cholesky decomposition of the covariance in order to generate realizations of a Gaussian random field. The CHOLESKY type prior needs a full description of the covariance model, which will be of size [nxyz*nxyz*nxyz],  unlike using the <fo:basic-link internal-destination="prior_fftma"><fo:inline>FFTMA</fo:inline></fo:basic-link> type prior model that only needs a specification of an isotropic covariance models of size [1,nxyz]. Hence, the CHOLESKY type prior is much more demanding on memory, and CPU. However, the CHOLESKY type prior can be used to sample from any covariance model, also non-stationary covariance model.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The CHOLESKY model is can be defined almost identically to the <fo:basic-link internal-destination="prior_fftma"><fo:inline>FFTMA</fo:inline></fo:basic-link> type prior model. As an example: 
</fo:block><fo:block id="idm45886875691472" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=1;
prior{im}.type='CHOLESKY';
prior{im}.x=[0:2:100];
prior{im}.y=[0:2:100];
prior{im}.m0=10;
prior{im}.Cm='1 Sph(10)';
</fo:block><fo:block id="idm45886875690800"><fo:external-graphic src="url(figures/prior_cholesky_2d.png)" width="100%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
the use of <fo:inline font-family="monospace">d_target</fo:inline> to specify target distributions is also possible, using the same style as for the <fo:basic-link internal-destination="prior_fftma"><fo:inline>FFTMA</fo:inline></fo:basic-link> type prior.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Be warned that the 'cholesky' type prior model is much more memory demanding than the 'fftma' and 'visim' type prior models, as a full nxyz*nxyz covariance model needs to setup (and inverted). Thus, the 'cholesky' type prior is mostly applicable when the number of model parameters (nx*ny*nx) is small.
</fo:block></fo:block><fo:block id="prior_plurigaussian"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">PluriGaussian - ND truncated Gaussian</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Plurigaussian simulation is a type og truncated Gaussian simulation. It works by generating a number of realizations of Gassuan models, each with a sepcific choice of covariance model. Using a transformation map, the Gaussian realizations are then converted into disrete units.
</fo:block><fo:block id="prior_plurigaussian_1"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">PluriGaussian based on 1 Gaussian</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
  A simple example using 1 Gaussian realization, one must specify one covariance model one plurigaussian transformation map through the two fields <fo:inline font-family="monospace">prior{1}.pg_prior{1}.Cm</fo:inline>(or <fo:inline font-family="monospace">Cm</fo:inline>) and <fo:inline font-family="monospace">prior{1}.pg_map</fo:inline>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The covariance model is defined as for any other Gaussian based models, and can include anisotropy. In general, the variance (sill) should be 1. Unless set othwerwise, the mean is assumed to be zero.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The values in the transformation map is implicitly assumed to define boundaries along a linear scale from -3 to 3. As there are 7 entries (see below) in the transformation map, each number in the transformation map corresponds to [-3,-2,-1,0,1,2,3] respectively. The figure below show what unit id's any Gaussian realized value will be transformed to.
</fo:block><fo:block id="idm45886875679712" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=im+1;
prior{im}.name='Plurigaussian'; % [optional] specifies name to prior
prior{im}.type='plurigaussian';                % the type of a priori model
prior{im}.x=[0:1:100];                 % specifies the scales of the 1st (X) dimension
prior{im}.y=[10:1:90];                 % specifies the scales of the 2nd (Y) dimension
prior{im}.Cm='1 Gau(10)'; % or next line
prior{im}.pg_prior{1}.Cm=' 1 Gau(10)';
prior{im}.pg_map=[0 0  1 1 0  2 2];
[m,prior]=sippi_prior(prior);          % generate a realization from the prior model
sippi_plot_prior_sample(prior,im,5)
print_mul('prior_example_2d_plurigaussian_1')
figure;
pg_plot(prior{im}.pg_map,prior{im}.pg_limits);
colormap(sippi_colormap);
print_mul('prior_example_2d_plurigaussian_1_pgmap')
</fo:block><fo:block id="idm45886875678560"><fo:external-graphic src="url(figures/prior_example_2d_plurigaussian_1.png)" width="100%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block><fo:block id="idm45886875677120"><fo:external-graphic src="url(figures/prior_example_2d_plurigaussian_1_pgmap.png)" width="30%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block><fo:block id="prior_plurigaussian_2"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">PluriGaussian based on 2 Gaussians</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Plurigaussian truncation can be based on more than one Gaussian realization, In the example below, two Gaussian realization are used, and therefore a transformation map needs to be defined. Each dimension of the transformation map corresponds to values of the Gaussian realization between -3 and 3. The transformation maps is visualized below.
</fo:block><fo:block id="idm45886875671088" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=1;
prior{im}.name='Plurigaussian'; % [optional] specifies name to prior
prior{im}.type='plurigaussian';                % the type of a priori model
prior{im}.x=[0:1:100];                 % specifies the scales of the 1st (X) dimension
prior{im}.y=[10:1:90];                 % specifies the scales of the 2nd (Y) dimension
prior{im}.pg_prior{1}.Cm=' 1 Gau(10)';
prior{im}.pg_prior{2}.Cm=' 1 Sph(10,35,.4)';
prior{im}.pg_map=[0 0 0 1 1; 1 2 0 1 1; 1 1 1 3 3];
[m,prior]=sippi_prior(prior);          % generate a realization from the prior model
sippi_plot_prior_sample(prior,im,5)
print_mul('prior_example_2d_plurigaussian_2')

figure;
pg_plot(prior{im}.pg_map,prior{im}.pg_limits);
set(gca,'FontSize',16)
colormap(sippi_colormap);
print_mul('prior_example_2d_plurigaussian_2_pgmap') 
</fo:block><fo:block id="idm45886875669904"><fo:external-graphic src="url(figures/prior_example_2d_plurigaussian_2.png)" width="100%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block><fo:block id="idm45886875666976"><fo:external-graphic src="url(figures/prior_example_2d_plurigaussian_2_pgmap.png)" width="40%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block></fo:block><fo:block id="prior_mps"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">MPS</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
  The 'MPS' type prior make use of the <fo:basic-link external-destination="url(https://github.com/ergosimulation/mpslib)">MPSlib(C++) library</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://github.com/ergosimulation/mpslib)">https://github.com/ergosimulation/mpslib</fo:basic-link>]</fo:inline> for mulitple-point based simulation. For compilation and installation help see <fo:basic-link internal-destination="InstallSippi"><fo:inline>Install SIPPI</fo:inline></fo:basic-link>. MPSlib(C++) implements the SNESIM (using both a search tree and a list to stor conditional statistics), and the generalized ENESIM algoritm. The type of multiple-point algorithm is define in the method field.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
To use the MPS type prior at least the type, dimension, as well as a training image must be provided:  
</fo:block><fo:block id="idm45886875659488" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
ip=1; 
prior{ip}.type='mps';
prior{ip}.x=1:1:80;
prior{ip}.y=1:1:80;
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
  A trainin imag emust be set in the 'ti' field, as 1D, 2D, or 3D matrix. If not set, the classical training image from Strebelle is used, equivalent to:
</fo:block><fo:block id="idm45886875658416" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{ip}.ti=channels;
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
More examples of traning images are located in the 'mGstat/ti' folder.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
MPSlib(C++) provides three different simulation aglrithms, which canbe chosen in the 'method' field as:
</fo:block><fo:block id="idm45886875657040" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{ip}.method='mps_snesim_tree';
prior{ip}.method='mps_snesim_list';
prior{ip}.method='mps_genesim';
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
'mps_snesim_tree' is the simulation method selected by default if it is not specified.
</fo:block><fo:block id="prior_mps_options"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">options for MPSlib(C++)</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
All options for the MPS type simulation algorithm are be available in the <fo:inline font-family="monospace">prior{ip}.MPS</fo:inline> data structure.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
For example, to set the number of used multiple grids, set the <fo:inline font-family="monospace">MPS.n_multiple_grids</fo:inline> as
<fo:block id="idm45886875653296" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
ip=1; 
prior{ip}.type='mps';
prior{ip}.method='mps_snesim';
prior{ip}.x=0:.1:10;
prior{ip}.y=0:.1:20;
[m,prior]=sippi_prior(prior);
i=0;
for n_mul_grids=[0:1:4];
    prior{ip}.MPS.rseed=1;
    prior{ip}.MPS.n_multiple_grids=n_mul_grids;
    [m,prior]=sippi_prior(prior);
    i=i+1;subplot(1,5,i);
    imagesc(prior{1}.x,prior{1}.y,m{1});axis image
    title(sprintf('NMG = %d',n_mul_grids));
end
</fo:block>
<fo:block id="idm45886875652464" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
More details on the use of MPSlib(C++) can be found in the  <fo:basic-link external-destination="url(https://www.authorea.com/users/30338/articles/82347/)">SoftwareX manuscript</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://www.authorea.com/users/30338/articles/82347/)">https://www.authorea.com/users/30338/articles/82347/</fo:basic-link>]</fo:inline> that describes MPSlib(C++).
</fo:block>
</fo:block></fo:block></fo:block><fo:block id="prior_snesim"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">SNESIM</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The 'SNESIM' type prior model utilizes the SNESIM algorithm, as implemented in Fortran available at <fo:basic-link external-destination="url(https://github.com/SCRFpublic/snesim-standalone)">Stanford/SCRF</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://github.com/SCRFpublic/snesim-standalone)">https://github.com/SCRFpublic/snesim-standalone</fo:basic-link>]</fo:inline>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
By default a training image (channel structures) from Sebastian Strebelle's PhD theses is used (if no training image is specified). A simple 2D type SNESIM prior model can be defined using the following code: 
<fo:block id="idm45886875648064" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
ip=1; 
prior{ip}.type='SNESIM';
prior{ip}.x=[0:.1:10]; % X array 
prior{ip}.y=[0:.1:20]; % Y array 
</fo:block>
and 5 realizations from this prior can be visualized using
<fo:block id="idm45886875647568" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
for i=1:5;
    m=sippi_prior(prior);
    subplot(1,5,i);
    imagesc(prior{1}.x,prior{1}.y,m{1});axis image
end
</fo:block>
<fo:block id="idm45886875647056"><fo:external-graphic src="url(figures/prior_reals_snesim.png)" width="70%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Note that the training image is always assumed to have the same units as the prior model, so in this case each pixel in the training image is assumed to be separated by a distance '0.1'.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Optionally 'scaling' and 'rotation' of the training image can be set. To scale the training image by 0.7 (i.e., structures will appear 30% smaller) and rotate the training 30 degrees from north use
</fo:block><fo:block id="idm45886875643040" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
ip=1; 
prior{ip}.type='SNESIM';
prior{ip}.x=[0:.1:10]; % X array 
prior{ip}.y=[0:.1:20]; % Y array 
prior{ip}.scaling=.7;
prior{ip}.rotation=30;
</fo:block><fo:block id="idm45886875642432"><fo:external-graphic src="url(figures/prior_reals_snesim_rotation_scale.png)" width="70%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block><fo:block id="prior_snesim_sgems_ti"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Custom training image</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A custom training image can be set using the <fo:inline font-family="monospace">ti</fo:inline> field, which must be either a 2D or 3D matrix.
<fo:block id="idm45886875637776" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
% create TI from image
EXAMPLE EXAMPLE

% setup the prior
ip=1; 
prior{ip}.type='SNESIM';
prior{ip}.x=[0:.1:10]; % X array 
prior{ip}.y=[0:.1:20]; % Y array
prior{ip}.ti=ti;
</fo:block>
Note that the training image MUST consist of integer index values starting from 0 (i.e. '0', '1', '2', ...).
</fo:block></fo:block><fo:block id="prior_snesim_sgems_options"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Complete customization</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
If the <fo:inline font-family="monospace">prior</fo:inline> structure is returned from <fo:basic-link internal-destination="sippi_prior"><fo:inline>sippi_prior</fo:inline></fo:basic-link> using 
<fo:block id="idm45886875634496" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
[m,prior]=sippi_prior(prior);
</fo:block>
then an XML structure <fo:inline font-family="monospace">prior{1}.S.XML</fo:inline> will be available. This allows a complete customization of all settings available in SGeMS. For example, the different realizations, using 1, 2, and 3 multiple grids can be obtained using
<fo:block id="idm45886875633392" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
ip=1; 
prior{ip}.type='SNESIM';
prior{ip}.x=[0:.1:10]; % X array 
prior{ip}.y=[0:.1:20]; % Y array 
[m,prior]=sippi_prior(prior);
for i=1:5;
    prior{ip}.S.XML.parameters.Nb_Multigrids_ADVANCED.value=i;
	subplot(1,3,5);
    imagesc(prior{1}.x,prior{1}.y,m{1});axis image	
end
</fo:block>
<fo:block id="idm45886875632720"><fo:external-graphic src="url(figures/prior_reals_snesim_nmgrid.png)" width="70%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block>
</fo:block></fo:block></fo:block><fo:block id="prior_snesim_std"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">SNESIM</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The 'SNESIM' type prior model utilizes the SNESIM algorithm, as implemented in <fo:basic-link internal-destination="SGEMS"><fo:inline>SGeMS</fo:inline></fo:basic-link>. It can be called using the options as <fo:basic-link internal-destination="sippi_prior_snesim"><fo:inline>sippi_prior_snesim</fo:inline></fo:basic-link>.
</fo:block></fo:block></fo:block><fo:block id="prior_sampling"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Sampling the prior</fo:marker><fo:block font-size="17.28pt">Sampling the prior</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Once the prior data structure has been defined/modified, a sample from the prior distribution can be generated using 
<fo:block id="idm45886875626016" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
m=sippi_prior(prior);
</fo:block>
'm' is a Matlab data structure of the same size as the 'prior' data structure. Thus, if two prior distributions have been defined in 'prior{1}' and 'prior{2}', then 'm{1}' will hold a realization of 'prior{1}', 
and 'm{2}' will hold a realization of 'prior{2}'. 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Each time 'm=sippi_prior(prior)' is called, a new independent realization of the prior will be generated.
</fo:block></fo:block><fo:block id="sec_seq_gibbs"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Sequential Gibbs sampling / Conditional Re-sampling</fo:marker><fo:block font-size="17.28pt">Sequential Gibbs sampling / Conditional Re-sampling</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
All the available types of prior models allow perturbing one realization of a prior into a new realization of the prior, where the degree of perturbation can be controlled (from a new independent realization to a very small change).
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
This means that a random walk, with an arbitrary 'step-length' can be performed for any of the a priori types available in SIPPI
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
 For the a priori types 'FFTMA', 'VISIM', 'CHOLESKY', 'SISIM', 'SNESIM', sequential Gibbs sampling [<fo:basic-link internal-destination="HansenetalGibbs2012">HCM12</fo:basic-link>] is applied. Sequential Gibbs is in essence a type of conditional re-simulation. From a current realization of a prior model, a number of model parameters are discarded and treated as unknown. The unknown model parameters are then re-simulated conditional to the known model parameters.  
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
In order to generate a new realization 'm2' in the vicinity of the realization 'm1' use
<fo:block id="idm45886875620640" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
[m1,prior]=sippi_prior(prior);
[m2,prior]=sippi_prior(prior,m1);
</fo:block>
If this process is iterated, then a random walk in the space of a priori acceptable models will be perform. Moreover, the collection of realization obtained in this way will represent a sample from prior distribution.  
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Note that in order to use sequential Gibbs sampling <fo:inline font-family="monospace">prior</fo:inline> must be given both as an input variable, and as an (possibly update) output variable.
</fo:block><fo:block id="sec_seq_gibbs_step"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Controlling sequential Gibbs sampling / Conditional Re-sampling</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
All properties related to sequential Gibbs sampling can be set in the 'seq_gibbs' structure (which will be avaiable the first time <fo:basic-link internal-destination="sippi_prior"><fo:inline>sippi_prior</fo:inline></fo:basic-link> is called, or if <fo:basic-link internal-destination="sippi_prior_init"><fo:inline>sippi_prior_init</fo:inline></fo:basic-link> is called), for the individual prior models. 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The step-length (i.e. the degree of perturbation) is determined by the <fo:inline font-family="monospace">prior{m}.seq_gibbs.step</fo:inline> parameter.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
For the 'uniform' and 'gaussian' type a priori models a step-length closer to 0 zeros imples a 'shorter' step, while a step-length close to 1, implies a 'longer' step-length. A step length of 1, will generate a new independent realization of the prior, while a step length of 0, will return the same realization of the prior
<fo:block id="idm45886875614096" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{m}.seq_gibbs.step=.1;
[m2,prior]=sippi_prior(prior,m1);
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
For the 'FFTMA', 'VISIM', 'CHOLESKY', 'SISIM', and 'SNESIM' type a priori models two types (defined in the <fo:inline font-family="monospace">prior{m}.seq_gibbs.type</fo:inline> variable).
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The default 'type' is 2, defined as
<fo:block id="idm45886875611904" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{m}.seq_gibbs.step=1;
prior{m}.seq_gibbs.type=2;
</fo:block>
where the step length defines the percentage of the of model parameters (selected at random) defined in <fo:inline font-family="monospace">prior{im}</fo:inline> is conditionally re-sampled. Thus, a step-length closer to 0 zeros imples a 'shorter' step, while a step-length close to 1, implies a 'longer' step-length.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
If <fo:inline font-family="monospace">prior{m}.seq_gibbs.step=1</fo:inline>, then <fo:inline font-family="monospace">prior{m}.seq_gibbs.step</fo:inline> defines the size of a square rectangle/cube which is to be conditionally re-simulated using sequential Gibbs sampling.
</fo:block></fo:block></fo:block></fo:block><fo:block id="chapdata"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker"><fo:inline font-family="monospace">data</fo:inline>: Data and data uncertainties/noise </fo:marker><fo:block font-size="20.736pt"><fo:inline font-family="monospace">data</fo:inline>: Data and data uncertainties/noise </fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-family="monospace">data</fo:inline> is a Matlab structure that defines any number of data and the associated uncertainty/noise model.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-family="monospace">data{1}</fo:inline> defines the first data set (which must always be defined), and any number of additional data sets can be defined in 
<fo:inline font-family="monospace">data{2}</fo:inline>, 
<fo:inline font-family="monospace">data{3}</fo:inline>, ...
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
This allows to consider for example seismic data in <fo:inline font-family="monospace">data{1}</fo:inline>, and electromagnetic data in <fo:inline font-family="monospace">data{2}</fo:inline>. 
 </fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
For each set of data, a Gaussian noise model (both correlated and uncorrelated) can be specified. The noise model for different data types (e.g. <fo:inline font-family="monospace">data{1}</fo:inline> and <fo:inline font-family="monospace">data{2}</fo:inline> are independent).
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Once the noise model has been defined, the log-likelihood related to any model, <fo:inline font-family="monospace">m</fo:inline>, with the corresponding <fo:basic-link internal-destination="chapforward"><fo:inline>forward response</fo:inline></fo:basic-link>, <fo:inline font-family="monospace">d</fo:inline>, can be computed using
<fo:block id="idm45886875599744" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
[d,forward,prior,data]=sippi_forward(m,forward,prior,data)
logL=sippi_likelihood(data,d)
</fo:block>
where <fo:inline font-family="monospace">d</fo:inline> is the output of <fo:basic-link internal-destination="sippi_forward"><fo:inline>sippi_forward</fo:inline></fo:basic-link>.

</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The specification of the noise model can be divided into a description of the <fo:basic-link internal-destination="sec_meas_noise_gauss"><fo:inline>measurement noise</fo:inline></fo:basic-link> (mandatory) and the <fo:basic-link internal-destination="sec_model_noise_gauss"><fo:inline>modeling error</fo:inline></fo:basic-link> (optional).
</fo:block><fo:block id="sec_meas_noise_gauss"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Gaussian measurement noise</fo:marker><fo:block font-size="17.28pt">Gaussian measurement noise</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
</fo:block><fo:block id="sec_meas_noise_gauss_uncorr"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Uncorrelated Gaussian measurement noise</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
To define a set of observed data, [0,1,2], with an associated uncorrelated uncertainty defined by a Gaussian model with mean 0 and standard deviation 2, use
<fo:block id="idm45886875593504" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
data{1}.d_obs=[0 1 2]';
data{1}.d_std=[2 2 2]';
</fo:block>
which is equivalent to (as the noise model for each data is the same, and independent) 
<fo:block id="idm45886875592912" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
data{1}.d_obs=[0 1 2]';
data{1}.d_std=2;
</fo:block>
One can also choose to define the uncertainty using a variance as opposed to the standard deviation
<fo:block id="idm45886875592416" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
data{1}.d_obs=[0 1 2]';
data{1}.d_var=4;
</fo:block>
</fo:block></fo:block><fo:block id="sec_meas_noise_gauss_corr"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Correlated Gaussian measurement noise</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Correlated Gaussian measurement uncertainty can be specified using the <fo:inline font-family="monospace">Cd</fo:inline> field, as for example
<fo:block id="idm45886875589840" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
data{1}.Cd=[4 1 0 ; 1 4 1 ; 0 1 4];
</fo:block>
Note that <fo:inline font-family="monospace">data{1}.Cd</fo:inline> must be of size [NDxND], where ND is the number of data in <fo:inline font-family="monospace">data{1}.d_obs</fo:inline>.
</fo:block></fo:block></fo:block><fo:block id="sec_model_noise_gauss"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Gaussian modeling error</fo:marker><fo:block font-size="17.28pt">Gaussian modeling error</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The modeling error refers to errors caused by using for example an imperfect forward model, see [<fo:basic-link internal-destination="hansen2014modelingerror">HCM14</fo:basic-link>].
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A Gaussian model of the modeling error can be specified by the mean, <fo:inline font-family="monospace">dt</fo:inline>, and the covariance, <fo:inline font-family="monospace">Ct</fo:inline>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
For example
<fo:block id="idm45886875584624" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
data{1}.dt=[0 0 0];
data{1}.Ct=[4 4 4; 4 4 4; 4 4 4];
</fo:block>
is equivalent to 
<fo:block id="idm45886875584176" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
data{1}.Ct=4
</fo:block>
which implies a zero mean modeling error with a covariance model where all model parameters has a covariance of 4. 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:basic-link internal-destination="sippi_compute_modelization_forward_error"><fo:inline>sippi_compute_modelization_forward_error</fo:inline></fo:basic-link> can be used to estimate the modeling error related to using an approximate forward model. See the <fo:basic-link internal-destination="sec_ex_tomography"><fo:inline>tomography example</fo:inline></fo:basic-link>, for an <fo:basic-link internal-destination="AM13_gaussian_modeling_error"><fo:inline>example of accounting for correlated modeling errors</fo:inline></fo:basic-link>, following [<fo:basic-link internal-destination="hansen2014modelingerror">HCM14</fo:basic-link>].
</fo:block></fo:block></fo:block><fo:block id="chapforward"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker"><fo:inline font-family="monospace">forward</fo:inline>: The forward model</fo:marker><fo:block font-size="20.736pt"><fo:inline font-family="monospace">forward</fo:inline>: The forward model</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The specification of the <fo:inline font-family="monospace">prior</fo:inline> and <fo:inline font-family="monospace">data</fo:inline> is intended to be generic, applicable to any inverse problem considered. The forward problem, on the other hand, is typically specific for each different inverse problem.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"> 
In order to make use of SIPPI to sample the posterior distribution of an inverse problem, the solution to the forward problem must be embedded in a Matlab function with the following input and output arguments:
</fo:block><fo:block id="idm45886875576224" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
[d,forward,prior,data]=sippi_forward(m,forward,prior,data,id)
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-family="monospace">m</fo:inline> is a realization of the prior model, and <fo:inline font-family="monospace">prior</fo:inline> and <fo:inline font-family="monospace">data</fo:inline> are the Matlab structures defining the prior and the noise model (see <fo:basic-link internal-destination="chapprior"><fo:inline>Prior</fo:inline></fo:basic-link> and <fo:basic-link internal-destination="chapdata"><fo:inline>Data</fo:inline></fo:basic-link>)
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-family="monospace">id</fo:inline> is optional, and can be used to compute the forward response of a subset of the different types of data available (i.e. <fo:inline font-family="monospace">data{1}</fo:inline>, <fo:inline font-family="monospace">data{2}</fo:inline>,... )
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:inline font-family="monospace">forward</fo:inline> variable is a Matlab structure that can contain any information needed to solve the forward problem. Thus, the parameters for the <fo:inline font-family="monospace">forward</fo:inline> structure is problem dependent. One option, <fo:inline font-family="monospace">forward.forward_function</fo:inline> is though generic, and point to the m-file that implements the forward problem.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The output variable <fo:inline font-family="monospace">d</fo:inline> is a Matlab structure of the same size of <fo:inline font-family="monospace">data</fo:inline>.
Thus, if 4 types of data have been specified, then <fo:inline font-family="monospace">d</fo:inline> must also be a structures of size 4.
<fo:block id="idm45886875566624" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
length(data) == length(d);
</fo:block> 
Further, <fo:inline font-family="monospace">d{i}</fo:inline> must refer to an array of the same size as <fo:inline font-family="monospace">data{i}.d_obs</fo:inline>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
An example of an implementation of the forward problem related to a simple line fitting problem is:

</fo:block><fo:block id="idm45886875564768" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
function [d,forward,prior,data]=sippi_forward_linefit(m,forward,prior,data);
    d{1}=forward.x*m{2}+m{1};
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
This implementation requires that the 'x'-locations, for which the y-values of the straight line is to be computed, is specified through <fo:inline font-family="monospace">forward.x</fo:inline>. Say some y-data has been observed at locations x=[1,5,8], with the values [2,4,9], and a standard deviation of 1 specifying the uncertainty, the forward structure must be set as 
<fo:block id="idm45886875563136" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
forward.forward_function='sippi_forward_linefit';
forward.x=[1,5,8];
</fo:block>
while the data structure will be
<fo:block id="idm45886875562496" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
data{1}.d_obs=[2 4 9]
data{1}.d_std=1;
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
This implementation also requires that the prior model consists of two 1D prior types, such that 
<fo:block id="idm45886875561728" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
m=sippi_prior(prior)
</fo:block> 
returns the intercept in <fo:inline font-family="monospace">m{1}</fo:inline> and the gradient in <fo:inline font-family="monospace">m{2}</fo:inline>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
An example of computing the forward response using an intercept of 0, and a gradients of 2 is then 
<fo:block id="idm45886875559824" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
m{1}=0;
m{2}=2;
d=sippi_forward(m,forward)
</fo:block>
and the corresponding log-likelihood of m, can be computed using
</fo:block><fo:block id="idm45886875559024" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
logL=sippi_likelihood(data,d);
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
[see more details and examples related to polynomial line fitting at <fo:basic-link internal-destination="sec_ex_linefit"><fo:inline>polynomial line fitting</fo:inline></fo:basic-link>].
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="chapExamples"><fo:inline>Examples</fo:inline></fo:basic-link> section contains more example of implementation of different forward problems.
</fo:block></fo:block><fo:block id="secTestSetup"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Validating <fo:inline font-family="monospace">prior</fo:inline>, <fo:inline font-family="monospace">data</fo:inline>, and <fo:inline font-family="monospace">forward</fo:inline></fo:marker><fo:block font-size="20.736pt">Validating <fo:inline font-family="monospace">prior</fo:inline>, <fo:inline font-family="monospace">data</fo:inline>, and <fo:inline font-family="monospace">forward</fo:inline></fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A simple way to test the validity of 
<fo:inline font-family="monospace">prior</fo:inline>,
<fo:inline font-family="monospace">data</fo:inline>, and
<fo:inline font-family="monospace">forward</fo:inline> 
is to test if the following sequence can be evaluated without errors: 
</fo:block><fo:block id="idm45886875551984" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
% Generate a realization, m, of the prior model
m=sippi_prior(prior);
% Compute the forward response
d=sippi_forward(m,forward,prior,data);
% Evaluate the log-likelihood of m
logL=sippi_likelihood(data,d);
</fo:block></fo:block></fo:flow></fo:page-sequence>

  
  <fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="true" master-reference="body" language="en" format="1" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Sampling the a posteriori distribution</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Sampling the a posteriori distribution</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-inner-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="4pc" end-indent="0pt"><fo:block id="chapPosterior"><fo:block font-family="sans-serif,Symbol,ZapfDingbats"><fo:block margin-left="0pt"><fo:block font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="10pt" space-before.minimum="10pt * 0.8" space-before.maximum="10pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Chapter3.Sampling the a posteriori distribution</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Once the
<fo:inline font-family="monospace">prior</fo:inline>,
<fo:inline font-family="monospace">data</fo:inline>, and
<fo:inline font-family="monospace">forward</fo:inline> data structures have been defined, the associated a posteriori probability can be sampled using the rejection sampler and the extended Metropolis sampler.
</fo:block><fo:block id="sec_rejection"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">The rejection sampler</fo:marker><fo:block font-size="20.736pt">The rejection sampler</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The rejection sampler provides a simple, and also in many cases inefficient, approach to sample the posterior distribution.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
At each iteration of the rejection sample an independent realization, m_pro, of the prior is generated, and the model is accepted as a realization of the posterior with probability Pacc = L(m_pro)/L_max. It can be initiated using
<fo:block id="idm45886875545504" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.nite=400000; % Number of iteration, defaults to 1000
options.mcmc.i_plot=500; % Number of iteration between visual updates, defaults to 500
options=sippi_rejection(data,prior,forward,options);
</fo:block>
By default the rejection sampler is run assuming a maximum likelihood of 1 (i.e. L_max = 1).
If L_max is known, then it can be set using in the <fo:inline font-family="monospace">options.Lmax</fo:inline> or <fo:inline font-family="monospace">options.logLmax</fo:inline> fields
<fo:block id="idm45886875543968" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.Lmax=1e-9;
options=sippi_rejection(data,prior,forward,options);
</fo:block>
or
<fo:block id="idm45886875543584" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.logLmax=log(1e-9);
options=sippi_rejection(data,prior,forward,options);
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Alternatively, L_max can be automatically adjusted to reflect the maximum likelihood found while running the rejection sampler using
<fo:block id="idm45886875542608" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.adaptive_rejection=1
options=sippi_rejection(data,prior,forward,options);
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
An alternative to rejection sampling, also utilizing independent realizations of the prior, that does not require one to set L_max is the <fo:basic-link internal-destination="sec_independentmetropolis"><fo:inline>independent extended metropolis sampler</fo:inline></fo:basic-link>, which may be computatinoally superior to the rejection sampler,
</fo:block></fo:block><fo:block id="sec_extendedmetropolis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">The extended Metropolis sampler</fo:marker><fo:block font-size="20.736pt">The extended Metropolis sampler</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The extended Metropolis algorithm is in general a much more efficient algorithm for sampling the a posteriori probability</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The extended Metropolis sampler can be run using
<fo:block id="idm45886875538352" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.nite=40000; 	% number of iterations, default nite=30000
options.mcmc.i_sample=50;	% save the current model for every 50 iterations, default, i_sample=500
options.mcmc.i_plot=1000;   % plot progress of the Metropolis sampler for every 100 iterations
                            % default i_plot=50;
options.txt='case_line_fit'; % descriptive name appended to output folder name, default txt='';

[options,data,prior,forward,m_current]=sippi_metropolis(data,prior,forward,options)
</fo:block>
One can choose to accept all steps in the Metropolis sampler, which will result in an algorithm sampling the prior model, using
<fo:block id="idm45886875537312" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.accept_all=1; % default [0]
</fo:block>
One can choose to accept models that lead to an improvement in the likelihood, which results in an optimization like algorithm using
<fo:block id="idm45886875536624" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.accept_only_improvements=1; % default [0]
</fo:block>

</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
See <fo:basic-link internal-destination="sippi_metropolis"><fo:inline>sippi_metropolis</fo:inline></fo:basic-link> for more details.
</fo:block><fo:block id="sec_controling_step_length"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Controlling the step length</fo:marker><fo:block font-size="17.28pt">Controlling the step length</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
One optionally, as part of running the <fo:basic-link internal-destination="sec_extendedmetropolis"><fo:inline>extended Metropolis sampler</fo:inline></fo:basic-link>, automatically update the 'step'-length of the <fo:basic-link internal-destination="sec_seq_gibbs"><fo:inline>sequential Gibbs sampler</fo:inline></fo:basic-link> in order to ensure a specific approximate acceptance ratio of the Metropolis sampler. See [<fo:basic-link internal-destination="CorduaFWI">CHM12</fo:basic-link>] for details.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The default parameters for adjusting the step length, as given below, are set in the '<fo:basic-link internal-destination="sec_seq_gibbs_step"><fo:inline>prior.seq_gibbs</fo:inline></fo:basic-link>' structure. These parameters will be set the first time 'sippi_prior' is called with the 'prior' structure as output.The default parameters.
</fo:block><fo:block id="idm45886875529568" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{m}.seq_gibbs.step_min=0;
prior{m}.seq_gibbs.step_min=1;
prior{m}.seq_gibbs.i_update_step=50
prior{m}.seq_gibbs.i_update_step_max=1000
prior{m}.seq_gibbs.n_update_history=50
prior{m}.seq_gibbs.P_target=0.3000
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">By default, adjustment of the step length, in order to achieve an acceptance ratio of 0.3 ('prior{m}.seq_gibbs.P_target'), will be performed for every 50 ('prior{m}.seq_gibbs.i_update_step') iterations, using the acceptance ratio observed in the last 50 ('prior{m}.seq_gibbs.i_update_history') iterations.
 </fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Adjustment of the step length will be performed only in the first 1000 ('prior{m}.seq_gibbs.i_update_step_max') iterations.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
In order to disable automatic adjustment of the step length simply set
<fo:block id="idm45886875527200" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{m}.seq_gibbs.i_update_step_max=0; % disable automatic step length
</fo:block>
</fo:block></fo:block><fo:block id="sec_independentmetropolis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">The independent extended Metropolis sampler</fo:marker><fo:block font-size="17.28pt">The independent extended Metropolis sampler</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">The 'independent' extended Metropolis sampler, in which each proposed model is independant of the previously visited model, can be chosen by forcing the 'step'-length to be 1 (i.e. leading to independant samples from the prior), using e.g.
<fo:block id="idm45886875524864" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
% force independent prior sampling
for ip=1:length(prior);
	prior{ip}.seq_gibbs.step=1;
	prior{ip}.seq_gibbs.i_update_step_max=0;
end
% run 'independent' extended Metropolis sampling
[options,data,prior,forward,m_current]=sippi_metropolis(data,prior,forward,options)
</fo:block>

</fo:block></fo:block><fo:block id="sec_metropolis_annealing"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Annealing schedule</fo:marker><fo:block font-size="17.28pt">Annealing schedule</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Simulated annealing like behavior can be controlled in the <fo:inline font-family="monospace">options.mcmc.anneal</fo:inline> structure. By default annealing is disabled.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Annealing consist of setting the temperature (similar to scaling the noise). A temperature foes not affect the exploration. For temperatures larger than 1, the acceptance ratio increases (the exploration of the Metropolis sampler increases). For temperatures below 1, the acceptance ratio decreases (and hence the exploration of the Metropolis sampler).
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The temperature is set to <fo:inline font-family="monospace">options.mcmc.anneal.T_begin</fo:inline> at any iteration before <fo:inline font-family="monospace">options.mcmc.anneal.i_begin</fo:inline>.
The temperature is set to <fo:inline font-family="monospace">options.mcmc.anneal.T_end</fo:inline> at any iteration after <fo:inline font-family="monospace">options.mcmc.anneal.i_end</fo:inline>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
In between iteration number
<fo:inline font-family="monospace">options.mcmc.anneal.i_start</fo:inline> and
<fo:inline font-family="monospace">options.mcmc.anneal.i_end</fo:inline>
the temperature changes following either an exponential decay (<fo:inline font-family="monospace">options.mcmc.anneal.type='exp'</fo:inline>), or simple linear interpolation (<fo:inline font-family="monospace">options.mcmc.anneal.type='linear'</fo:inline>).
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
An annealing schedule can be used allow a Metropolis sampler that allow exploration of more of the model space in the beginning of the chain. Recall though that the posterior is not sampled until (at least) the annealing has been ended at iteration, <fo:inline font-family="monospace">options.mcmc.anneal.i_end</fo:inline>, if the <fo:inline font-family="monospace">options.mcmc.anneal.T_end=1</fo:inline>. This can potentially help not to get trapped in a local minimum.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
To use this type of annealing, where the annealing stops after 10000 iterations, after which the algorithm performs like a regular Metropolis sampler, use for example

<fo:block id="idm45886875514560" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.anneal.i_begin=1; % default, iteration number when annealing begins
options.mcmc.anneal.i_end=10000; %  iteration number when annealing stops
</fo:block>
which is equivalent to
<fo:block id="idm45886875513952" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.anneal.i_begin=1; % default, iteration number when annealing begins
options.mcmc.anneal.i_end=10000; %  iteration number when annealing stops
options.mcmc.anneal.T_begin=5; % start temperature
options.mcmc.anneal.T_end=1; % end temperature
</fo:block>
</fo:block></fo:block><fo:block id="sec_tempering"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Parallel tempering</fo:marker><fo:block font-size="17.28pt">Parallel tempering</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Parallel tempering is implemented according to [<fo:basic-link internal-destination="SambridgeTempering2013">S13</fo:basic-link>]. It is an extension of the Metropolis algorithm, that start a number of parallel chains of Metropolis sampling algorithms. Each chain is run with a different temperature, and the state of each chain is allowed jump between chains according to some rules that ensure the correct probability density is sampled. This allow the sampling algorithm to better handle a posterior distribution with multiple, disconnected, areas of high probability.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The following three setting enable parallel tempering.
</fo:block><fo:block id="idm45886875510128" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
TEMPERING
options.mcmc.n_chains=3; % set number of chains (def=1, no multiple chains)
options.mcmc.T=[1 2 3];      % set temperature of chains [1:n_chains]
options.mcmc.chain_frequency_jump=0.1; % probability allowing a jump between two chains
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-family="monospace">options.mcmc.n_chains</fo:inline> defines the number of chains. If not set only one chain is used, and the no parallel tempering is performed.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-family="monospace">options.mcmc.T</fo:inline> defines the temperature of each chain. A temperature of '1', which is the default, implies no tempering. A higher temperature allow a chain to be more exploratory.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:inline font-family="monospace">options.mcmc.chain_frequency_jump</fo:inline> defines the frequency with which a jump from one chain to another is suggested. A value of one means that a jump is proposed at each iteration, while a value of 0.1 (default) means that a jump is only proposed with 10 percentage probability (on average one in 10 iterations).
</fo:block></fo:block></fo:block></fo:flow></fo:page-sequence>

  
  <fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="true" master-reference="body" language="en" format="1" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Examples</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Examples</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-inner-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="4pc" end-indent="0pt"><fo:block id="chapExamples"><fo:block font-family="sans-serif,Symbol,ZapfDingbats"><fo:block margin-left="0pt"><fo:block font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="10pt" space-before.minimum="10pt * 0.8" space-before.maximum="10pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Chapter4.Examples</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
SIPPI can be used as a convenient approach for unconditional an conditional simulation.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
In order to use SIPPI to solve inverse problems, one must provide the solution to the forward problem. Essentially this amounts to implementing a Matlab function that solves the <fo:basic-link internal-destination="chapforward"><fo:inline>forward problem</fo:inline></fo:basic-link> in using a specific input/output format. If a solution to the forward problem already exist, this can be quite easily done simply using a Matlab wrapper function. 

</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A few implementations of solutions to forward problems are included as examples as part of SIPPI. These will be demonstrated in the following 
</fo:block><fo:block id="sec_ex_prior"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Examples of A priori models</fo:marker><fo:block font-size="20.736pt">Examples of A priori models</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/><fo:block id="sec_ex_prior_multi_1d_gauss"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Multiple 1D Gaussian prior model</fo:marker><fo:block font-size="17.28pt">Multiple 1D Gaussian prior model</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A prior model consisting of three independent 1D distributions (a Gaussian, Laplace, and Uniform distribution) can be defined using
</fo:block><fo:block id="idm45886875496784" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
ip=1;
prior{ip}.type='GAUSSIAN';
prior{ip}.name='Gaussian';
prior{ip}.m0=10;
prior{ip}.std=2;

ip=2;
prior{ip}.type='GAUSSIAN';
prior{ip}.name='Laplace';
prior{ip}.m0=10;
prior{ip}.std=2;
prior{ip}.norm=1;

ip=3;
prior{ip}.type='GAUSSIAN';
prior{ip}.name='Uniform';
prior{ip}.m0=10;
prior{ip}.std=2;
prior{ip}.norm=60;

m=sippi_prior(prior);

m = 

    [14.3082]    [9.4436]    [10.8294]
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">1D histograms of a sample (consisting of 1000 realizations) of the prior models can be visualized using ...
</fo:block><fo:block id="idm45886875495360" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
sippi_plot_prior_sample(prior);
</fo:block></fo:block><fo:block id="sec_ex_prior_multi_fft_ma_cov"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Multivariate Gaussian prior with unknown covariance model properties.</fo:marker><fo:block font-size="17.28pt">Multivariate Gaussian prior with unknown covariance model properties.</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="prior_fftma"><fo:inline>FFT-MA</fo:inline></fo:basic-link> type a priori model allow separation of properties of the covariance model (covariance parameters, such as range, and anisotropy ratio) and the random component of a Gaussian model. This allow one to define a Gaussian a priori model, where the covariance parameters can be treated as unknown variables.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
In order to treat the covariance parameters as unknowns, one must define one a priori model of type <fo:inline font-family="monospace">FFTMA</fo:inline>, and then a number of 1D <fo:inline font-family="monospace">GAUSSIAN</fo:inline> type a priori models, one for each covariance parameter. Each gaussian type prior model must have a descriptive name, corresponding to the covariance parameter that is should describe: 
<fo:block id="idm45886875490816" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{im}.type='gaussian';
prior{im}.name='m_0';     % to define a prior for the mean 
prior{im}.name='sill';    % to define a prior for sill (variance)
prior{im}.name='range_1'; % to define a prior for the range parameter 1
prior{im}.name='range_2'; % to define a prior for the range parameter 2
prior{im}.name='range_3'; % to define a prior for the range parameter 3
prior{im}.name='ang_1';   % to define a prior for the first angle of rotation
prior{im}.name='ang_2';   % to define a prior for the second angle of rotation
prior{im}.name='ang_3';   % to define a prior for the third angle of rotation
prior{im}.name='nu';      % to define a prior for the shape parameter, nu 
			  %   (only applies when the Matern type Covariance model is used)
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A very simple example of a prior model defining a 1D Spherical type covariance model with a range between 5 and 15 meters, can be defined using: 
<fo:block id="idm45886875489088" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=1; 
prior{im}.type='FFTMA';
prior{im}.x=[0:.1:10]; % X array 
prior{im}.m0=10;
prior{im}.Va='1 Sph(10)';
prior{im}.fftma_options.constant_C=0;


im=2;
prior{im}.type='gaussian';
prior{im}.name='range_1';
prior{im}.m0=10;
prior{im}.std=5
prior{im}.norm=80;
prior{im}.prior_master=1; % -- NOTE, set this to the FFT-MA type prior for which this prior type
                          % should describe the range
</fo:block> 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Note that the the field <fo:inline font-family="monospace">prior_master</fo:inline> must be set to point the to the FFT-MA type a priori model (through its id/number) for which it should define a covariance parameter (in this case the range). 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
10 independent realizations of this type of a priori model are shown in the following figure
</fo:block><fo:block id="idm45886875486576"><fo:external-graphic src="url(figures/prior_reals_fftma_1d_range.png)" width="70%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Such a prior, as all prior models available in SIPPI, works with <fo:basic-link internal-destination="sec_seq_gibbs"><fo:inline>sequential Gibbs sampling</fo:inline></fo:basic-link>, allowing a random walk in the space of a prior acceptable models, that will sample the prior model. An example of such a random walk can be performed using
<fo:block id="idm45886875482512" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{1}.seq_gibbs.step=.005;
prior{2}.seq_gibbs.step=0.1;
clear m_real;
for i=1:150;
    [m,prior]=sippi_prior(prior,m);
    m_real(:,i)=m{1};
end
</fo:block>
An example of such a set of 150 dependent realization of the prior can be seen below
</fo:block><fo:block id="idm45886875481776"><fo:external-graphic src="url(figures/prior_reals_fftma_1d_range_waterfall.png)" width="70%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block></fo:block><fo:block id="sec_ex_linefit"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Polynomial line fitting</fo:marker><fo:block font-size="20.736pt">Polynomial line fitting</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Here follows simple polynomial (of order 0, 1 or 2) line-fitting is considered. Example m-files can be found in the <fo:inline font-family="monospace">SIPPI/examples/case_linefit</fo:inline> folder.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
First, the forward problem is defined. Then examples of stochastic inversion using SIPPI is demonstrated using a a synthetic data set.
</fo:block><fo:block id="linefit_forward"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">The forward problem</fo:marker><fo:block font-size="17.28pt">The forward problem</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The forward problem consists of computing the y-value as a function of the x-position of the data, and the polynomial coefficients determining the line. <fo:basic-link internal-destination="sippi_forward_linefit"><fo:inline>sippi_forward_linefit.m</fo:inline></fo:basic-link>:
<fo:block id="sippi_forward_linefit" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
% sippi_forward_linefit Line fit forward solver for SIPPI 
%
% [d,forward,prior,data]=sippi_forward_linefit(m,forward,prior,data);
%
function [d,forward,prior,data]=sippi_forward_linefit(m,forward,prior,data);

if length(m)==1;
    d{1}=forward.x*m{1};
elseif length(m)==2;
    d{1}=forward.x*m{1}+m{2};
else
    d{1}=forward.x.^2*m{1}+forward.x*m{2}+m{3};
end
</fo:block>
the <fo:inline font-family="monospace">forward.x</fo:inline> must be an array of the x-locations, for which the y-values of the corresponding line will be evaluated.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Note that the prior must be defined such that <fo:inline font-family="monospace">prior{1}</fo:inline> refer to the intercept, <fo:inline font-family="monospace">prior{2}</fo:inline> to the gradient, and <fo:inline font-family="monospace">prior{3}</fo:inline> to the 2nd order polynomial coefficient.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
If only one prior type is defined then the forward response will just be a constant, and if two prior types are defined, then the forward response will be a straight line.
</fo:block></fo:block><fo:block id="linefit_data"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Reference data, data, forward</fo:marker><fo:block font-size="17.28pt">Reference data, data, forward</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A reference data set can be computed using 
</fo:block><fo:block id="idm45886875467888" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
clear all;close all;
rand('seed',1);randn('seed',1);

%% Select reference model
m_ref{1}=-30;
m_ref{2}=2;
m_ref{3}=0; 

%% Setup the forward model in the 'forward' structure
nd=40;
forward.x=linspace(1,20,nd);
forward.forward_function='sippi_forward_linefit';

%% Compute a reference set of observed data
d=sippi_forward(m_ref,forward);
d_obs=d{1};
d_std=10;
d_obs=d_obs+randn(size(d_obs)).*d_std;

data{1}.d_obs=d_obs;
data{1}.d_std=d_std;
</fo:block><fo:block id="idm45886875467040"><fo:external-graphic src="url(figures/sippi_linefit_data_40.png)" width="40%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block><fo:block id="idm45886875464480"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">The prior model</fo:marker><fo:block font-size="17.28pt">The prior model</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
</fo:block><fo:block id="idm45886875463584" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
%% Setting up the prior model

% the intercept
im=1;
prior{im}.type='gaussian';
prior{im}.name='intercept';
prior{im}.m0=0;
prior{im}.std=30;
prior{im}.m_true=m_ref{1};

% 1st order, the gradient
im=2;
prior{im}.type='gaussian';
prior{im}.name='gradient';
prior{im}.m0=0;
prior{im}.std=4;
prior{im}.norm=80;
prior{im}.m_true=m_ref{2};

% 2nd order
im=3;
prior{im}.type='gaussian';
prior{im}.name='2nd';
prior{im}.m0=0;
prior{im}.std=1;
prior{im}.norm=80;
prior{im}.m_true=m_ref{3};

sippi_plot_prior_sample(prior);
</fo:block><fo:block id="idm45886875462672"><fo:external-graphic src="url(figures/sippi_line_fit_m1_3_prior_sample.png)" width="100%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block><fo:block id="idm45886875459456"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Setup and run the Metropolis sampler</fo:marker><fo:block font-size="17.28pt">Setup and run the Metropolis sampler</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Now, information about the model parameters can be inferred by running the <fo:basic-link internal-destination="sec_extendedmetropolis"><fo:inline>extended Metropolis sampler</fo:inline></fo:basic-link> using
</fo:block><fo:block id="idm45886875457776" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.nite=40000;  % Run for 40000 iterations
options.mcmc.i_sample=50; % Save every 50th visited model to disc
options.mcmc.i_plot=2500; % Plot the progress information for every 2500 iterations
options.txt='case_line_fit_2nd_order'; % descriptive name for the output folder

[options]=sippi_metropolis(data,prior,forward,options);

% plot posterior statistics, such as 1D and 2D marginals from the prior and posterior distributions
sippi_plot_prior_sample(options.txt);
sippi_plot_posterior(options.txt);
20140521_1644_sippi_metropolis_case_line_fit_2nd_order_m1_3_posterior_sample.png
</fo:block><fo:block id="idm45886875456560"><fo:external-graphic src="url(figures/20140521_1644_sippi_metropolis_case_line_fit_2nd_order_m1_3_posterior_sample.png)" width="100%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block><fo:block id="idm45886875453776" text-align="center"><fo:external-graphic src="url(figures/20140521_1644_sippi_metropolis_case_line_fit_2nd_order_post_marg_hist.png)" width="70%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit" text-align="center"/></fo:block></fo:block><fo:block id="idm45886875451488"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Setup and run the rejection sampler</fo:marker><fo:block font-size="17.28pt">Setup and run the rejection sampler</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
In a similar manner the <fo:basic-link internal-destination="sec_rejection"><fo:inline>rejection sampler</fo:inline></fo:basic-link> can be setup and run using 
</fo:block><fo:block id="idm45886875449088" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.adaptive_rejection=1; % automatically adjust the normalizing likelihood
options.mcmc.nite=100000;
options=sippi_rejection(data,prior,forward,options);
</fo:block></fo:block></fo:block><fo:block id="sec_ex_tomography"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Cross hole tomography</fo:marker><fo:block font-size="20.736pt">Cross hole tomography</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
SIPPI includes a <fo:basic-link internal-destination="arrenaes_data"><fo:inline>reference cross hole GPR data from Arrenaes</fo:inline></fo:basic-link> set is also available, and will be used here to demonstrate the use of SIPPI to solve cross hole tomographic inversion in a probabilistic framework. 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
SIPPI also includes the implementation of multiple methods for <fo:basic-link internal-destination="forward_traveltime"><fo:inline>computing the travel time delay between a set of sources and receivers</fo:inline></fo:basic-link>. This allows SIPPI to work on for example cross hole tomographic forward and inverse problems.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
This section contains examples for setting up and running an cross hole tomographic inversion using SIPPI using the <fo:basic-link internal-destination="arrenaes_data"><fo:inline>reference data from Arrens</fo:inline></fo:basic-link>, different types of a priori and <fo:basic-link internal-destination="forward_traveltime"><fo:inline>forward models</fo:inline></fo:basic-link>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Example Matlab scripts for the examples below, and more, are located in <fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/)">examples/case_tomography/</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/)">http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/</fo:basic-link>]</fo:inline>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Please see [<fo:basic-link internal-destination="sippipart2">HCLM13b</fo:basic-link>] for more details on the example of using SIPPI to sample the posterior for cross hole tomographic inverse problems. See [<fo:basic-link internal-destination="LoomsINF">LHC10</fo:basic-link>] for more details on the data from Arrens.
</fo:block><fo:block id="arrenaes_data"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Reference data set from Arrens</fo:marker><fo:block font-size="17.28pt">Reference data set from Arrens</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A 2D/3D data set of recorded travel time data from a cross hole Georadar experiment is available in the 'data/crosshole' folder.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
4 Boreholes were drilled, AM1, AM2, AM3, and AM4 at the locations shown below 
</fo:block><fo:block id="idm45886875436704" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure4.1.Location of boreholes AM1, AM2, AM3, and AM4 at Arrens.</fo:block><fo:block id="idm45886875436016"><fo:external-graphic src="url(figures/sippi_arrenaes_3d_setup.png)" width="35%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Travel time data were collected between boreholes AM1 and AM3, and AM2 and AM4 respectively, in a depth interval between 1m and 12m. The travel times for each of the two 2D data sets are available in the <fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM13_data.mat)">AM13_data.mat</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM13_data.mat)">http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM13_data.mat</fo:basic-link>]</fo:inline> and <fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM24_data.mat)">AM24_data.mat</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM24_data.mat)">http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM24_data.mat</fo:basic-link>]</fo:inline> files. All the data have been combined in the 3D data set available in <fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM1234_data.mat)">AM1234_data.mat</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM1234_data.mat)">http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM1234_data.mat</fo:basic-link>]</fo:inline>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
All mat-files contains the following variable
<fo:block id="idm45886875429808" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
S --&gt; [ndata,ndim] each row contains the position of the source
R --&gt; [ndata,ndim] each row contains the position of the receiver
d_obs --&gt; [ndata,1] each row contains the observed travel time in milliseconds 
d_std --&gt; [ndata,1] each row contains the standard deviation of the uncertainty of the observed travel time in milliseconds
</fo:block>
All data are also available as ASCII formatted EAS files in 
<fo:inline font-family="monospace"><fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM13_data.eas)">AM13_data.eas</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM13_data.eas)">http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM13_data.eas</fo:basic-link>]</fo:inline></fo:inline>, 
<fo:inline font-family="monospace"><fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM24_data.eas)">AM24_data.eas</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM24_data.eas)">http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM24_data.eas</fo:basic-link>]</fo:inline></fo:inline>, and 
<fo:inline font-family="monospace"><fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM1234_data.eas)">AM1234_data.eas</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM1234_data.eas)">http://svn.code.sf.net/p/sippi/code/trunk/data/crosshole/AM1234_data.eas</fo:basic-link>]</fo:inline></fo:inline>. 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The following 3 Figures show the ray coverage (using straight rays) for each of the AM13, AM24, and AM1234 data sets. The color of each ray indicates the average velocity along the ray computed using v_av = raylength/d_obs.
AM13 ray coverageAM24 ray coverageAM1234 ray coverage.
</fo:block><fo:block id="idm45886875425344" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure4.2.Ray coverage between wells left) AM1-AM3, middle) AM2-AM4, right) AM1-4.</fo:block><fo:block id="idm45886875424832"><fo:external-graphic src="url(figures/arrenaes_raycoverage.png)" width="75%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block></fo:block><fo:block id="forward_traveltime"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Travel delay computation: The forward problem</fo:marker><fo:block font-size="17.28pt">Travel delay computation: The forward problem</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A number of different methods for solving the problem of computing the first arrival travel time of a seismic or electromagnetic wave traveling between a source in one borehole and a receiver in another borehole has been implemented in the m-file 'sippi_forward_traveltime'.
<fo:block id="idm45886875419440" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
[d,forward,prior,data]=sippi_forward_traveltime(m,forward,prior,data,id,im)
</fo:block>
In order to use this m-file to describe the forward problem specify the 'forward_function' field in the <fo:inline font-family="monospace">forward</fo:inline> structure using 
<fo:block id="idm45886875418544" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
forward.forward_function='sippi_forward_traveltime';
</fo:block>

</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">In order to use <fo:inline font-family="monospace">sippi_forward_traveltime</fo:inline>, the location of the sources and receivers must be specified in the <fo:inline font-family="monospace">forward.S</fo:inline> and <fo:inline font-family="monospace">forward.R</fo:inline>. The number of columns reflect the number of data, and the number of rows reflect whether data are 2D (2 columns) or 3D (3 columns):
<fo:block id="idm45886875416096" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
forward.S %  [ndata,ndim]
forward.R %  [ndata,ndim]
</fo:block>
Using for example the data from Arrens, the forward geometry can be set up using 
<fo:block id="idm45886875415456" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
D=load('AM13_data.mat');
forward.sources=D.S;
forward.receivers=D.R;
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">In addition the method used to compute the travel times must also be given (see below).
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
In order to use the geometry from the AM13 reference data, and the Eikonal solution to the wave-equation, the <fo:inline font-family="monospace">forward</fo:inline> structure can be defined using
<fo:block id="idm45886875414192" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
D=load('AM13_data.mat');
forward.forward_function='sippi_forward_traveltime';
forward.sources=D.S;
forward.receivers=D.R;
forward.type='eikonal';
</fo:block>
</fo:block><fo:block id="idm45886875412592"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Ray type forward model (high frequency approximation)</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Ray type models are based on an assumption that the wave propagating between the source and the receiver has infinitely high frequency. Therefore the travel time delay is due to the velocity along a ray connecting the source and receiver.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The linear so-called straight ray approximation, which assumes that the travel time for a wave traveling between a source and a receiver is due to the travel time delay along a straight line connecting the source and receiver, can be chosen using
<fo:block id="idm45886875410592" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
forward.type='ray';
forward.linear=1;
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The corresponding so-called bended-ray approximation, where the travel time delay is due to the travel time delay along the fast ray path connecting a source and a receiver, can be chosen using
<fo:block id="idm45886875409616" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
forward.type='ray';
forward.linear=0;
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
When sippi_forward_traveltime has been called once, the associated forward mapping operator is stored in 'forward.G' such the the forward problem can simply be solved by calling e.g. 'd{1}=forward.G*m{1}'
</fo:block></fo:block><fo:block id="idm45886875407920"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Fat Ray type forward model (finite frequency approximation)</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Fat type model assume that the wave propagating between the source and the receiver has finite high frequency. This means that the travel time is sensitive to an area around the raypath, typically defined using the 1st Fresnel zone.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A linear fat ray kernel can be chosen using
<fo:block id="idm45886875406160" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
forward.type='fat';
forward.linear=1;
forward.freq=0.1;
</fo:block>
and the corresponding non-linear fat kernel using
<fo:block id="idm45886875405616" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
bforward.type='fat';
forward.linear=0;
forward.freq=0.1;
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Note that the center frequency of the propagating wave must also be provided in the 'forward.freq' field. The smaller the frequency, the 'fatter' the ray kernel.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
For 'fat' type forward models we rely on the method described by 
Jensen, J. M., Jacobsen, B. H., and Christensen-Dalsgaard, J. (2000). Sensitivity kernels for time-distance inversion. Solar Physics, 192(1), 231-239
</fo:block></fo:block><fo:block id="forward_traveltime_born"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Born type forward model (finite frequency approximation)</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Using the Born approximation, considering only first order scattering, can be chosen using
<fo:block id="idm45886875401792" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
forward.type='born';
forward.linear=1;
forward.freq=0.1;
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
For a velocity field with small spatial variability one can compute 'born' type kernels (using 'forward.linear=0', but as the spatial variability increases this is not possible.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
For the 'born' type forward model we make use if the method described by 
Buursink, M. L., Johnson, T. C., Routh, P. S., and Knoll, M. D. (2008). Crosshole radar velocity tomography with finitefrequency Fresnel volume sensitivities. Geophysical Journal International, 172(1), 1-17.
</fo:block></fo:block><fo:block id="idm45886875399632"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">The eikonal equation (high frequency approximation)</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The eikonal solution to the wave-equation is a high frequency approximation, such as the one given above.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
However, it is computationally more efficient to solve the eikonal equation directly, that to used the 'forward.type='ray';' type forward model.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"> 
To choose the eikonal solver to compute travel times use
<fo:block id="idm45886875397520" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
forward.type='eikonal';
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The Accurate Fast Marching Matlab toolbox : http://www.mathworks.com/matlabcentral/fileexchange/24531-accurate-fast-marching is used to solve the Eikonal equation.</fo:block></fo:block></fo:block><fo:block id="AM13_gaussian"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">AM13 Gaussian: Inversion of cross hole GPR data from Arrenaes data with a Gaussian type a priori model</fo:marker><fo:block font-size="17.28pt">AM13 Gaussian: Inversion of cross hole GPR data from Arrenaes data with a Gaussian type a priori model</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
In the following a simple 2D Gaussian a priori model is defined, and SIPPI is used to sample the corresponding a posteriori distribution. (An example script is avalable at <fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/sippi_AM13_metropolis_gaussian.m)">examples/case_tomography/sippi_AM13_metropolis_gaussian.m</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/sippi_AM13_metropolis_gaussian.m)">http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/sippi_AM13_metropolis_gaussian.m</fo:basic-link>]</fo:inline>).
</fo:block><fo:block id="AM13_data"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Setting up the data structure</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Initially we load the travel time data obtained at Arrens (See Arrens Data for more information)
<fo:block id="idm45886875391728" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
D=load('AM13_data.mat');
</fo:block>
This allow us to setup a SIPPI data structure defining the observed data as well as the associated model of uncertainty
<fo:block id="idm45886875391200" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
%% SETUP DATA  
id=1;
data{id}.d_obs=D.d_obs;
data{id}.d_std=D.d_std;
data{id}.dt=0; % Mean modelization error
data{id}.Ct=1; % Covariance describing modelization error
</fo:block>
In the above example we define a Gaussian modelization error, N(dt,Ct). We do this because we will make use of a forward model, the eikonal solver, that we know will systematically provide faster travel times than can be obtained from the earth. In reality the wave travelling between bore holes never has infinitely high frequency as assumed by using the eikonal solver. The eikonal solver provides the fast travel time along a ray connecting the source and receiver. Therefore we introduce a modelization error, that will allow all the travel times to be biased with the same travel time.
</fo:block></fo:block><fo:block id="AM13_prior_gaussian"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Setting up the prior model</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The a priori model is defined using the <fo:inline font-family="monospace">prior</fo:inline> data structure. Here a 2D Gaussian type a priori model in a 7x13 m grid (grid cell size .25m) using the <fo:basic-link internal-destination="prior_fftma"><fo:inline>FFTMA</fo:inline></fo:basic-link> type a priori model. The a priori mean is 0.145 m/ns, and the covariance function a Spherical type covariance model with a range of 6m, and a sill(variance) of 0.0003 m^2/ns^2.
<fo:block id="idm45886875387120" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
%% SETUP PRIOR 
im=1;
prior{im}.type='FFTMA';
prior{im}.m0=0.145;
prior{im}.Va='.0003 Sph(6)';
prior{im}.x=[-1:.15:6];
prior{im}.y=[0:.15:13];
</fo:block>
One could make used of the <fo:basic-link internal-destination="prior_visim"><fo:inline>VISIM</fo:inline></fo:basic-link> type priori model simply by substituting 'FFTMA' with 'VISIM' above.
</fo:block></fo:block><fo:block id="AM13_forward"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Setting up the forward structure</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:basic-link internal-destination="forward_traveltime"><fo:inline>'sippi_forward_traveltime'</fo:inline></fo:basic-link> require that the location of the sources an receivers are provided in 'forward' structure using the 'sources' and 'receivers' field names.
<fo:block id="idm45886875383440" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
D=load('AM13_data.mat');
forward.forward_function='sippi_forward_traveltime';
forward.sources=D.S;
forward.receivers=D.R;
forward.type='eikonal';
</fo:block>
Here the eikonal solution is chosen to solve the forward problem. See more detail about solving the forward problem related to cross hole first arrival travel time computation <fo:basic-link internal-destination="forward_traveltime"><fo:inline>here</fo:inline></fo:basic-link>.
</fo:block></fo:block><fo:block id="AM13_testing"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Testing the setup</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
As the 
<fo:inline font-family="monospace">prior</fo:inline>,
<fo:inline font-family="monospace">data</fo:inline>, and 
<fo:inline font-family="monospace">forward</fo:inline> have been defined, one can in principle initiate an inversion. However, it is advised to perform a few test before applying the inversion.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">

First, one should check that independent realization of the prior model resemble the a priori knowledge. A sample from the prior model can be generated and visualized calling <fo:basic-link internal-destination="sippi_plot_prior_sample"><fo:inline>sippi_plot_prior_sample</fo:inline></fo:basic-link>:
<fo:block id="idm45886875377600" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
sippi_plot_prior_sample(prior);
</fo:block>
which provides the following figure
<fo:block id="idm45886875377216" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure4.3.AM13: One sample (15 realizations) of the prior (Gaussian) model.</fo:block><fo:block id="idm45886875376544"><fo:external-graphic src="url(figures/AM13_prior_sample.png)" width="50%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block>

The one can check that the forward solver, and the computation of the likelihood wors as expected using
<fo:block id="idm45886875373296" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
% generate a realization from the prior
m=sippi_prior(prior);
% Compute the forward response related to the realization of the prior model generated above
[d]=sippi_forward(m,forward,prior,data);
% Compute the likelihood 
[logL,L,data]=sippi_likelihood(d,data);
% plot the forward response and compare it to the observed data
sippi_plot_data(d,data);
</fo:block>
which produce a figure similar to 
<fo:block id="idm45886875372544" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure4.4.AM13: Data response from one realization of the prior.</fo:block><fo:block id="idm45886875371968"><fo:external-graphic src="url(figures/AM13_data.png)" width="50%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block>
</fo:block></fo:block><fo:block id="AM13_metropolis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Sampling the a posterior distribution using the extended Metropolis algorithm</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="sec_extendedmetropolis"><fo:inline>extended Metropolis sampler</fo:inline></fo:basic-link> can now be run using <fo:basic-link internal-destination="sippi_metropolis"><fo:inline>sippi_metropolis</fo:inline></fo:basic-link>.
<fo:block id="idm45886875365568" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options=sippi_metropolis(data,prior,forward);
</fo:block>
In practice the user will have to set a few options, controlling the behavior of the algorithm. In the following example the number of iterations is set to 500000; the current model is saved to disc for every 500 iterations; the log-likelihood and current model is shown for every 1000 iterations:
<fo:block id="idm45886875365120" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.nite=500000; % optional, default:nite=30000
options.mcmc.i_sample=500; % optional, default:i_sample=500;
options.mcmc.i_plot=1000; % optional, default:i_plot=50;
options=sippi_metropolis(data,prior,forward,options);
</fo:block>
By default no <fo:basic-link internal-destination="sec_metropolis_annealing"><fo:inline>annealing schedule</fo:inline></fo:basic-link> is used. By default the <fo:basic-link internal-destination="sec_controling_step_length"><fo:inline>'step'-length</fo:inline></fo:basic-link> for sequential Gibbs sampling is adjusted (to obtain an average acceptance ratio of 30%) for every 50 iterations until iteration number 1000.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
An output folder will be generated with a filename formatted using 'YYYYMMDD-HHMM', followed by a automatic description. In the above case the output folder could be name '20140701_1450_sippi_metropolis_eikonal'.
The actual folder name is return in <fo:inline font-family="monospace">options.txt</fo:inline>.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
One can define a description for the folder name by setting <fo:inline font-family="monospace">options.txt</fo:inline> before running sippi_metropolis.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The folder contains one mat file, with the same name as the folder name, and N ASCII files (where N=length(prior); one for each a priori type) which contains the models saved to disc. They also have the same name as the folder name, appended with '_m1.asc', '_m2.asc', and so forth.
</fo:block><fo:block id="AM13_plot_posterior"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="12pt">Posterior statistics</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The function <fo:basic-link internal-destination="sippi_plot_posterior"><fo:inline>sippi_plot_posterior</fo:inline></fo:basic-link> can be called when <fo:basic-link internal-destination="sippi_metropolis"><fo:inline>sippi_metropolis</fo:inline></fo:basic-link> (or  <fo:basic-link internal-destination="sippi_rejection"><fo:inline>sippi_rejection</fo:inline></fo:basic-link>) and will plot the progress of the log-likelihood curve, a sample of the posterior, data response from a sample of the posterior, and (if applicable) 1D and 2D marginal posterior distributions.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Located in the output folder of the inversion use
<fo:block id="idm45886875355616" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
sippi_plot_posterior;
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
If the location of the folder with the output is known (such as options.txt) one can call
<fo:block id="idm45886875354608" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
sippi_plot_posterior(options.txt)
</fo:block>
</fo:block></fo:block></fo:block></fo:block><fo:block id="AM13_gaussian_modeling_error"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">AM13 Gaussian, accounting for modeling errors</fo:marker><fo:block font-size="17.28pt">AM13 Gaussian, accounting for modeling errors</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
[A Matlab script for the following example is avalable at <fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/sippi_AM13_metropolis_modeling_error.m)">examples/case_tomography/sippi_AM13_metropolis_modeling_error.m</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/sippi_AM13_metropolis_modeling_error.m)">http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/sippi_AM13_metropolis_modeling_error.m</fo:basic-link>]</fo:inline>.]
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The use of any of the <fo:basic-link internal-destination="forward_traveltime"><fo:inline>forward models</fo:inline></fo:basic-link> defined above, will be approximation to solving the perfect forward problem. 
This leads to a 'modeling' error as demonstrated by [<fo:basic-link internal-destination="hansen2014modelingerror">HCM14</fo:basic-link>]. If one has access to an optimal (but perhaps computational inefficient) forward model, and a faster (less accurate) forward model, then a Gaussian model of the modeling error caused by using the approximate, as opposed to the optima, forward model can be estimated using 
<fo:basic-link internal-destination="sippi_compute_modelization_forward_error"><fo:inline>sippi_compute_modelization_forward_error</fo:inline></fo:basic-link>.
sippi_compute_modelization_forward_error.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
SIPPI allows accounting for such modeling error through the <fo:inline font-family="monospace">dt</fo:inline> and <fo:inline font-family="monospace">Ct</fo:inline> fields for the <fo:basic-link internal-destination="sec_model_noise_gauss"><fo:inline>data</fo:inline></fo:basic-link> structure. 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The setup of the data, prior and forward structures is identical to the one described in the <fo:basic-link internal-destination="AM13_gaussian"><fo:inline>previous</fo:inline></fo:basic-link> example.
<fo:block id="idm45886875345296" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
%% Load the travel time data set from ARRENAES
clear all;close all
D=load('AM13_data.mat');
options.txt='AM13';

%% SETUP DATA
id=1;
data{id}.d_obs=D.d_obs;
data{id}.d_std=D.d_std;
data{id}.Ct=D.Ct+1; % Covariance describing modeling error

%% SETUP PRIOR
im=1;
prior{im}.type='FFTMA';
prior{im}.name='Velocity (m/ns)';
prior{im}.m0=0.145;
prior{im}.Va='.0003 Sph(6)';
dx=0.15;
prior{im}.x=[-1:dx:6];
prior{im}.y=[0:dx:13];
prior{im}.cax=[.1 .18];

% SETUP THE FORWARD MODEL USED IN INVERSION
forward.forward_function='sippi_forward_traveltime';
forward.sources=D.S;
forward.receivers=D.R;
forward.type='fat';forward.linear=1;forward.freq=0.1;
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
In order to compute the modeling with respect to using the <fo:basic-link internal-destination="forward_traveltime_born"><fo:inline>'Born'</fo:inline></fo:basic-link> type forward model, one can define a new forward structure, here <fo:inline font-family="monospace">forward_full</fo:inline>, and estimate a Gaussian model for the modeling error using
<fo:block id="idm45886875342512" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
% SETUP THE 'OPTIMAL' FORWARD MODEL
forward_full.forward_function='sippi_forward_traveltime';
forward_full.sources=D.S;
forward_full.receivers=D.R;
forward_full.type='Born';forward_full.linear=1;forward_full.freq=0.1;

% COMPUTE MODELING ERROR DUE TO USE OF forward AS OPPOSED TO forward_full
N=100;
[Ct,dt,dd]=sippi_compute_modelization_forward_error(forward_full,forward,prior,data,N);

% ASSIGN MODELING ERROR TO DATA
data{1}.dt=dt{1	};
data{1}.Ct=Ct{1};
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Sampling of the posterior can proceed exactly as for the previous example, using 
<fo:block id="idm45886875341168" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.nite=500000; % optional, default:nite=30000
options.mcmc.i_sample=500; % optional, default:i_sample=500;
options.mcmc.i_plot=1000; % optional, default:i_plot=50;
options=sippi_metropolis(data,prior,forward,options);

% plot posterior statistics
sippi_plot_posterior(options.txt);
</fo:block>
</fo:block></fo:block><fo:block id="AM13_bimodal"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">AM13 Gaussian with bimodal velocity distribution</fo:marker><fo:block font-size="17.28pt">AM13 Gaussian with bimodal velocity distribution</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
[A Matlab script for the following example is avalable at <fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/sippi_AM13_metropolis_bimodal.m)">examples/case_tomography/sippi_AM13_metropolis_bimodal.m</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/sippi_AM13_metropolis_bimodal.m)">http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/sippi_AM13_metropolis_bimodal.m</fo:basic-link>]</fo:inline>.]
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The <fo:basic-link internal-destination="prior_gaussian"><fo:inline>GAUSSIAN</fo:inline></fo:basic-link> and  <fo:basic-link internal-destination="prior_fftma"><fo:inline>FFTMA</fo:inline></fo:basic-link>a prior types implicitly assume a normal distribution of the model parameter. 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">It is however possible to change the Gaussian distribution to any shaped distribution, using a normal score transform. Note that when this is done the given semivariogram model for the <fo:basic-link internal-destination="prior_fftma"><fo:inline>FFTMA</fo:inline></fo:basic-link> a priori model will not be reproduced. If this is a concern, then the <fo:basic-link internal-destination="prior_visim"><fo:inline>VISIM</fo:inline></fo:basic-link> type a priori model should be used.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The data and forward structures is identical to the one described in the <fo:basic-link internal-destination="AM13_gaussian"><fo:inline>previous</fo:inline></fo:basic-link> example.
<fo:block id="idm45886875332352" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
%% Load the travel time data set from ARRENAES
clear all;close all
D=load('AM13_data.mat');
options.txt='AM13';

%% SETUP DATA
id=1;
data{id}.d_obs=D.d_obs;
data{id}.d_std=D.d_std;
data{id}.Ct=D.Ct+1; % Covariance describing modeling error

% SETUP THE FORWARD MODEL USED IN INVERSION
forward.forward_function='sippi_forward_traveltime';
forward.sources=D.S;
forward.receivers=D.R;
forward.type='fat';forward.linear=1;forward.freq=0.1;
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The desired distribution (the 'target' distribution) must be provided as a sample of the target distribution, in the <fo:inline font-family="monospace">data{id}.d_target</fo:inline> distribution.
<fo:block id="idm45886875330352" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
%% SETUP PRIOR
im=1;
prior{im}.type='FFTMA';
prior{im}.name='Velocity (m/ns)';
prior{im}.m0=0.145;
prior{im}.Va='.0003 Sph(6)';
dx=0.15;
prior{im}.x=[-1:dx:6];
prior{im}.y=[0:dx:13];
prior{im}.cax=[.1 .18];

% SET TARGET
N=1000;
prob_chan=0.5;
dd=.014*2;
d1=randn(1,ceil(N*(1-prob_chan)))*.01+0.145-dd;  %0.1125;
d2=randn(1,ceil(N*(prob_chan)))*.01+0.145+dd; %0.155;
d_target=[d1(:);d2(:)];
prior{im}.d_target=d_target;
</fo:block>
5 realizations from the corresponding a priori model looks like
<fo:block id="gaussian_bimodal_sample" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure4.5.5 realizations from a FFTMA prior model type with top) Gaussian and b) Bimodal distribution</fo:block><fo:block id="idm45886875328416"><fo:external-graphic src="url(figures/AM13_gaussian_sample.png)" width="75%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block><fo:block id="idm45886875328032"><fo:external-graphic src="url(figures/AM13_bimodal_sample.png)" width="75%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block>

Figure <fo:basic-link internal-destination="gaussian_bimodal_dist"><fo:inline>Figure4.6, Distribution of one realization using a Gaussian Bimodal target distribution</fo:inline></fo:basic-link> compares the distribution from one realization of both prior models considered above.
<fo:block id="gaussian_bimodal_dist" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure4.6.Distribution of one realization using a Gaussian Bimodal target distribution</fo:block><fo:block id="idm45886875321408"><fo:external-graphic src="url(figures/AM13_gaussian_bimodal_dist.png)" width="45%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
As for the examples above, the a posteriori distribution can be samples using e.g.
<fo:block id="idm45886875318032" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.nite=500000; % optional, default:nite=30000
options.mcmc.i_sample=500; % optional, default:i_sample=500;
options.mcmc.i_plot=1000; % optional, default:i_plot=50;
options=sippi_metropolis(data,prior,forward,options);

% plot posterior statistics
sippi_plot_posterior(options.txt);
</fo:block>
</fo:block></fo:block><fo:block id="AM13_gaussian_covariance_infer"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">AM13 Gaussian with unknown Gaussian model parameters</fo:marker><fo:block font-size="17.28pt">AM13 Gaussian with unknown Gaussian model parameters</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
[A Matlab script for the following example is avalable at <fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/sippi_AM13_metropolis_gaussian_covariance_inference.m)">examples/case_tomography/sippi_AM13_metropolis_gaussian_covariance_inference.m</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/sippi_AM13_metropolis_gaussian_covariance_inference.m)">http://svn.code.sf.net/p/sippi/code/trunk/examples/case_tomography/sippi_AM13_metropolis_gaussian_covariance_inference.m</fo:basic-link>]</fo:inline>.]
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
One of the most intriguing benefits (in addition to the computational efficiency) of using the <fo:basic-link internal-destination="prior_fftma"><fo:inline>FFTMA</fo:inline></fo:basic-link> type a priori model, is that it allows separation of the random component and the covariance model parameters. See [<fo:basic-link internal-destination="sippipart1">HCLM13a</fo:basic-link>].
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
This means that one can in SIPPI define an inverse problem, where the a priori model is Gaussian, but where the properties of the Gaussian model (such as the mean, range, anisotropy) can be treated as unknown model parameters 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Each property the Gaussian prior model that should be treated as an unknown model parameter, must be defined as a separate 1D type <fo:basic-link internal-destination="prior_fftma"><fo:inline>GAUSSIAN</fo:inline></fo:basic-link> type prior model, with a specific name (identifying the covariance model property it describes), and it mist point to the prior model type number for which it describes a covariance model property-
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The example below describes a 2D FFTMA type e a priori model (prior with id 1) with an unknown range (prior with id 2) with an a priori distribution described by a close to uniform distribution between 1.5m and 10.5m:
<fo:block id="idm45886875309888" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=1;
prior{im}.type='FFTMA';
prior{im}.name='Velocity (m/ns)';
prior{im}.m0=0.145;
prior{im}.Va='.0003 Sph(6)';
dx=0.25;
prior{im}.x=[-1:dx:6];
prior{im}.y=[0:dx:13];
prior{im}.cax=[.1 .18];

i_master=im;

% range - horizontal
im=im+1;
prior{im}.type='gaussian';
prior{im}.name='range_1'; % the name covariance model property to define
prior{im}.m0=6;
prior{im}.min=1.5;
prior{im}.max=10.5;
prior{im}.norm=50;
prior{im}.prior_master=i_master; % point to the id of the prior it describes
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Any combination of the following parameters can be set:
<fo:block id="idm45886875308576" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
prior{im}.name='range_1; % Range, along direction of angle_1
prior{im}.name='range_2; % Range, along direction of angle_2
prior{im}.name='range_3; % Range, along direction of angle_3
prior{im}.name='ang_1;   % Angle 1, degrees from North
prior{im}.name='ang_2;   % Angle 2
prior{im}.name='ang_3;   % Angle 3
prior{im}.name='sill;    % sill,
prior{im}.name='nu;      % the 'nu' parameter, only applies when using the Matern covariance model type.
prior{im}.name='m0;      % A priori mean
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
As an example consider case where the two ranges, and the angle of anisotropy fro a 2D Gaussian(FFTMA) a priori type model is treated as model parameters:
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
<fo:block id="idm45886875306368" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=0;
% velocity field
im=im+1;
prior{im}.type='FFTMA';
prior{im}.name='Velocity (m/ns)';
prior{im}.m0=0.145;
prior{im}.Va='.0003 Sph(6)';
dx=0.25;
prior{im}.x=[-1:dx:6];
prior{im}.y=[0:dx:13];
prior{im}.cax=[.1 .18];
i_master=im;

% range - horizontal
im=im+1;
prior{im}.type='gaussian';
prior{im}.name='range_1';
prior{im}.min=1.5;
prior{im}.max=10.5;
prior{im}.norm=50;
prior{im}.prior_master=i_master;

% range - horizontal
im=im+1;
prior{im}.type='gaussian';
prior{im}.name='range_2';
prior{im}.min=1.5;
prior{im}.max=5.5;
prior{im}.norm=50;
prior{im}.prior_master=i_master;


% rotation
im=im+1;
prior{im}.type='gaussian';
prior{im}.name='ang_1';
prior{im}.m0=90;
prior{im}.std=20;
prior{im}.norm=2;
prior{im}.prior_master=i_master;
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A sample from the corresponding a priori model (FFTMA type) is shown below:
<fo:block id="gaussian_covariance_sample" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure4.7.A sample from a FFTMA type prior model with varying range_1, range_2, and ang_1.</fo:block><fo:block id="idm45886875303888"><fo:external-graphic src="url(figures/AM13_covariance_sample.png)" width="65%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Samples of the a priori distributions for range_1, range_2, and ang_1 are shown here:
<fo:block id="gaussian_covariance_sample_1d" space-before.minimum="0.5em" space-before.optimum="1em" space-before.maximum="2em" space-after.minimum="0.5em" space-after.optimum="1em" space-after.maximum="2em" keep-together.within-column="always"><fo:block font-weight="bold" font-size="12pt" hyphenate="false" space-after.minimum="0.4em" space-after.optimum="0.6em" space-after.maximum="0.8em" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" keep-with-next.within-column="always">Figure4.8.Distribution of one sample of a 1D Gaussian distribution describing range_1, range_2, and ang_1</fo:block><fo:block id="idm45886875299360"><fo:external-graphic src="url(figures/AM13_covariance_sample_1d.png)" width="65%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block></fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
As for the examples above, the a posteriori distribution can be samples using e.g.
<fo:block id="idm45886875298848" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.nite=500000; % optional, default:nite=30000
options.mcmc.i_sample=500; % optional, default:i_sample=500;
options.mcmc.i_plot=1000; % optional, default:i_plot=50;
options=sippi_metropolis(data,prior,forward,options);

% plot posterior statistics
sippi_plot_posterior(options.txt);
</fo:block>
</fo:block></fo:block></fo:block><fo:block id="sec_ex_covarianceinference"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Probilistic covariance/semivariogram indeference</fo:marker><fo:block font-size="20.736pt">Probilistic covariance/semivariogram indeference</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
This chapter documents how to use SIPPI to infer properties of a covariance/semivariogram model from noisy data (both data of point support and linear average data can be considered)
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
To perform probabilistic inference of covariance model parameters one must 
<fo:list-block id="idm45886875293536" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em" space-after.optimum="1em" space-after.minimum="0.8em" space-after.maximum="1.2em" provisional-distance-between-starts="1.2em" provisional-label-separation="0.2em"><fo:list-item id="idm45886875292992" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>1.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
define the data and associated uncertainty (if any), 
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45886875293184" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>2.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
define a prior model of the covariance model parameters that one wish to infer information about, and 
</fo:block></fo:block></fo:list-item-body></fo:list-item><fo:list-item id="idm45886875291552" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:list-item-label end-indent="label-end()"><fo:block>3.</fo:block></fo:list-item-label><fo:list-item-body start-indent="body-start()"><fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
define the linear forward operator (only applicable if data are not of point support).
</fo:block></fo:block></fo:list-item-body></fo:list-item></fo:list-block>

</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The methodology is published in [<fo:basic-link internal-destination="HansenetalCovariance2015">HCM15</fo:basic-link>].
</fo:block><fo:block id="idm45886875289904"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Specification of covariance model parameters</fo:marker><fo:block font-size="17.28pt">Specification of covariance model parameters</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The following covariance model properties can be defined, that allow defining an isotropic or an-isotropic covariance model in 1D, 2D, or 3D: 
<fo:block id="idm45886875288640" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
type                % covariance model type (1-&gt;Sph, 2-&gt;Exp, 3-&gt;Gau)
m0                  % the mean
sill                % the variance
nugget_fraction     % percentage of the variance assigned to a Nugget
range_1             % range in primary direction
range_2             % range in secondary direction
range_3             % range in tertiary direction
ang_1               % first angle of rotation 
ang_2               % second angle of rotation 
ang_3               % third angle of rotation 
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Inference of a full 1D covariance model requires defining [type,sill,nugget_fraction,range_1].
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Inference of a full 2D covariance model requires defining [type,sill,nugget_fraction,range_1,range_2,ang_1].
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Inference of a full 3D covariance model requires defining [type,sill,nugget_fraction,range_1,range_2,range_3,ang_1,ang_2,ang_3].
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
In order to define which of the covariance model parameters to infer information about, simply define a  prior structure for any of these parameters, as 1D type SIPPI prior model. 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
For example, to simple infer information about the range in the primary direction, with a priori distribution of the range as U[0,3] use
<fo:block id="idm45886875284880" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
forward.Cm='1 Sph(10)';

im=1;
prior{im}.type='uniform';
prior{im}.name='range_1'; % the 'name' field is used to identify the covariance model parameter!
prior{im}.min=0;
prior{im}.max=3;
</fo:block>
In this case an <fo:inline font-family="monospace">range_1</fo:inline> refers to the isotropic range in the covariance model defined in the <fo:inline font-family="monospace">forward.Cm</fo:inline> field
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
If, instead 
<fo:block id="idm45886875282656" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
forward.Cm='1 Sph(10,90,.25)';
</fo:block>
then <fo:inline font-family="monospace">range_1</fo:inline> would refer to the range in the direction of maximum continuity (90 degrees from North). <fo:inline font-family="monospace">range_2</fo:inline> will in this case be fixed.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
As described above, the covariance model type can be considered as a unknown parameter, that can be inferred during inversion. This may pose some problems as discussed in [<fo:basic-link internal-destination="HansenetalCovariance2015">HCM15</fo:basic-link>]. 
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
To infer the covariance model type, a prior 1D structure should be defined as e.g.
<fo:block id="idm45886875279792" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=1;
prior{im}.type='uniform';
prior{im}.name='type'; % 
prior{im}.min=0;
prior{im}.max=3;
</fo:block>
Any value between 0 and 1 defines a spherical type covariance.
Any value between 1 and 2 defines an exponential type covariance.
Any value between 3 and 3 defines a Gaussian type covariance.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Thus no prior should be defined for the 'type' prior that can provide values below 0, and above 3. In the case above, all three covariance model types has the sane a priori probability.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A detailed description of how to parameterize the inverse covariance model parameter problem, can be found in <fo:basic-link internal-destination="sippi_forward_covariance_inference"><fo:inline>sippi_forward_covariance_inference</fo:inline></fo:basic-link>. 
</fo:block></fo:block><fo:block id="idm45886875276960"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">Inferring a 2D covariance model from the Jura data set - Example of point support</fo:marker><fo:block font-size="17.28pt">Inferring a 2D covariance model from the Jura data set - Example of point support</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
The Jura data set (see Goovaerts, 1997) contains a number observations of different properties in 2D. Below is an example of how to infer properties of a 2D covariance model from this data set.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
A Matlab script implementing the steps below can be found here:
<fo:basic-link external-destination="url(http://sourceforge.net/p/sippi/code/HEAD/tree/trunk/examples/covariance_inference/jura_covariance_inference.m)">jura_covariance_inference.m</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://sourceforge.net/p/sippi/code/HEAD/tree/trunk/examples/covariance_inference/jura_covariance_inference.m)">http://sourceforge.net/p/sippi/code/HEAD/tree/trunk/examples/covariance_inference/jura_covariance_inference.m</fo:basic-link>]</fo:inline>
</fo:block><fo:block id="idm45886875275648"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Load the Jura data</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Firs the Jura data is loaded. 
<fo:block id="idm45886875273648" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
% jura_covariance_inference
%
% Example of inferring properties of a Gaussian model from point data
%

%% LOAD THE JURA DATA
clear all;close all
[d_prediction,d_transect,d_validation,h_prediction,h_transect,h_validation,x,y,pos_est]=jura;
ix=1;
iy=2;
id=6;

% get the position of the data
pos_known=[d_prediction(:,[ix iy])];  

% perform normal score transformation of tha original data
[d,o_nscore]=nscore(d_prediction(:,id));
h_tit=h_prediction{id};

</fo:block>
</fo:block></fo:block><fo:block id="idm45886875273840"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:block font-size="14.4pt">Setting up SIPPI for covariance parameter inference</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
First a SIPPI 'prior' data structure is setup do infer covariance model parameters for a 2D an-isotropic covariance model. That is, the 
<fo:inline font-family="monospace">range_1</fo:inline>, 
<fo:inline font-family="monospace">range_2</fo:inline>, 
<fo:inline font-family="monospace">ang_1</fo:inline>, and
<fo:inline font-family="monospace">nugget_fraction</fo:inline> are defined using 
<fo:block id="idm45886875269248" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
im=0;
% A close to uniform distribution of the range, U[0;3].
im=im+1;
prior{im}.type='uniform';
prior{im}.name='range_1';
prior{im}.min=0;
prior{im}.max=3;

im=im+1;
prior{im}.type='uniform';
prior{im}.name='range_2';
prior{im}.min=0;
prior{im}.max=3;

im=im+1;
prior{im}.type='uniform';
prior{im}.name='ang_1';
prior{im}.min=0;
prior{im}.max=90;

im=im+1;
prior{im}.type='uniform';
prior{im}.name='nugget_fraction';
prior{im}.min=0;
prior{im}.max=1;
</fo:block>
Thus the a priori information consists of uniform distributions of ranges between 0 and 3, rotation between 0 and 90, and a nugget fraction between 0 and 1 is.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Then the data structure is set up, using the Jura data selected above, while assuming a Gaussian measurement uncertainty with a standard deviation of 0.1 times the standard deviation of the data:
<fo:block id="idm45886875267888" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
%% DATA
data{1}.d_obs=d; % observed data
data{1}.d_std=0.1*std(d);.4; % uncertainty of observed data (in form of standard deviation of the noise)
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Finally the forward structure is setup such that <fo:inline font-family="monospace">sippi_forward_covariance_inference</fo:inline> allow inference of covariance model parameters.
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
In the <fo:inline font-family="monospace">forward</fo:inline> structure the location of the point data needs to be given in the <fo:inline font-family="monospace">pos_known</fo:inline> field, and the initial mean and covariance needs to be set. Also, the name of the forward function used (in this case <fo:basic-link internal-destination="sippi_forward_covariance_inference"><fo:inline>sippi_forward_covariance_inference</fo:inline></fo:basic-link>) must be set. Use e.g.:
<fo:block id="idm45886875263920" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
%% FORWARD
forward.forward_function='sippi_forward_covariance_inference';
forward.point_support=1;
forward.pos_known=pos_known;

% initial choice of N(m0,Cm), mean and sill are 0, and 1, due
% due to normal score
forward.m0=mean(d);
forward.Cm=sprintf('%3.1f Sph(2)',var(d));
</fo:block>
</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Now, SIPPI is set up for inference of covariance model parameters. Use for example the Metropolis sampler to sample the a posterior distribution over the covariance model parameters using:
<fo:block id="idm45886875264576" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">
options.mcmc.nite=100000;
options.mcmc.i_plot=1000;
options.mcmc.i_sample=25;
options.txt=name;
[options,data,prior,forward,m_current]=sippi_metropolis(data,prior,forward,options)

sippi_plot_prior(options.txt);
sippi_plot_posterior(options.txt);
</fo:block>



</fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">
Sampling the posterior provides the following 2D marginal distributions
<fo:block id="idm45886875261664"><fo:external-graphic src="url(figures/20141114_1043_sippi_metropolis_Co_post_marg2d_scatter_combined.png)" width="100%" height="auto" content-width="scale-to-fit" content-height="scale-to-fit"/></fo:block>
Note how several areas of high density scatter points (i.e. areas with high posterior probability) can be found.
</fo:block></fo:block></fo:block></fo:block></fo:flow></fo:page-sequence>

  
  
<fo:page-sequence hyphenate="true" master-reference="back" language="en" format="1" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Bibliography</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Bibliography</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-inner-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body"><fo:block id="idm45886875257440"><fo:block><fo:block><fo:block margin-left="0pt" font-size="24.8832pt" font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold"><fo:block xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" keep-with-next.within-column="always" space-before.optimum="10pt" space-before.minimum="10pt * 0.8" space-before.maximum="10pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Bibliography</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="LoomsINF" start-indent="0.5in" text-indent="-0.5in" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">[LHC10] <fo:inline><fo:inline>M. C. Looms, T. M. Hansen, K. S. Cordua, L. Nielsen, K. H. Jensen, and A. Binley. </fo:inline><fo:inline font-style="italic">Geostatistical inference using crosshole ground-penetrating radar : Geostatistical inference using GPR <fo:basic-link external-destination="url(https://www.researchgate.net/profile/Thomas_Hansen6/publication/257942511_Geostatistical_inference_using_crosshole_ground-penetrating_radar/file/9c960526681ec170d8.pdf?origin=publication_detail)">PDF</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://www.researchgate.net/profile/Thomas_Hansen6/publication/257942511_Geostatistical_inference_using_crosshole_ground-penetrating_radar/file/9c960526681ec170d8.pdf?origin=publication_detail)">https://www.researchgate.net/profile/Thomas_Hansen6/publication/257942511_Geostatistical_inference_using_crosshole_ground-penetrating_radar/file/9c960526681ec170d8.pdf?origin=publication_detail</fo:basic-link>]</fo:inline></fo:inline>. <fo:inline>J29--J41. </fo:inline><fo:inline><fo:basic-link external-destination="url(http://dx.doi.org/10.1190/1.3496001)">10.1190/1.3496001</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://dx.doi.org/10.1190/1.3496001)">http://dx.doi.org/10.1190/1.3496001</fo:basic-link>]</fo:inline>. </fo:inline></fo:inline><fo:inline><fo:inline font-style="italic">Geophysics</fo:inline>. <fo:inline>75. </fo:inline><fo:inline>2010. </fo:inline></fo:inline></fo:block><fo:block id="CorduaFWI" start-indent="0.5in" text-indent="-0.5in" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">[CHM12] <fo:inline><fo:inline>K. S. Cordua, T. M. Hansen, and K. Mosegaard. </fo:inline><fo:inline font-style="italic">Monte Carlo full waveform inversion of crosshole GPR data
  using multiple-point geostatistical a priori information <fo:basic-link external-destination="url(https://www.researchgate.net/profile/Knud_Cordua/publication/258647313_Monte_Carlo_full-waveform_inversion_of_crosshole_GPR_data_using_multiple-point_geostatistical_a_priori_information/file/504635232fe3877a86.pdf?origin=publication_detail)">PDF</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://www.researchgate.net/profile/Knud_Cordua/publication/258647313_Monte_Carlo_full-waveform_inversion_of_crosshole_GPR_data_using_multiple-point_geostatistical_a_priori_information/file/504635232fe3877a86.pdf?origin=publication_detail)">https://www.researchgate.net/profile/Knud_Cordua/publication/258647313_Monte_Carlo_full-waveform_inversion_of_crosshole_GPR_data_using_multiple-point_geostatistical_a_priori_information/file/504635232fe3877a86.pdf?origin=publication_detail</fo:basic-link>]</fo:inline></fo:inline>. <fo:inline>H19--H31. </fo:inline><fo:inline> <fo:basic-link external-destination="url(http://dx.doi.org/10.1190/geo2011-0170.1)">10.1190/geo2011-0170.1</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://dx.doi.org/10.1190/geo2011-0170.1)">http://dx.doi.org/10.1190/geo2011-0170.1</fo:basic-link>]</fo:inline>. </fo:inline></fo:inline><fo:inline><fo:inline font-style="italic">Geophysics</fo:inline>. <fo:inline>77. </fo:inline><fo:inline>2012. </fo:inline></fo:inline></fo:block><fo:block id="sippipart1" start-indent="0.5in" text-indent="-0.5in" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">[HCLM13a] <fo:inline><fo:inline>T.M. Hansen, K.S. Cordua, M.C. Looms, and K. Mosegaard. </fo:inline><fo:inline font-style="italic"> SIPPI: a Matlab toolbox for sampling the solution to inverse
  problems with complex prior information: Part 1, methodology <fo:basic-link external-destination="url(https://www.researchgate.net/profile/Knud_Cordua/publication/256505077_SIPPI_A_Matlab_toolbox_for_Sampling_the_solution_to_Inverse_Problems_with_complex_Prior_Information_Part_1__Methodology/file/60b7d52330298eebb1.pdf?origin=publication_detail)">PDF</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://www.researchgate.net/profile/Knud_Cordua/publication/256505077_SIPPI_A_Matlab_toolbox_for_Sampling_the_solution_to_Inverse_Problems_with_complex_Prior_Information_Part_1__Methodology/file/60b7d52330298eebb1.pdf?origin=publication_detail)">https://www.researchgate.net/profile/Knud_Cordua/publication/256505077_SIPPI_A_Matlab_toolbox_for_Sampling_the_solution_to_Inverse_Problems_with_complex_Prior_Information_Part_1__Methodology/file/60b7d52330298eebb1.pdf?origin=publication_detail</fo:basic-link>]</fo:inline></fo:inline>. <fo:inline>470--480. </fo:inline><fo:inline><fo:basic-link external-destination="url(http://dx.doi.org/10.1016/j.cageo.2012.09.004)">doi:10.1016/j.cageo.2012.09.004</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://dx.doi.org/10.1016/j.cageo.2012.09.004)">http://dx.doi.org/10.1016/j.cageo.2012.09.004</fo:basic-link>]</fo:inline>. </fo:inline></fo:inline><fo:inline><fo:inline font-style="italic">Computers &amp; Geosciences</fo:inline>. <fo:inline>52. </fo:inline><fo:inline>03 2013. </fo:inline></fo:inline></fo:block><fo:block id="sippipart2" start-indent="0.5in" text-indent="-0.5in" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">[HCLM13b] <fo:inline><fo:inline>T.M. Hansen, K.S. Cordua, M.C. Looms, and K. Mosegaard. </fo:inline><fo:inline font-style="italic">SIPPI: a Matlab toolbox for sampling the solution to inverse
  problems with complex prior information: Part 2, Application to cross hole
  GPR tomography <fo:basic-link external-destination="url(https://www.researchgate.net/profile/Knud_Cordua/publication/256505491_SIPPI_A_Matlab_toolbox_for_sampling_the_solution_to_inverse_problems_with_complex_prior_information_Part_2Application_to_crosshole_GPR_tomography/file/e0b4952330a440635d.pdf?origin=publication_detail)">PDF</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://www.researchgate.net/profile/Knud_Cordua/publication/256505491_SIPPI_A_Matlab_toolbox_for_sampling_the_solution_to_inverse_problems_with_complex_prior_information_Part_2Application_to_crosshole_GPR_tomography/file/e0b4952330a440635d.pdf?origin=publication_detail)">https://www.researchgate.net/profile/Knud_Cordua/publication/256505491_SIPPI_A_Matlab_toolbox_for_sampling_the_solution_to_inverse_problems_with_complex_prior_information_Part_2Application_to_crosshole_GPR_tomography/file/e0b4952330a440635d.pdf?origin=publication_detail</fo:basic-link>]</fo:inline></fo:inline>. <fo:inline>481--492. </fo:inline><fo:inline><fo:basic-link external-destination="url(http://dx.doi.org/10.1016/j.cageo.2012.10.001)">doi:10.1016/j.cageo.2012.10.001</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://dx.doi.org/10.1016/j.cageo.2012.10.001)">http://dx.doi.org/10.1016/j.cageo.2012.10.001</fo:basic-link>]</fo:inline>. </fo:inline></fo:inline><fo:inline><fo:inline font-style="italic">Computers &amp; Geosciences</fo:inline>. <fo:inline>52. </fo:inline><fo:inline>03 2013. </fo:inline></fo:inline></fo:block><fo:block id="HansenetalGibbs2012" start-indent="0.5in" text-indent="-0.5in" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">[HCM12] <fo:inline><fo:inline>T. M. Hansen, K. C. Cordua, and K. Mosegaard. </fo:inline><fo:inline font-style="italic">Inverse problems with non-trivial priors - efficient solution
  through sequential Gibbs sampling <fo:basic-link external-destination="url(https://www.researchgate.net/profile/Knud_Cordua/publication/257550612_Inverse_problems_with_non-trivial_priors_efficient_solution_through_sequential_Gibbs_sampling/file/3deec52330d617d867.pdf?origin=publication_detail)">PDF</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://www.researchgate.net/profile/Knud_Cordua/publication/257550612_Inverse_problems_with_non-trivial_priors_efficient_solution_through_sequential_Gibbs_sampling/file/3deec52330d617d867.pdf?origin=publication_detail)">https://www.researchgate.net/profile/Knud_Cordua/publication/257550612_Inverse_problems_with_non-trivial_priors_efficient_solution_through_sequential_Gibbs_sampling/file/3deec52330d617d867.pdf?origin=publication_detail</fo:basic-link>]</fo:inline></fo:inline>. <fo:inline>593--611. </fo:inline><fo:inline><fo:basic-link external-destination="url(http://dx.doi.org/10.1007/s10596-011-9271-1)">doi:10.1007/s10596-011-9271-1</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://dx.doi.org/10.1007/s10596-011-9271-1)">http://dx.doi.org/10.1007/s10596-011-9271-1</fo:basic-link>]</fo:inline>. </fo:inline></fo:inline><fo:inline><fo:inline font-style="italic">Computational Geosciences</fo:inline>. <fo:inline>16. </fo:inline><fo:inline>3. </fo:inline><fo:inline>2012. </fo:inline></fo:inline></fo:block><fo:block id="SambridgeTempering2013" start-indent="0.5in" text-indent="-0.5in" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">[S13] <fo:inline><fo:inline>M. Sambridge. </fo:inline><fo:inline font-style="italic">A Parallel Tempering algorithm for probabilistic sampling and multimodal optimization</fo:inline>. <fo:inline>. </fo:inline><fo:inline><fo:basic-link external-destination="url(http://dx.doi.org/10.1093/gji/ggt342)">doi:10.1093/gji/ggt342</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://dx.doi.org/10.1093/gji/ggt342)">http://dx.doi.org/10.1093/gji/ggt342</fo:basic-link>]</fo:inline>. </fo:inline></fo:inline><fo:inline><fo:inline font-style="italic">Geophysical Journal International</fo:inline>. <fo:inline>. </fo:inline><fo:inline>. </fo:inline><fo:inline>2013. </fo:inline></fo:inline></fo:block><fo:block id="hansen2014modelingerror" start-indent="0.5in" text-indent="-0.5in" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">[HCM14] <fo:inline><fo:inline>T. M. Hansen, K. S. Cordua, B. H. Jacobsen, and K. Mosegaard. </fo:inline><fo:inline font-style="italic">Accounting for imperfect forward modeling in geophysical inverse
  problems - exemplified for cross hole tomography <fo:basic-link external-destination="url(https://www.researchgate.net/profile/Knud_Cordua/publication/261135164_Accounting_for_imperfect_forward_modeling_in_geophysical_inverse_problems_-_exemplified_for_cross_hole_tomography/file/9c960533939d3a416e.pdf?origin=publication_detail)">PDF</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(https://www.researchgate.net/profile/Knud_Cordua/publication/261135164_Accounting_for_imperfect_forward_modeling_in_geophysical_inverse_problems_-_exemplified_for_cross_hole_tomography/file/9c960533939d3a416e.pdf?origin=publication_detail)">https://www.researchgate.net/profile/Knud_Cordua/publication/261135164_Accounting_for_imperfect_forward_modeling_in_geophysical_inverse_problems_-_exemplified_for_cross_hole_tomography/file/9c960533939d3a416e.pdf?origin=publication_detail</fo:basic-link>]</fo:inline></fo:inline>. <fo:inline>H1-H21. </fo:inline><fo:inline><fo:basic-link external-destination="url(http://dx.doi.org/10.1190/geo2013-0215.1)">doi:10.1190/geo2013-0215.1</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://dx.doi.org/10.1190/geo2013-0215.1)">http://dx.doi.org/10.1190/geo2013-0215.1</fo:basic-link>]</fo:inline>. </fo:inline></fo:inline><fo:inline><fo:inline font-style="italic">Geophysics</fo:inline>. <fo:inline>39. </fo:inline><fo:inline>3. </fo:inline><fo:inline>2014. </fo:inline></fo:inline></fo:block><fo:block id="HansenetalCovariance2015" start-indent="0.5in" text-indent="-0.5in" space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em">[HCM15] <fo:inline><fo:inline>T. M. Hansen, K. C. Cordua, and K. Mosegaard. </fo:inline><fo:inline font-style="italic">A general probabilistic approach for inference of Gaussian model parameters from noise data of point and volume support [<fo:basic-link external-destination="url()">PDF</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url()"/>]</fo:inline>]</fo:inline>. <fo:inline>1-23. </fo:inline><fo:inline><fo:basic-link external-destination="url(http://dx.doi.org/10.1007/s11004-014-9567-5)">doi:10.1007/s11004-014-9567-5</fo:basic-link><fo:inline hyphenate="false"> [<fo:basic-link external-destination="url(http://dx.doi.org/10.1007/s11004-014-9567-5)">http://dx.doi.org/10.1007/s11004-014-9567-5</fo:basic-link>]</fo:inline>. </fo:inline></fo:inline><fo:inline><fo:inline font-style="italic">Mathematical Geosciences</fo:inline>. <fo:inline>. </fo:inline><fo:inline>. </fo:inline><fo:inline>2015. </fo:inline></fo:inline></fo:block></fo:flow></fo:page-sequence>


  <fo:page-sequence xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" hyphenate="true" master-reference="body" language="en" format="1" initial-page-number="auto" force-page-count="no-force" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2"><fo:static-content flow-name="xsl-region-before-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Reference</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block>Reference</fo:block></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-before-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-bottom-width="0.5pt" border-bottom-style="solid" border-bottom-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="right" display-align="before" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-footnote-separator"><fo:block><fo:leader color="black" leader-pattern="rule" leader-length="1in"/></fo:block></fo:static-content><fo:static-content flow-name="blank-body"><fo:block text-align="center"/></fo:static-content><fo:static-content flow-name="xsl-region-inner-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-inner-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-first"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-odd"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-even"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-outer-blank"><fo:block/></fo:static-content><fo:static-content flow-name="xsl-region-after-first"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-odd"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-even"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:static-content flow-name="xsl-region-after-blank"><fo:block font-family="serif,Symbol,ZapfDingbats" margin-left="0pt"><fo:table table-layout="fixed" width="100%" border-top-width="0.5pt" border-top-style="solid" border-top-color="black"><fo:table-column column-number="1" column-width="proportional-column-width(1)"/><fo:table-column column-number="2" column-width="proportional-column-width(1)"/><fo:table-column column-number="3" column-width="proportional-column-width(1)"/><fo:table-body><fo:table-row block-progression-dimension.minimum="14pt"><fo:table-cell text-align="start" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell><fo:table-cell text-align="center" display-align="after" relative-align="baseline"><fo:block><fo:block><fo:page-number/></fo:block></fo:block></fo:table-cell><fo:table-cell text-align="end" display-align="after" relative-align="baseline"><fo:block><fo:block/></fo:block></fo:table-cell></fo:table-row></fo:table-body></fo:table></fo:block></fo:static-content><fo:flow flow-name="xsl-region-body" start-indent="4pc" end-indent="0pt"><fo:block id="chapReference"><fo:block font-family="sans-serif,Symbol,ZapfDingbats"><fo:block margin-left="0pt"><fo:block font-size="24.8832pt" font-weight="bold"><fo:block keep-with-next.within-column="always" space-before.optimum="10pt" space-before.minimum="10pt * 0.8" space-before.maximum="10pt * 1.2" hyphenate="false" text-align="start" start-indent="0pt" hyphenation-character="-" hyphenation-push-character-count="2" hyphenation-remain-character-count="2">Chapter5.Reference</fo:block></fo:block></fo:block></fo:block></fo:block><fo:block id="idm45886875169392"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">SIPPI</fo:marker><fo:block font-size="20.736pt">SIPPI</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/><fo:block id="sippi_adjust_step_size"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_adjust_step_size</fo:marker><fo:block font-size="17.28pt">sippi_adjust_step_size</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875166544" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_adjust_step_size Adjust step length length for Metropolis sampler in SIPPI
   
  Call : 
    step=sippi_adjust_step_size(step,P_average,P_target);
 
  step : current step 
  P_current : Current acceptance ratio
  P_target  : preferred acceptance ratio (def=0.3);
 
  See also sippi_compute_acceptance_rate, sippi_prior_set_steplength
 
</fo:block></fo:block></fo:block><fo:block id="sippi_anneal_temperature"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_anneal_temperature</fo:marker><fo:block font-size="17.28pt">sippi_anneal_temperature</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875164784" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_anneal_temperature : compute annealing temperature for
  annealing type sampling
 
    %% ANNEALING (TEMPERATURE AS A FUNTION OF ITERAITON NUMBER)
     i % iteration number
 
     mcmc.anneal.i_begin=1; % default, iteration number when annealing begins
     mcmc.anneal.i_end=100000; %  iteration number when annealing stops
     mcmc.anneal.T_begin=5; % Start temperature for annealing 
     mcmc.anneal.T_end=1; % End temperature for anneaing 
 
     mcmc.anneal.type='exp';     % Exponential temperature change
     mcmc.anneal.type='linear';  % Linear temperature change
  
  Call
    [T,mcmc]=sippi_anneal_temperature(i,mcmc);
 
  See also sippi_metropolis
 
</fo:block></fo:block></fo:block><fo:block id="sippi_compute_acceptance_rate"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_compute_acceptance_rate</fo:marker><fo:block font-size="17.28pt">sippi_compute_acceptance_rate</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875162704" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_compute_acceptance_rate Computes acceptance rate for the Metropolis sampler in SIPPI
 
  Call:
    P_acc=sippi_compute_acceptance_rate(acc,n_update_history);
 
</fo:block></fo:block></fo:block><fo:block id="sippi_compute_modelization_forward_error"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_compute_modelization_forward_error</fo:marker><fo:block font-size="17.28pt">sippi_compute_modelization_forward_error</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875160640" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_compute_modelization_forward_error Computes an estimate of the modelization erro
 
  Computes and estimate of the Gaussian modelization error, N(dt,Ct)
  caused by the use of an imperfect forward kernel
 
  If called with only one output '[Ct]=sippi..]' then the Gaussian model is
  assumed by centered around 0, (dt{1}=0).
 
  Call
    [Ct,dt,dd]=sippi_compute_modelization_forward_error(forward_full,forward_app,prior,N,d);
 
 
  For details see:
   Hansen, T.M., Cordua, K. S., Jacobsen, B. J., and Mosegaard, K. (2014)
   Accounting for imperfect forward modeling in geophysical inverse problems - exemplified for cross hole tomography.
   Geophsyics, 79(3) H1-H21, 2014. doi:10.1190/geo2013-0215.1
 
</fo:block></fo:block></fo:block><fo:block id="sippi_forward"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_forward</fo:marker><fo:block font-size="17.28pt">sippi_forward</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875158512" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_forward Simple forward wrapper for SIPPI
 
  Assumes that the actual forward solver has been defined by
  forward.forward_function
 
  Call:
    [d,forward,prior,data]=sippi_forward(m,forward)
 
  Optional: 
    [d,forward,prior,data]=sippi_forward(m,forward,prior)
    [d,forward,prior,data]=sippi_forward(m,forward,prior,data)
    [d,forward,prior,data]=sippi_forward(m,forward,prior,data,options)
 
</fo:block></fo:block></fo:block><fo:block id="sippi_forward_linear"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_forward_linear</fo:marker><fo:block font-size="17.28pt">sippi_forward_linear</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875156240" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_forward_linear: 
 
  % options:
  forward.G : Linear forward operator. such that d[
              d{id}=forward.G*m{im}(:)
              if not set, forward.G=eye(prod(size(m{im})));
 
  forward.force_sparse [0]: Use forward.G as is (default)
                      [1]: force forward.G to be treated as a sparse matrix
 
  %% Examples
  % Define an example of a prior model
     forward.forward_function='sippi_forward_linear';
     im=1;
     prior{im}.type='FFTMA';
     prior{im}.x=[0:1:100];
     prior{im}.m0=0;
     prior{im}.Va='1 Sph(10)';
  % Define the use of the linear forward solver
     forward.forward_function='sippi_forward_linear';
 
  % Example 1: Identity, 
  %             by default an identity operator is used if the linear
  %             is not set
    m=sippi_prior(prior);
    tic;
    d=sippi_forward(m,forward);
    t1=toc;
    figure(1);
    subplot(1,2,1);plot(m{1});title('m')
    subplot(1,2,2);plot(d{1});title('d')
    suptitle(sprintf('Ex1, Identity, t=%g',t1))
 
  % Example 2: Linear Operator
    nd=prod(size(m{im}));
    forward.G=precal_cov_2d(nd,1,1,1,'1 Sph(10)');
    tic;
    d=sippi_forward(m,forward);
    t2=toc;
    figure(2);
    subplot(1,2,1);plot(m{1});title('m')
    subplot(1,2,2);plot(d{1});title('d')
    suptitle(sprintf('Ex2, t=%g',t2))
 
 
   % Example 3: Force forward.G to be sparse
    forward.force_sparse=1;
    tic;
    d=sippi_forward(m,forward);
    t3=toc;
    figure(3);
    subplot(1,2,1);plot(m{1});title('m')
    subplot(1,2,2);plot(d{1});title('d')
    suptitle(sprintf('Force sparse, t=%g',t3))
 
  See also: sippi_forward
</fo:block></fo:block></fo:block><fo:block id="sippi_get_resim_data"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_get_resim_data</fo:marker><fo:block font-size="17.28pt">sippi_get_resim_data</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875153232" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_get_resim_data: Get conditional data for resimulation
 
  d_cond=sippi_get_resim_data(m_current,prior,ip);
  
  c_cond [n_cond,4]: col1: x, col2: y, col4: z, col4: d
 
  See also sippi_prior
 
</fo:block></fo:block></fo:block><fo:block id="sippi_get_sample"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_get_sample</fo:marker><fo:block font-size="17.28pt">sippi_get_sample</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875151392" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_get_sample: Get a posterior sample
 
  Call :
   [reals,etype_mean,etype_var,reals_all,reals_ite]=sippi_get_sample(working_directory,im,n_reals,skip_seq_gibbs);
 
     im: A priori model type
     n_reals: Number of realizations to return
     skip_seq_gibbs [1] Skip all realization where sequential gibbs is enabled
                    [0] Use all realization
     data: SIPPI data structure
     prior: SIPPI prior structure
     options: options structure when running sippi_metropolis
 
 
  If located in a SIPPI output folder one can simple use :
     [reals,etype_mean,etype_var,reals_all,reals_ite]=sippi_get_sample(im,n_reals);
  or
     skip_seq_gibbs=0;
     [reals,etype_mean,etype_var,reals_all,reals_ite]=sippi_get_sample(im,n_reals,skip_seq_gibbs);
 
 
</fo:block></fo:block></fo:block><fo:block id="sippi_least_squares"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_least_squares</fo:marker><fo:block font-size="17.28pt">sippi_least_squares</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875149200" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_least_squares Least squares type inversion for SIPPI
 
  Call : 
     [m_reals,m_est,Cm_est]=sippi_least_squares(data,prior,forward,n_reals,lsq_type,id,im);
 
 
 
    lsq_type : 'lsq' (def), classical least squares 
               'error_sim', simulation through error simulation
               'visim', simulation through SGSIM of DSSIM
 
</fo:block></fo:block></fo:block><fo:block id="sippi_likelihood"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_likelihood</fo:marker><fo:block font-size="17.28pt">sippi_likelihood</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875146992" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_likelihood Compute likelihood given an observed dataset
 
  Call
    [logL,L,data]=sippi_likelihood(d,data);
 
 
   data{1}.d_obs [N_data,1] N_data data observations
   data{1}.d_std [N_data,1] N_data uncorrelated Gaussian STD
 
   data{1}.d_var [N_data,1] N_data uncorrelated Gaussian variances
 
 
  Gaussian modelization error, N(dt,Ct), is specified as
   data{1}.dt [N_data,1] : Bias/mean of modelization error
   data{1}.Ct [N_data,N_data] : Covariance of modelization error
 
   data{1}.Ct [1,1] : Constant Covariance of modelization error
                      imples data{1}.Ct=ones(N_data.N_data)*data{1}.Ct;
 
  data{id}.recomputeCD [default=0], if '1' then data{1}.iCD is recomputed
  each time sippi_likelihood is called. This should be used if the noise model
  changes between each call to sippi_likelihood.
 
   data{id}.full_likelihood [default=]0; if '1' the the full likelihood
   (including the determinant) is computed. This not needed if the data
   civariance is constant, but if it changes, then use
   data{id}.full_likelihood=1;
 
 
   A new type of noise model can be used as long as it is available in a 
   m file staring with 'sippi_likelihood_'. Further, it should provide the
   inputs and outputs as sippi_likelihood.m
   If a noise model has been implemented in the m-files
   sippi_likelihood_other.m
   then this can be used to evaluate the likelhood in sippi using 
   data{1}.noise_model='sippi_likelihood_other',
 
 
</fo:block></fo:block></fo:block><fo:block id="sippi_mcmc_init"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_mcmc_init</fo:marker><fo:block font-size="17.28pt">sippi_mcmc_init</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875144112" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_mcmc_init Initialize McMC options for Metropolis and rejection sampling in SIPPI
 
  Call:
     options=sippi_mcmc_init(options,prior);
 
</fo:block></fo:block></fo:block><fo:block id="sippi_metropolis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_metropolis</fo:marker><fo:block font-size="17.28pt">sippi_metropolis</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875142208" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_metropolis Extended Metropolis sampling in SIPPI
 
  Metropolis sampling.
    See e.g.
      Hansen, T. M., Cordua, K. S., and Mosegaard, K., 2012.
      Inverse problems with non-trivial priors - Efficient solution through Sequential Gibbs Sampling.
      Computational Geosciences. doi:10.1007/s10596-011-9271-1.
 
      Sambridge, M., 2013 - A Parallel Tempering algorithm for
      probabilistic sampling and multi-modal optimization.
 
  Call :
     [options,data,prior,forward,m_current]=sippi_metropolis(data,prior,forward,options)
  Input :
     data : sippi data structure
     prior : sippi prior structure
     forward : sippi forward structure
 
  options :
 
     options.mcmc.nite=30000;   % [1] : Number if iterations
     options.mcmc.i_sample=100; % : Number of iterations between saving model to disk
     options.mcmc.i_plot=50;  % [1]: Number of iterations between updating plots
     options.mcmc.i_save_workspace=10000;  % [1]: Number of iterations between
                                             saving the complete workspace
     options.mcmc.i_sample=100; % : Number of iterations between saving model to disk
 
     options.mcmc.m_init : Manually chosen starting model
     options.mcmc.m_ref  : Reference known target model
 
     options.mcmc.accept_only_improvements [0] : Optimization
     options.mcmc.accept_all [0]: accepts all proposed models (ignores lilkelihood)
 
     options.txt [string] : string to be used as part of all output file names
 
     %% PERTURBATION STRATEGY
     % Perturb all model parameter all the time
     options.mcmc.pert_strategy.perturb_all=1; % Perturb all priors in each
                                               % iteration. def =[0]
     options.mcmc.pert_strategy.perturb_all=2; % Perturb a random selection of 
                                               % all priors in each iteration. def =[0]
 
     % Perturb one a prior type at a time, according to some frequency
     options.mcmc.pert_strategy.i_pert = [1,3]; % only perturb prior 1 and 3
     options.mcmc.pert_strategy.i_pert_freq = [2 8]; % perturb prior 3 80% of
                                                % the time and prior 1 20%
                                                % of the time
     % the default pertubation strategt is to select one prior model to
     % perturb at tandom for each iteration
 
 
     %% TEMPERING
     options.mcmc.n_chains=1; % set number of chains (def=1)
     options.mcmc.T=1;      % set temperature of chains [1:n_chains]
     options.mcmc.chain_frequency_jump=0.1; % probability allowing a jump
                                            %  between two chains
     %% ANNEALING (TEMPERATURE AS A FUNCTION OF ITERATION NUMBER)
     options.mcmc.anneal.i_begin=1; % default, iteration number when annealing begins
     options.mcmc.anneal.i_end=100000; %  iteration number when annealing stops
     options.mcmc.anneal.T_begin=5; % Start temperature for annealing
     options.mcmc.anneal.T_end=1; % End temperature for annealing
 
     %% VERBOSITY
     The amount of text info displayed at the prompt, can be controlled by
     setenv('SIPPI_VERBOSE_LEVEL','2') % all: information on chain swapping
     setenv('SIPPI_VERBOSE_LEVEL','1') % information about seq-gibbs step update
     setenv('SIPPI_VERBOSE_LEVEL','0'); % [def] frequent update
     setenv('SIPPI_VERBOSE_LEVEL','-1'); % rare update om finish time
     setenv('SIPPI_VERBOSE_LEVEL','-2'); % indication of stop and start
     setenv('SIPPI_VERBOSE_LEVEL','-3'); % none
 
  See also sippi_rejection
 
 
</fo:block></fo:block></fo:block><fo:block id="sippi_prior"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior</fo:marker><fo:block font-size="17.28pt">sippi_prior</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875137360" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior: A priori models for SIPPI
 
  To generate a realization of the prior model defined by the prior structure use:
    [m_propose,prior]=sippi_prior(prior);
 
  To generate a realization of the prior model defined by the prior structure,
  in the vicinity of a current model (using sequential Gibbs sampling) use:
    [m_propose,prior]=sippi_prior(prior,m_current);
 
  The following types of a priori models can be used
    % two point statistics bases
    GAUSSIAN   [1D] : 1D generalized gaussian model
    UNIFORM [1D-3D] : 1D-3D uncorrelated uniform distribution
    CHOLESKY[1D-3D] : based on Cholesky decomposition
    FFTMA   [1D-3D] : based on the FFT-MA method (Multivariate Gaussian)
    VISIM   [1D-3D] : based on Sequential Gaussian and Direct Sequential simulation
    SISIM   [1D-3D] : based on Sequential indicator SIMULATION
    % multiple point based statistics
    SNESIM_STD  [1D-3D] : (SGEMS) based on a multiple point statistical model inferref from a training images. Relies in the SNESIM algorithm
    SNESIM  [1D-3D] : (GSLIB STYLE) based on a multiple point statistical model inferref from a training images. Relies in the SNESIM algorithm
 
 
 %%% SIMPLE EXAMPLE %%%
 
 % A simple 2D multivariate Gaissian based prior model based on the
 % FFT-MA method, can be defined using
    im=1;
    prior{im}.type='FFTMA';
    prior{im}.name='A SIMPLE PRIOR';
    prior{im}.x=[0:1:100];
    prior{im}.y=[0:1:100];
    prior{im}.m0=10;
    prior{im}.Va='1 Sph(10)';
    prior=sippi_prior_init(prior);
 % A realization from this prior model can be generated using
    m=sippi_prior(prior);
 % This realization can now be plotted using
    sippi_plot_prior(m,prior);
 % or
    imagesc(prior{1}.x,prior{1}.y,m{1})
 
 %%% A PRIOR MODEL WITH SEVERAL 'TYPES OF A PRIORI MODEL'
 
    im=1;
    prior{im}.type='GAUSSIAN';
    prior{im}.m0=100;
    prior{im}.std=50;
    prior{im}.norm=100;
    im=im+1;
    prior{im}.type='FFTMA';
    prior{im}.x=[0:1:100];
    prior{im}.y=[0:1:100];
    prior{im}.m0=10;
    prior{im}.Cm='1 Sph(10)';
    im=im+1;
    prior{im}.type='VISIM';
    prior{im}.x=[0:1:100];
    prior{im}.y=[0:1:100];
    prior{im}.m0=10;
    prior{im}.Cm='1 Sph(10)';
    im=im+1;
    prior{im}.type='SISIM';
    prior{im}.x=[0:1:100];
    prior{im}.y=[0:1:100];
    prior{im}.m0=10;
    prior{im}.Cm='1 Sph(10)';
    im=im+1;
    prior{im}.type='SNESIM';
    prior{im}.x=[0:1:100];
    prior{im}.y=[0:1:100];
 
    sippi_plot_prior(prior);
 
 %% Sequential Gibbs sampling
 
    All a priori model types can be perturbed, such that a new realization
    is generated in the vicinity of a current model.
    To do this Sequential Gibbs Sampling is used.
    For more information, see &lt;a href="matlab:web('http://dx.doi.org/10.1007/s10596-011-9271-1')"&gt;Hansen, T. M., Cordua, K. S., and Mosegaard, K., 2012. Inverse problems with non-trivial priors - Efficient solution through Sequential Gibbs Sampling. Computational Geosciences&lt;/a&gt;.
    The type of sequential Gibbs sampling can be controlled in the
    'seq_gibbs' structures, e.g. prior{1}.seq_gibbs
 
    im=1;
    prior{im}.type='SNESIM';
    prior{im}.x=[0:1:100];
    prior{im}.y=[0:1:100];
 
    [m,prior]=sippi_prior(prior);
    prior{1}.seq_gibbs.step=1; % Large step--&gt; independant realizations
    prior{1}.seq_gibbs.step=.1; % Smaller step--&gt; Dependant realizations
    for i=1:30;
       [m,prior]=sippi_prior(prior,m); % One iteration of Sequential Gibbs
       sippi_plot_prior(prior,m);
    end
 
  See also: sippi_prior_init, sippi_plot_prior, sippi_plot_prior_sample, sippi_prior_set_steplength.m
 
  TMH/2012
 
</fo:block></fo:block></fo:block><fo:block id="sippi_prior_cholesky"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior_cholesky</fo:marker><fo:block font-size="17.28pt">sippi_prior_cholesky</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875132048" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior_cholesky : Cholesky type Gaussian prior for SIPPI
 
 % Example:
    ip=1;
    prior{ip}.type='cholesky';
    prior{ip}.m0=10;
    prior{ip}.Cm='.001 Nug(0) + 1 Gau(10)';
    prior{ip}.x=0:1:100;linspace(0,100,20);
    prior{ip}.y=0:1:50;linspace(0,33,30);
    [m,prior]=sippi_prior_cholesky(prior);
    sippi_plot_prior(prior,m);
 
 % Sequential Gibbs sampling
    prior{1}.seq_gibbs.step=.1;
    for i=1:100;
        [m,prior]=sippi_prior_cholesky(prior,m);
        sippi_plot_prior(prior,m);
        caxis([8 12]);drawnow;
    end
 
 % Prior covariance model
  The prior covarince model can be setup using
    prior{ip}.m0=10;
    prior{ip}.Cm='.001 Nug(0) + 1 Gau(10)';
  or
    prior{ip}.m0=10;
   and the 'Cmat' variable 'prior{ip}.Cmat' which much the contain a full
   nd X nd size covariance matrix.
   (it is computed the first the sippi_prior_cholesky is called)
 
  See also: gaussian_simulation_cholesky
 
</fo:block></fo:block></fo:block><fo:block id="sippi_prior_dsim"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior_dsim</fo:marker><fo:block font-size="17.28pt">sippi_prior_dsim</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875129616" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior_dsim : Direct simulation in SIPPI
 
  Example: 
   
  prior{1}.type='dsim';
  prior{1}.x=1:1:40;;
  prior{1}.y=1:1:30;;
  prior{1}.ti=channels;;
 
  m=sippi_prior(prior);
  sippi_plot_prior(prior,m);
 
 
 
  % OPTIONAL OPTIONS
 
    prior{1}.options.n_cond [int]: number of conditional points (def=5)
    prior{1}.options.n_max_ite [int]: number of maximum iterations through the TI for matching patterns (def=200)
  
    prior{1}.options.plot    [int]: [0]:none, [1]:plot cond, [2]:storing movie (def=0)
    prior{1}.options.verbose [int]: [0] no infor to screen, [1]:some info (def=1)
  
  
 
  TMH/2014
 
  See also: sippi_prior_init, sippi_prior
 
</fo:block></fo:block></fo:block><fo:block id="sippi_prior_init"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior_init</fo:marker><fo:block font-size="17.28pt">sippi_prior_init</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875127248" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior_init Initialize PRIOR structure for SIPPI
 
  Call
    prior=sippi_prior_init(prior);
 
  See also sippi_prior
 
</fo:block></fo:block></fo:block><fo:block id="sippi_prior_mps"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior_mps</fo:marker><fo:block font-size="17.28pt">sippi_prior_mps</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875125616" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior_mps : prior based on MPS
 
                       Using SNESIM/ENESIM FROM 
                       https://github.com/ergosimulation/mpslib
  
 % Example:
     ip=1;
     prior{ip}.type='mps';
     prior{ip}.method='mps_snesim';
     prior{ip}.x=1:1:80;
     prior{ip}.y=1:1:80;
     prior{ip}.ti=channels;
     % prior{ip}.ti=maze;
 
     m=sippi_prior(prior);
     sippi_plot_prior(prior,m)
     figure(1);imagesc(prior{ip}.ti);axis image
 
 
 %  The specific algorithm use for MPS simulation is defined in ytje 'method' field
     prior{ip}.method='mps_snesim';         % default, same as 'mps_snesim_tree'
     prior{ip}.method='mps_snesim_tree';
     prior{ip}.method='mps_snesim_list';
     prior{ip}.method='mps_genesim';
 
     All properties for each algorithm are availale in the prior{ip}.MPS
     field
 
  See also: sippi_prior, ti, mps_cpp
</fo:block></fo:block></fo:block><fo:block id="sippi_prior_plurigaussian"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior_plurigaussian</fo:marker><fo:block font-size="17.28pt">sippi_prior_plurigaussian</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875122784" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior_plurigaussian: Plurigaussian type prior for SIPPI
 
 % Example:
    % PluriGaussian based on one Gaussian model / truncated Gaussian
    ip=1;
    prior{ip}.type='plurigaussian';
    prior{ip}.x=1:1:100;
    prior{ip}.y=1:1:100;
    prior{ip}.Cm='1 Gau(10)';
    prior{ip}.pg_map=[0 0 0 0 1 1 0 0 2 2 2];
 
    % PluriGaussian based on two Gaussian models 
    ip=ip+1;
    prior{ip}.type='plurigaussian';
    prior{ip}.x=1:1:100;
    prior{ip}.y=1:1:100;
    prior{ip}.pg_prior{1}.Cm=' 1 Gau(10)';
    prior{ip}.pg_prior{2}.Cm=' 1 Sph(10,90,.4)';
    prior{ip}.pg_map=[0 0 0 1 1; 1 2 0 1 1; 1 1 1 1 1];
 
    [m,prior]=sippi_prior(prior);
    sippi_plot_prior(prior,m);
 
    sippi_plot_prior_sample(prior,1,5);
    sippi_plot_prior_sample(prior,2,5);
 
 
 % Sequential Gibbs sampling
    prior{1}.seq_gibbs.step=.01;
    for i=1:100;
        [m,prior]=sippi_prior(prior,m);
        sippi_plot_prior(prior,m);
        caxis([0 2]);drawnow;
    end
 
  See also: sippi_prior, pg_transform
 
</fo:block></fo:block></fo:block><fo:block id="sippi_prior_set_steplength"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior_set_steplength</fo:marker><fo:block font-size="17.28pt">sippi_prior_set_steplength</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875120368" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior_set_steplength Set step length for Metropolis sampler in SIPPI
 
  Call
    prior=sippi_prior_set_steplength(prior,mcmc,im);
 
</fo:block></fo:block></fo:block><fo:block id="sippi_prior_sisim"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior_sisim</fo:marker><fo:block font-size="17.28pt">sippi_prior_sisim</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875118640" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior_sisim: SISIM (SGeMS) type prior for SIPPI
 
 % Example:
     ip=1;
     prior{ip}.type='sisim';
     prior{ip}.x=1:1:80;
     prior{ip}.y=1:1:80;
     prior{ip}.Cm='1 Sph(60)';
     prior{ip}.marginal_prob=[.1 .4 .5];
     m=sippi_prior(prior);
     sippi_plot_prior(prior,m)
 
     % optionally a specific random seed can be set using
     prior{ip}.seed=1;
 
 % Sequential Gibbs sampling type 1 (box selection of pixels)
     prior{ip}.seq_gibbs.type=1;%
     prior{ip}.seq_gibbs.step=10; % resim data in 10x10 pixel grids
     [m,prior]=sippi_prior(prior);
     for i=1:10;
        [m,prior]=sippi_prior(prior,m);
        sippi_plot_prior(prior,m);
        drawnow;
     end
 
 % Sequential Gibbs sampling type 2 (random pixels)
     prior{ip}.seq_gibbs.type=2;%
     prior{ip}.seq_gibbs.step=.6; % Resim 60% of data
     [m,prior]=sippi_prior(prior);
     for i=1:10;
        [m,prior]=sippi_prior(prior,m);
        sippi_plot_prior(prior,m);
        drawnow;
     end
 
  See also: sippi_prior, sgems
 
</fo:block></fo:block></fo:block><fo:block id="sippi_prior_snesim"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior_snesim</fo:marker><fo:block font-size="17.28pt">sippi_prior_snesim</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875115984" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior_snesim : SNESIM type Gaussian prior for SIPPI
 
                       Using SNESIM form
                       https://github.com/SCRFpublic/snesim-standalone
 
 % Example:
     ip=1;
     prior{ip}.type='snesim';
     prior{ip}.x=1:1:80;
     prior{ip}.y=1:1:80;
     prior{ip}.ti=channels;
     % prior{ip}.ti=maze;
 
     m=sippi_prior(prior);
     sippi_plot_prior(prior,m)
     figure(1);imagesc(prior{ip}.ti);axis image
 
 % Example: scaling and rotation
     ip=1;
     prior{ip}.type='snesim';
     prior{ip}.x=1:1:80;
     prior{ip}.y=1:1:80;
     prior{ip}.ti=channels;
     prior{ip}.scaling=[.1];
     prior{ip}.rotation=[10];
 
     m=sippi_prior(prior);
     sippi_plot_prior(prior,m)
     figure(1);imagesc(prior{ip}.ti);axis image
 
 % Hard data
    % hard data are given using either matrix of 4 columns (x,y,z,val)
    % or as a 4 column EAS file (x,y,z,val)
    d_hard=[1 1 0 0; 1 2 0 0; 2 2 0 1 ];
    prior{ip}.hard_data=d_hard;
 
    write_eas('snesim_hard.dat',d_hard);
    prior{ip}.hard_data='snesim_hard.dat';
 
 % Soft data
    % soft mush be provided as a matrix of the same size as the simulation
    % grid
    d_soft(:,:,1)=ones(80,80).*NaN
    d_soft(:,:,2)=1-d_soft(:,:,1);
    prior{ip}.soft_data_grid=d_soft;
 
 
    % Optionally the soft data can be provided as point data, in which case
    % a grid, the size of the simulation grid, with soft data values will be computed
    d_soft=[1 1 0 0.2 0.8; 1 2 0 0.1 0.9; 2 2 0  0.05 0.95];
    prior{ip}.soft_data=d_soft;
 
 % Sequential Gibbs sampling type 1 (box selection of pixels)
     prior{ip}.seq_gibbs.type=1;%
     prior{ip}.seq_gibbs.step=10; % resim data in 10x10 pixel grids
     [m,prior]=sippi_prior(prior);
     for i=1:10;
        [m,prior]=sippi_prior(prior,m);
        sippi_plot_prior(prior,m);
        drawnow;
     end
 
 % Sequential Gibbs sampling type 2 (random pixels)
     prior{ip}.seq_gibbs.type=2;%
     prior{ip}.seq_gibbs.step=.6; % Resim 60% of data
     [m,prior]=sippi_prior(prior);
     for i=1:10;
        [m,prior]=sippi_prior(prior,m);
        sippi_plot_prior(prior,m);
        drawnow;
     end
 
  See also: sippi_prior, ti
 
</fo:block></fo:block></fo:block><fo:block id="sippi_prior_snesim_std"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior_snesim_std</fo:marker><fo:block font-size="17.28pt">sippi_prior_snesim_std</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875112288" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior_snesim_std : SNESIM_STD (SGeMS) type Gaussian prior for SIPPI
                       
                       Requires SGeMS version 2.1b, available from 
                       http://sgems.sourceforge.net/?q=node/77
  
 % Example:
     ip=1;
     prior{ip}.type='snesim_std';
     prior{ip}.x=1:1:80;
     prior{ip}.y=1:1:80;
     prior{ip}.ti=channels;
     % prior{ip}.ti=maze;
 
     m=sippi_prior(prior);
     sippi_plot_prior(prior,m)
     figure(1);imagesc(prior{ip}.ti);axis image
 
 % Hard data
    % hard data are given using either matrix of 4 columns (x,y,z,val)
    % or as a 4 column EAS file (x,y,z,val)
    d_hard=[1 1 0 0; 1 2 0 0; 2 2 0 1 ];
    prior{ip}.hard_data=d_hard;
 
    write_eas('snesim_hard.dat',d_hard);
    sgems_write_pointset('snesim_hard.sgems',d_hard);
    prior{ip}.hard_data='snesim_hard.sgems';
 
 % Example: scaling and rotation
     ip=1;
     prior{ip}.type='snesim_std';
     prior{ip}.x=1:1:80;
     prior{ip}.y=1:1:80;
     prior{ip}.ti=channels;
     prior{ip}.scaling=[.1];
     prior{ip}.rotation=[10];
 
     m=sippi_prior(prior);
     sippi_plot_prior(prior,m)
     figure(1);imagesc(prior{ip}.ti);axis image
 
 % Sequential Gibbs sampling type 1 (box selection of pixels)
     prior{ip}.seq_gibbs.type=1;%    
     prior{ip}.seq_gibbs.step=10; % resim data in 10x10 pixel grids
     [m,prior]=sippi_prior(prior);
     for i=1:10;
        [m,prior]=sippi_prior(prior,m);
        sippi_plot_prior(prior,m);
        drawnow;
     end
 
 % Sequential Gibbs sampling type 2 (random pixels)
     prior{ip}.seq_gibbs.type=2;%    
     prior{ip}.seq_gibbs.step=.6; % Resim 60% of data
     [m,prior]=sippi_prior(prior);
     for i=1:10;
        [m,prior]=sippi_prior(prior,m);
        sippi_plot_prior(prior,m);
        drawnow;
     end
 
  See also: sippi_prior, sippi_prior_snbesim, ti
 
</fo:block></fo:block></fo:block><fo:block id="sippi_prior_uniform"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior_uniform</fo:marker><fo:block font-size="17.28pt">sippi_prior_uniform</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875108896" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior_uniform : Uniform prior for SIPPI
 
 
 % Example 1D uniform
    ip=1;
    prior{ip}.type='uniform';
    prior{ip}.min=10;
    prior{ip}.max=25;
    [m,prior]=sippi_prior_uniform(prior);
    sippi_plot_prior_sample(prior);
 
 % Example 10D uniform
    ip=1;
    prior{ip}.type='uniform';
    prior{ip}.x=1:1:10; % As dimensions are uncorrelated, only the lehgth
                        % of prior{ip}.x matters, not its actual values.
    prior{ip}.min=10;
    prior{ip}.max=25;
    [m,prior]=sippi_prior_uniform(prior);
    sippi_plot_prior_sample(prior);
 
 % Sequential Gibbs sampling
    prior{1}.seq_gibbs.step=.1;
    for i=1:1000;
        [m,prior]=sippi_prior(prior,m);
        mm(i)=m{1};
    end
    subplot(1,2,1);plot(mm);
    subplot(1,2,2);hist(mm);
 
  TMH/2014
 
  See also: sippi_prior_init, sippi_prior
 
</fo:block></fo:block></fo:block><fo:block id="sippi_prior_visim"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior_visim</fo:marker><fo:block font-size="17.28pt">sippi_prior_visim</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875106496" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior_visim : VISIM type Gaussian prior for SIPPI
 
 % Example:
     ip=1;
     prior{ip}.type='visim';
     prior{ip}.x=1:1:80;
     prior{ip}.y=1:1:80;
     prior{ip}.Cm='1 Sph(60)';
     m=sippi_prior(prior);
     sippi_plot_prior(prior,m)
 
     % optionally a specific random seed can be set using
     prior{ip}.seed=1;
 
 % Sequential Gibbs sampling type 1 (box selection of pixels)
     prior{ip}.seq_gibbs.type=1;
     prior{ip}.seq_gibbs.step=10; % resim data in 10x10 pixel grids
     prior{ip}.cax=[-2 2];
     [m,prior]=sippi_prior(prior);
     for i=1:1000;
        [m,prior]=sippi_prior(prior,m);
        sippi_plot_prior(prior,m);
        drawnow;
     end
 
 % Sequential Gibbs sampling type 2 (random pixels)
     prior{ip}.seq_gibbs.type=2;%
     prior{ip}.seq_gibbs.step=.6; % Resim 60% of data
     [m,prior]=sippi_prior(prior);
     for i=1:10;
        [m,prior]=sippi_prior(prior,m);
        sippi_plot_prior(prior,m);
        drawnow;
     end
 
 % TARGET DISTRIBUTION
  clear prior
  d_target=[7 8 9 10 11 11 12];
  d_target=[7 8 9 10 14 15 20];
 
  ip=1;
  prior{ip}.type='visim';
  prior{ip}.method='sgsim';
  % prior{ip}.method='dssim';
  prior{ip}.d_target=d_target;
  prior{ip}.cax=[min(d_target) max(d_target)];
  prior{ip}.x=1:1:80;
  prior{ip}.y=1:1:80;
  prior{ip}.Cm=sprintf('%g Gau(20)',var(d_target));
  prior{ip}.Cm=sprintf('%g Gau(20)',1);
  [m,prior]=sippi_prior(prior);
  sippi_plot_prior(prior,m);
 
  prior{ip}.seq_gibbs.step=16;
  prior{ip}.seq_gibbs.type=1;
  for i=1:10;
     [m,prior]=sippi_prior(prior,m);
     sippi_plot_prior(prior,m);
     drawnow
  end
 
 
  See also: sippi_prior, visim, nscore, inscore
 
</fo:block></fo:block></fo:block><fo:block id="sippi_prior_voronoi"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_prior_voronoi</fo:marker><fo:block font-size="17.28pt">sippi_prior_voronoi</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875103328" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_prior_voronoi: 
 
  TMH/2014
 
  Ex: 
    prior{1}.type='voronoi';
    prior{1}.x=1:1:20;
    prior{1}.y=1:1:20;
    prior{1}.cells_N_min=2;
    prior{1}.cells_N_max=100;
    prior{1}.cells_N=10;
    [m,prior]=sippi_prior(prior);
    sippi_plot_prior(prior,m);
 
  See also: sippi_prior_init, sippi_prior
 
</fo:block></fo:block></fo:block><fo:block id="sippi_rejection"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_rejection</fo:marker><fo:block font-size="17.28pt">sippi_rejection</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875101408" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_rejection Rejection sampling
 
  Call :
      options=sippi_rejection(data,prior,forward,options)
 
  input arguments
 
    options.mcmc.i_plot
    options.mcmc.nite     % maximum number of iterations
    options.mcmc.logLmax [def=1]; % Maximum possible log-likelihood value
 
    options.mcmc.rejection_normalize_log = log(options.mcmc.Lmax)
 
    options.mcmc.adaptive_rejection=1, adaptive setting of maximum likelihood
                   (def=[0])
                   At each iteration logLmax will be set if log(L(m_cur)=&gt;options.mcmc.logLmax
 
 
    options.mcmc.max_run_time_hours = 1; % maximum runtime in hours
                                         % (overrides options.mcmc.nite if needed)
 
    options.mcmc.T = 1; % Tempering temperature. T=1, implies no tempering
 
  See also sippi_metropolis
 
 
</fo:block></fo:block></fo:block><fo:block id="sippi_set_path"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_set_path</fo:marker><fo:block font-size="17.28pt">sippi_set_path</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875098864" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_set_path Set paths for running sippi
</fo:block></fo:block></fo:block></fo:block><fo:block id="idm45886875169072"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">SIPPI plotting commands</fo:marker><fo:block font-size="20.736pt">SIPPI plotting commands</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/><fo:block id="sippi_colormap"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_colormap</fo:marker><fo:block font-size="17.28pt">sippi_colormap</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875096688" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_colormap Default colormap for sippi
 
  Call :
    sippi_colormap; % the same as sippi_colormap(3);
 
  or :
    sippi_colormap(1) - Red Green Black
    sippi_colormap(2) - Red Green Blue Black
    sippi_colormap(3) - Jet
    sippi_colormap(4) - Parula
    sippi_colormap(5) - Geosoft
 
</fo:block></fo:block></fo:block><fo:block id="sippi_get_posterior_data"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_get_posterior_data</fo:marker><fo:block font-size="17.28pt">sippi_get_posterior_data</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875094832" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_get_posterior_data: load all data stored in mat-file
 
  Call: 
 
   [data,prior,options,mcmc]=sippi_get_posterior_data(folder_name);
   [data,prior,options,mcmc]=sippi_get_posterior_data(output_stuct);
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_current_model"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_current_model</fo:marker><fo:block font-size="17.28pt">sippi_plot_current_model</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875093120" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_current_model Plots the current model during Metropolis sampling
 
  Call :
    sippi_plot_current_model(mcmc,data,d,m_current,prior,options);
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_data"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_data</fo:marker><fo:block font-size="17.28pt">sippi_plot_data</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875091264" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_data: Plot data response
 
  Call:
     sippi_plot_data(d,data);
 
  sippi_plot_data provides a very simple way to plot data. 
  A more appropriate data plot can be implemented by implementing a new
  mfile called "sippi_plot_data" and add it the Matlab path before the 
  main SIPPI folders
 
  A maximum of options.plot.plot_data_max_data (def:=5) data is plotted.
  Change the value in sippi_plot_defaults.m
 
  A specific m-file for handling plotting for a specfic type of data can
  be implemented, and can be called instead of sippi_plot_data, if the name
  of the m-file is set in the options.sippi_plot_data_functions is set, as
  e.g:
     options.sippi_plot_data_function='sippi_plot_data_gpr';
  then 
     sippi_plot_data(d,data,[],options)
     sippi_plot_data(d,data,1:length(d),options); 
  will be equivalent to call
     sippi_plot_data_gpr(d,data); 
 
  
 
  
  See also sippi_plot_defaults, sippi_plot_data_gpr
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_defaults"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_defaults</fo:marker><fo:block font-size="17.28pt">sippi_plot_defaults</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875088880" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_defaults: Sets default options for ploting (such as fontsize)
 
  Call :
    options==sippi_plot_defaults(options);
 
    % ALWAYS USE DEFULT SETTING (overrules options.axis)
    overrule=1; % {default overrule=0)
    options==sippi_plot_defaults(options,overrule);
 
  See also: sippi_plot_posterior, sippi_plot_posterior_2d_marg
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_loglikelihood"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_loglikelihood</fo:marker><fo:block font-size="17.28pt">sippi_plot_loglikelihood</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875087024" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_loglikelihood Plot loglikelihood time series
 
  Call : 
     acc=sippi_plot_loglikelihood(logL,i_acc,N,itext)
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_model"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_model</fo:marker><fo:block font-size="17.28pt">sippi_plot_model</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875085184" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace"/></fo:block></fo:block><fo:block id="sippi_plot_movie"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_movie</fo:marker><fo:block font-size="17.28pt">sippi_plot_movie</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875083760" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_movie plot movie of prior and posterior realizations
 
  Call :
    sippi_plot_movie(fname);
    sippi_plot_movie(fname,im_array,n_frames,skip_burnin,i_chain);
       fname : name of folder with results (e.g. options.txt)
       im_array : array of indexes of model parameters to make into movies
       n_frames [200] : number of frames in movie
       skip_burnin [200] : start movie after burn_in;
       i_chain[1]: make movie of chain number 'i_chain' (new 22/05/2014)
 
  Ex:
  sippi_plot_movie('20130812_Metropolis');
  sippi_plot_movie(options.txt);
 
  %% 1000 realization including burn-in, for prior number 1
  sippi_plot_movie('20130812_Metropolis',1,1000,0);
 
  Using options.plot.skip_seq_gibbs=1, (set in sippi_plot_defaults)
  removes realizations obtained using sequential Gibbs sampling 
  (equivalent to setting skip_burnin=1)
 
  See also: sippi_plot_defaults
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_posterior"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_posterior</fo:marker><fo:block font-size="17.28pt">sippi_plot_posterior</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875081136" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_posterior Plot statistics from posterior sample
 
  Call :
     sippi_plot_posterior(fname,im_arr,prior,options,n_reals);
 
  See also sippi_plot_prior
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_posterior_2d_marg"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_posterior_2d_marg</fo:marker><fo:block font-size="17.28pt">sippi_plot_posterior_2d_marg</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875079568" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_posterior_2d_marg: plots 2D posterior marginal distributions
 
  Call:
     [options,reals_all]=sippi_plot_posterior_2d_marg(options,prior,data,fname);
 
  See also: sippi_plot_posterior
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_posterior_data"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_posterior_data</fo:marker><fo:block font-size="17.28pt">sippi_plot_posterior_data</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875077840" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_posterior_data: plots posterior data and noise relaizations
 
  Call 
     [options]=sippi_plot_posterior_data(options,prior,data,forward);
        
  See also: sippi_plot_posterior
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_posterior_loglikelihood"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_posterior_loglikelihood</fo:marker><fo:block font-size="17.28pt">sippi_plot_posterior_loglikelihood</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875076048" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_posterior_loglikelihod : plots log(L) and autorreation of log(L)
 
  Call:
      sippi_plot_posterior_loglikelihood; % when located in an output folder
                                          % generated by SIPPI
 
      sippi_plot_posterior_loglikelihood(foldername); % Where 'foldername'
                                          % is a folder generated by SIPPI
 
 
      sippi_plot_posterior_loglikelihood(options); % where options is the
                         % output of sippi_rejection or sippi_metropolis
 
 
      options=sippi_plot_posterior_loglikelihood(options,prior,data,mcmc,fname);
 
 
  See also: sippi_plot_posterior
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_posterior_sample"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_posterior_sample</fo:marker><fo:block font-size="17.28pt">sippi_plot_posterior_sample</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875073792" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_posterior_sample: plots posterior sample statistics
 
  Call
     [options]=sippi_plot_posterior_sample(options,prior,data,forward);
 
  See also: sippi_plot_posterior
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_prior"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_prior</fo:marker><fo:block font-size="17.28pt">sippi_plot_prior</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875071920" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_prior Plot a 'model', i.e. a realization of the prior model
 
 
  Call :
    sippi_plot_prior(prior,m,im_array);
 
    prior : Matlab structure for SIPPI prior model
    m : Matlab structure for SIPPI realization
    im_array : integer array of type of models to plot (typically 1)
 
 
  Example
    m=sippi_prior(prior);
    sippi_plot_prior(prior,m);
 
    m=sippi_prior(prior);
    sippi_plot_prior(prior,m,2);
 
  See also sippi_plot_prior, sippi_prior
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_prior_movie"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_prior_movie</fo:marker><fo:block font-size="17.28pt">sippi_plot_prior_movie</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875070016" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_prior_movie: creates a movie file a random walk in the prior
  
  Call:
     sippi_plot_prior_movie(prior,n_frames,options,im_array);
 
  See also: sippi_plot_movie
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_prior_sample"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_prior_sample</fo:marker><fo:block font-size="17.28pt">sippi_plot_prior_sample</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875068144" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_prior_sample Plot a sample of the prior in SIPPI
 
  Call :
     sippi_plot_prior_sample(prior,im_array,n_reals,cax,options);
 
   See also sippi_plot_posterior, sippi_plot_prior, sippi_prior
 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_set_axis"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_set_axis</fo:marker><fo:block font-size="17.28pt">sippi_plot_set_axis</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875066496" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_set_axis
  see also sippi_plot_defaults
</fo:block></fo:block></fo:block><fo:block id="wiggle"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">wiggle</fo:marker><fo:block font-size="17.28pt">wiggle</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875064752" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  wiggle : plot wiggle/VA/image plot
 
  Call
     wiggle(Data); % wiggle plot
     wiggle(Data,scale); % scaled wiggle plot
     wiggle(x,t,Data); % wiggle plt
     wiggle(x,t,Data,'VA') % variable Area (pos-&gt;black;neg-&gt;transp)
     wiggle(x,t,Data,'VA2') % variable Area (pos-&gt;black;neg-&gt;red)
     wiggle(x,t,Data,'wiggle',scale); % Scaled wiggle
     wiggle(x,t,Data,'wiggle',scale,showmax); % Scaled wiggle and max
                                                showmax traces.
     wiggle(x,t,Data,'wiggle',scale,showmax,plimage); % wiggle + image
     wiggle(x,t,Data,'wiggle',scale,showmax,plimage,caxis); % wiggle +
                                                              scaled image
 
  Data : [nt,ntraces]
  x : [1:ntraces] X axis (ex [SegyTraceheaders.offset])
  t : [1:nt] Y axis
  style : ['VA'] : Variable Area
          ['wiggle'] : Wiggle plot
  scale : scaling factor, can be left empty as []
  showmax [scalar] : max number of traces to show on display [def=100]
  plimage [0/1] : Show image beneath wiggles [def=0];
  caxis [min max]/[scalar] : amplitude range for colorscale
 
</fo:block></fo:block></fo:block></fo:block><fo:block id="idm45886875168816"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">SIPPI toolbox: Traveltime tomography</fo:marker><fo:block font-size="20.736pt">SIPPI toolbox: Traveltime tomography</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/><fo:block id="calc_Cd"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">calc_Cd</fo:marker><fo:block font-size="17.28pt">calc_Cd</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875060944" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  Calc_cd Setup a covariance model to account for borehole imperfections
 
  Call: Cd=calc_Cd(ant_pos,var_uncor,var_cor1,var_cor2,L)
  This function sets up a data covariance matrix that accounts for static
  (i.e. correlated) data errors.
  
  Inputs:
  * ant_pos: A N x 4 array that contains N combinations of transmitter/source 
  and receiver positions. The first two columns are the x- and y-coordinates
  of the transmitter/source position. The last two columns are the x- and 
  y-coordiantes of the receiver position.
  * var_uncor: The variance of the uncorrelated data errors.
  * var_cor1: The variance of the correlated data errors
  related to the transmitter/source positions.
  * var_cor2: The variance of the correlated data errors
  related to the receiver positions.
  * L: The correlation length for the correlation between the individual
  transmitter/source or receiver positions using an exponential covariance 
  function. For typical static errors the correlation length is set to a 
  small number (e.g. 10^-6).
  
  For more details and practical examples see:
  Cordua et al., 2008 in Vadose zone journal.
  Cordua et al., 2009 in Journal of applied geophysics.
 
  Knud S. Cordua (2012)
</fo:block></fo:block></fo:block><fo:block id="eikonal"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">eikonal</fo:marker><fo:block font-size="17.28pt">eikonal</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875059072" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  eikonal Traveltime computation by solving the eikonal equation
  
  tmap=eikonal(x,y,z,V,Sources,type);
 
   x,y,z : arrays defining the x, y, and z axis
   V: velocity field, with size (length(y),length(x),length(z));
   Sources [ndata,ndim] : Source positions
   type (optional): type of eikonal solver: [1]:Fast Marching(default), [2]:FD
 
   tmap [size(V)]: travel times computed everywhere in the velocity grid
 
 %Example (2D):
    x=[1:1:100];
    y=1:1:100;
    z=1;
    V=ones(100,100);V(:,1:50)=2;
    Sources = [10 50;75 50];
    t=eikonal(x,y,z,V,Sources);
    subplot(1,2,1);imagesc(x,y,t(:,:,1,1));axis image;colorbar
    subplot(1,2,2);imagesc(x,y,t(:,:,1,2));axis image;colorbar
 
  See also eikonal_traveltime
 
</fo:block></fo:block></fo:block><fo:block id="eikonal_raylength"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">eikonal_raylength</fo:marker><fo:block font-size="17.28pt">eikonal_raylength</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875056096" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  eikonal_raylength : Computes the raylength from S to R using the eikonal equaiton
 
  Call:
    raylength=eikonal_raylength(x,y,v,S,R,tS,doPlot)
 
</fo:block></fo:block></fo:block><fo:block id="eikonal_traveltime"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">eikonal_traveltime</fo:marker><fo:block font-size="17.28pt">eikonal_traveltime</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875055040" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  eikonal_traveltime Computes traveltime between sources and receivers by solving the eikonal equation
 
  t=eikonal_traveltime(x,y,z,V,Sources,Receivers,iuse,type);
 
   x,y,z : arrays defining the x, y, and z axis
   V: velocity field, with size (length(y),length(x),length(z));
   Sources [ndata,ndim] : Source positions
   Receivers [ndata,ndim] : Receiver positions
   iuse (optional): optionally only use subset of data. eg.g i_use=[1 2 4];
   type (optional): type of eikonal solver: [1]:Fast Marching(default), [2]:FD
 
   tmap [size(V)]: travel times computed everywhere in the velocity grid
 
 %Example (2%
 
  Example 2d traveltime compuation
 
  Example (2D):
    x=[1:1:100];
    y=1:1:100;
    z=1;
    V=ones(100,100);V(:,1:50)=2;
    S=[50 50 1;50 50 1];
    R=[90 90 1; 90 80 1];
    t=eikonal_traveltime(x,y,z,V,S,R)
 
  Example (3D):
    nx=50;ny=50;nz=50;
    x=1:1:nx;
    y=1:1:ny;
    z=1:1:nz;
    V=ones(ny,nx,nz);V(:,1:50,:)=2;
    S=[10 10 1;10 10 1;10 9 1];
    R=[40 40 40; 40 39 40; 40 40 40];
    t=eikonal_traveltime(x,y,z,V,S,R)
 
 
  See also eikonal
</fo:block></fo:block></fo:block><fo:block id="kernel_buursink_2d"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">kernel_buursink_2d</fo:marker><fo:block font-size="17.28pt">kernel_buursink_2d</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875051456" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  kernel_buursink_2k Computes 2D Sensitivity kernel based on 1st order EM scattering theory
  
  See 
    Buursink et al. 2008. Crosshole radar velocity tomography 
                          with finite-frequency Fresnel. Geophys J. Int.
                          (172) 117;
 
   CALL : 
      % specify a source trace (dt, wf_trace):
      [kernel,L,L1_all,L2_all]=kernel_buursink_2d(model,x,z,S,R,dt,wf_trace);
      % Use a ricker wavelet with center frequency 'f0'
      [kernel,L,L1_all,L2_all]=kernel_buursink_2d(model,x,z,S,R,f0));
 
 
  Knud Cordua, 2009, 
  Thomas Mejer Hansen (small edits, 2009)
 
</fo:block></fo:block></fo:block><fo:block id="kernel_finite_2d"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">kernel_finite_2d</fo:marker><fo:block font-size="17.28pt">kernel_finite_2d</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875049440" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  kernel_finite_2d 2D sensitivity kernels
 
   Call:
     [Knorm,K,dt,options]=kernel_finite_2d(v_ref,x,y,S,R,freq,options);
</fo:block></fo:block></fo:block><fo:block id="kernel_fresnel_2d"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">kernel_fresnel_2d</fo:marker><fo:block font-size="17.28pt">kernel_fresnel_2d</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875047744" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  kernel_fresnel_2d Sensitivity kernel for amplitude and first arrival
 
  Call:
    [kernel_t,kernel_a,P_omega,omega]=kernel_fresnel_2d(v,x,y,S,R,omega,P_omega);
 
 
  Based on Liu, Dong, Wang, Zhu and Ma, 2009, Sensitivity kernels for
  seismic Fresenl volume Tomography, Geophysics, 75(5), U35-U46
 
  See also kernel_fresnel_monochrome_2d
 
  Run with no argument for an example.
 
 
</fo:block></fo:block></fo:block><fo:block id="kernel_fresnel_monochrome_2d"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">kernel_fresnel_monochrome_2d</fo:marker><fo:block font-size="17.28pt">kernel_fresnel_monochrome_2d</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875045696" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  kernel_fresnel_monochrome_2d 2D monchrome kernel for amplitude and first arrival
 
  Call:
    [kernel_t,kernel_a]=kernel_fresnel_monochrome_2d(v,x,y,S,R,omega);
  or
    [kernel_t,kernel_a]=kernel_fresnel_monochrome_2d(v,x,y,S,R,omega,L,L1,L2);
 
  Based on Liu, Dong, Wang, Zhu and Ma, 2009, Sensitivity kernels for
  seismic Fresenl volume Tomography, Geophysics, 75(5), U35-U46
 
  See also, kernel_fresnel_2d
 
</fo:block></fo:block></fo:block><fo:block id="kernel_multiple"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">kernel_multiple</fo:marker><fo:block font-size="17.28pt">kernel_multiple</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875043872" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  kernel_multiple Computes the sensitivity kernel for a wave traveling
  from S to R.
 
  CALL : 
     [K,RAY,Gk,Gray,timeS,timeR,raypath]=kernel_multiple(Vel,x,y,z,S,R,T,alpha,Knorm);
 
  IN : 
     Vel [ny,nx] : Velocity field
     x [1:nx] :
     y [1:ny] :
     z [1:nz] :
     S [1,3] : Location of Source
     R [1,3] : Location of Receiver
     T : Donminant period
     alpha: controls exponential decay away ray path
     Knorm [1] : normaliztion of K [0]:none, K:[1]:vertical
 
  OUT :
     K : Sensitivity kernel
     R : Ray sensitivity kernel (High Frequency approx)
     timeS : travel computed form Source
     timeR : travel computed form Receiver
     raypath [nraydata,ndim] : the center of the raypath 
 
  The sensitivity is the length travelled in each cell.
  
 
  See also : fast_fd_2d
 
  TMH/2006
 
</fo:block></fo:block></fo:block><fo:block id="kernel_slowness_to_velocity"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">kernel_slowness_to_velocity</fo:marker><fo:block font-size="17.28pt">kernel_slowness_to_velocity</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875041472" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  kernel_slowness_to_velocity Converts from slowness to velocity parameterizations
 
  G : kernel [1,nkernels]
  V : Velocity field (
 
 
  CALL:
    G_vel=kernel_slowness_to_velocity(G,V);
  or 
    [G_vel,v_obs]=kernel_slowness_to_velocity(G,V,t);
  or
    [G_vel,v_obs,Cd_v]=kernel_slowness_to_velocity(G,V,t,Cd);
 
  
</fo:block></fo:block></fo:block><fo:block id="mspectrum"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">mspectrum</fo:marker><fo:block font-size="17.28pt">mspectrum</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875039456" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  mspectrum : Amplitude and Power spectrum
  Call  :
      function [A,P,smoothP,kx]=mspectrum(x,dx)
  
  1D (A)mplitude and (P)owerspectrum of x-series with spacing dx
 
</fo:block></fo:block></fo:block><fo:block id="munk_fresnel_2d"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">munk_fresnel_2d</fo:marker><fo:block font-size="17.28pt">munk_fresnel_2d</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875038368" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  2D frechet kernel, First Fresnel Zone 
 
  See Jensen, Jacobsen, Christensen-Dalsgaard (2000) Solar Physics 192.
 
  Call :
  S=munk_fresnel_2d(T,dt,alpha,As,Ar,K);
 
  T : dominant period
  dt : 
  alpha : degree of cancellation 
  As : Amplitude fo the wavefield propagating from the source
  Ar : Amplitude fo the wavefield propagating from the receiver
  K : normalization factor
</fo:block></fo:block></fo:block><fo:block id="munk_fresnel_3d"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">munk_fresnel_3d</fo:marker><fo:block font-size="17.28pt">munk_fresnel_3d</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875035920" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  3D frechet kernel, First Fresnel Zone 
 
  See Jensen, Jacobsen, Christensen-Dalsgaard (2000) Solar Physics 192.
 
  Call :
</fo:block></fo:block></fo:block><fo:block id="pick_first_arrival"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">pick_first_arrival</fo:marker><fo:block font-size="17.28pt">pick_first_arrival</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875033808" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  pick_first_arrival : pick first arrival travel time data using simple
                       correlation
 
  Call 
    [tt_pick]=pick_first_arrival(wf_data,ref_trace,ref_t0,doPlot,wf_time);
 
</fo:block></fo:block></fo:block><fo:block id="plot_traveltime_sr"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">plot_traveltime_sr</fo:marker><fo:block font-size="17.28pt">plot_traveltime_sr</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875032208" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  plot_traveltime_sr
 
  Call 
     plot_traveltime(S,R)
     S: [n,2] : source locattion
     R: [n,2] : reveiver locattion
     or (3d)
     S: [n,3] : source locattion
     R: [n,3] : reveiver locattion
 
 
  EX:
   % 2D
   D=load('AM13_data.mat');
   plot_traveltime_sr(D.S,D.R);
   or
   ant_pos=[D.S,D.R];
   plot_traveltime_sr(ant_pos);
 
   % 3D
   D=load('AM1234_data.mat');
   plot_traveltime_sr(D.S,D.R);
 
 
</fo:block></fo:block></fo:block><fo:block id="sippi_forward_traveltime"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_forward_traveltime</fo:marker><fo:block font-size="17.28pt">sippi_forward_traveltime</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875030224" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_forward_traveltime Traveltime computation in SIPPI
 
  Call :
    [d,forward,prior,data]=sippi_forward_traveltime(m,forward,prior,data)
 
    forward.type determines the method used to compute travel times
    forward.type='ray';
    forward.type='fat';
    forward.type='eikonal';
    forward.type='born';
    forward.type='fd';
 
    forward.sources [ndata,ndim]: Source locations
    forward.receivers [ndata,ndim]: Receiver locations
 
    % the following options does not apply to 'eikonal' type modeling
    forward.linear : [0] a linear kernel is computed, based on the current velocity model
                     [1] a linear kenrel is computed only once, based on
                     the velocity field defined in forward.linear_m;
 
    forward.linear_m: the reference velocity field, for a linear forward
                      operator (forward.G) will be computed.
                      Can be eithe a scalar (constant velocity field) or
                      the same size as the the velcity model 'm'.
 
    forward.normalize_vertical [1]: Normalize sensitivitykernel by
                                    in vertical slices
                               [0]: No normalization
 
    forward.alpha [1]: alpha value for munk_fresnel_2d, munk_fresnel_3f
</fo:block></fo:block></fo:block><fo:block id="sippi_forward_traveltime_example"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_forward_traveltime_example</fo:marker><fo:block font-size="17.28pt">sippi_forward_traveltime_example</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875028160" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_forward_traveltime_example: Different examples of travel time
       computation
 
  See also: sippi_forward_traveltime
 
 % load some data
</fo:block></fo:block></fo:block><fo:block id="tomography_kernel"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">tomography_kernel</fo:marker><fo:block font-size="17.28pt">tomography_kernel</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875025520" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  tomography_kernel Computes the sensitivity kernel for a wave traveling from S to R.
 
  CALL :
     [K,RAY,Gk,Gray,timeS,timeR,raypath]=tomography_kernel(Vel,x,y,z,S,R,T,alpha,Knorm);
 
  IN :
     Vel [ny,nx] : Velocity field
     x [1:nx] :
     y [1:ny] :
     z [1:nz] :
     S [1,3] : Location of Source
     R [1,3] : Location of Receiver
     T : Donminant period
     alpha: controls exponential decay away ray path
     Knorm [1] : normaliztion of K [0]:none, K:[1]:vertical
 
  OUT :
     K : Sensitivity kernel
     R : Ray sensitivity kernel (High Frequency approx)
     timeS : travel computed form Source
     timeR : travel computed form Receiver
     raypath [nraydata,ndim] : the center of the raypath
 
  The sensitivity is the length travelled in each cell.
 
 
 
</fo:block></fo:block></fo:block></fo:block><fo:block id="idm45886875063120"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">SIPPI toolbox: 2D Full Waveform GPR modeling</fo:marker><fo:block font-size="20.736pt">SIPPI toolbox: 2D Full Waveform GPR modeling</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/><fo:block id="FDTD_fwi"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">FDTD_fwi</fo:marker><fo:block font-size="17.28pt">FDTD_fwi</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875022032" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace"> ================ FDTD simulation of electromagnetic waves ================
 
  Call: [dt nt]=FDTD_fwi(Eps,Sig,dx_fwd,t,ant_pos,addpar);
 
  General: The first five input parameters have to be defined and several additional 
  model parameters may be defined if need. The last additional 'addpar' input parameter 
  contains several parameters which may be defined if needed. If the additional 
  parameters are not defined default values are used.
 
  --- General input parameters (needed)---
  * Eps: 2D array containing the eps-model
  * Sig: 2D array containing the sig-model
  * dx_fwd: Cell size (m) for forward simulations
  * t: Total observation time (ns)
  * ant_pos: Nx4-array containing the (x,z)-tranitter and (x,z)-receiver positions.
    N is the number of transmitter and receiver combination (Ntrn x Nrec)
   
  --- General output parameters ----
  * nt: Number of samples in the output traces
  * dt: Sample interval of the output traces
 
  ------------------------------------------------------------------------
  The following parameters are only included if necessary, otherwise the
  default value is used. These additional parameters have to be defined
  as members in a structure: (addpar.(the exact parameter name as defined below))
  Ex: addpar.cores=2 will make the code run in multithreating mode on two cores. 
 
  --- Executables ---
  * forwardexeN: Contains strings with the names of the executables used 
    for the forward simulation. N is an integer. N equals the number of 
    cores applied during the forward simulation. If one core is applied 
    only the file forwardexe1 is need. If multiple cores are used for 
    the simulation more forwardexe files have to be defined.  
 
  --- Executable --- [NEW]
  addpar.executable complete path to executable
       default directory is the directory in which FDTD_fwi resides
       default executable name is 'FDTD_forward' appended with the
       architecture as output from "computer('arch')". such as for example
       "FDTD_forward_glnxa64" on 64 bit linux and 
       "FDTD_forward_maci64" on 64 bit OSX
       in windows the executable is simply
       "FDTD_forward.exe"
 
  --- Output working directory ---
   addpar.work_dir
 
  --- Boundaries ---
  * bx: The number of boundary cells (default=40)
  * sm: GPML-Tuning; Constant characterising the coordinate stretching in
    the boundaries (-1:auto) (default=auto)
  * sigm: GPML-Tuning; Constant describing the maximum of the conductivity
    profile in the boundaries (-1:auto) (default=auto)
  * n: GPML-Tuning; Exponent, describing how fast the stretching and
    conductivity happens in the boundaries (default=2)
 
  --- Stabilisation ---
  * sc: Courant stability scaling (default=0.9)
  * Epsmin: Smallest eps value used to calculate the time increment used in the 
    simulation (in units of relative dielectric permittivity)
    (-1:auto) (default=1)
 
  --- Source wavelet ---
  * srcWType: Source-wavelet-type (1:Gauss, 2:Diff. Gauss, 3:Ricker,
    4:External) (default=Gauss)
  * srcImpl: Source implementation; (0:hard-source) or (1:soft-source, that
    accounts for the field at source-position) (default=soft-source)
  * srcOri: Source orientation (0:Ez) or (1:Er/Ex) (default=Ez)
  * Tg: Total Pulse Length (in s) if source-type=1 or 2 (default=1.4*10^-8 s);
    Center frequency (in Hz) if source-type=3 (default=14*10^6 Hz)
  * Tp: Pulse Width (in s) only if source-type=1 or 2; Width of the pulse at
    amplitude=exp(-0.5)*ampl_max (default=1.6*10^-9 s)
 
  --- Magnetic properties ---
  * Mu: Magnetic Permeability, which is assumed constant across the model
    (in units of magnetic permeability of free space) (default=1)
  * rho: Equivalent magnetic loss or "magnetic resistivity" (default=0)
 
  --- Coordinate system ---
  * coord: Coordinate system in which the simulation is performed 
    (0:Cartesian, 1:Cylindrical) (default=Cartesian)
  * dx_inv: The cell size for the inversion parameters. Is used to determine
    where to position the receivers for the forward-backward simulation.
 
  --- Multithreading ----
  * cores: Number of cores applied for the forward simulation (default=1).
    The number of cores will automatically be reduced if the number of chosen 
    cores exceeds the number of transmitters. 
 
  -- Output --
  * snap: Snapshot "frequency"; Number of time-steps between snapshots 
    saved to disk (default=10000 (~no snapshot output)) 
  * frac: Factor by which snapshots are resampled (to save disk space) (default=1)
  * sim_mode: Types of output used for pure forward (=1), forward
    simulation followed by a backword simulation used for inversion purpose
    (=2) and pure forward simulation for inversion purpose (=3) (e.g. forward
    simualtion in a perturbed model) (default=1).
  * output: Determines which field direction to be outputted; (1)Ez, 
    (2)Ex/Er, (3)Both Ez and Ex/Er, (4) The same as (1) but the numbering is 
    given by the vector "no". This option is only active when sim_mode=1 is 
    applied (default=1). 
  * no: is a vector containing numbers used for the numbering of the output
    files. length(no) has to equal the number of transmitters.
  * debug: 1 = write parameter information to screen. 0 = nothing is
    written to the screen.
 
  --- Various ---
  * start: Flag controlling if the simulation is executed or only the
    parameter files are written (1:"on", 0:"off") (default="off") 
  * plot: Flag controlling if a plot of the setup it imaged (1:"plot", 0:"no plot") 
    (default="no plot")
 
 
  The full-waveform FDTD forward modelling program executed by this function is 
  written by Jacques Ernst (ETH Zurich, 2006) as part of his Ph.D. project.
 
  Knud Cordua (2008-2015)                                            v. 1.2
  Thomas Mejer Hansen (2015)
 ==========================================================================
</fo:block></fo:block></fo:block><fo:block id="LoadTraceM"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">LoadTraceM</fo:marker><fo:block font-size="17.28pt">LoadTraceM</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875014624" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace"> ==========================================================================
 The function [TRC,CFG] = LOADTRACEM(FIELD,TRC_REDUCTION,SRC_NR,
                                     TOOLTYPE) 
 loads traces from trace-files, created with the FDTD algorithm fwi.
 
 FIELD         = field that should be loaded ('-1'=all -&gt; returns a
                 structure or single field components '1'=Er, '2'=Ez or
                 '3'=Hphi(NEEDED)
 TRC_REDUCTION = trace-length 'nt' (#samples) to load. If set to '-1',
                 everything is loaded.
                 CAUTION: if TOOLTYPE==4x, this denotes the iteration 
                 number (NEEDED)
 SRC_NR        = shot-number to load (NEEDED)
 TOOLTYPE      = if 1=cartesian modeling tool; 2=cylindrical modeling tool,
                 3=reflex-data and 4x=cart+wave forminversion, where x
                 stands for 0 (simulated-), 1 (perturbed-), 2 (residual-) and 
                 3 (observed-) traces. (NEEDED)
 ECHOTYPE      = either 1 (every comment is ploted or 0 to disable the
                 comments). (NOT NEEDED)
 
 The return parameters are: Trc containing the trace(s); and cfg containing
 the configuration parameters
 
 REMARK: Concerning the Waveform-Inversion - the residual traces after an
 Epsilon-Inversion are ALLWAYS scaled in order to get rid of the Sigma-
 effects! So if REAL residual traces are needed, compute them by simply
 subtracting the observed from the simulated traces!
 
 (c) Jacques Ernst                                               ETH Zurich
 ==========================================================================
</fo:block></fo:block></fo:block><fo:block id="ant_geometry"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">ant_geometry</fo:marker><fo:block font-size="17.28pt">ant_geometry</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875011344" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  Call: [antpos angle dist]=fwi_ant_geometry(x0,z0,x,z,dtrn,drec,maxang);
  Calculates at antennae geoemtry setup for a typical cross-borehole survey.  
  Additionally, the the angles of the rays connecting the antennae
  positions are given.
 
  * x0 is the origo x-value
  * z0 is the origo z-value
  * x is the width of the profile measured from x0
  * z is the depth of the profile measured from z0
  * dtrn is the increment between the transmitter positions
  * drec is the increment between the receiver positions 
  * maxang is the largest accepted ray angle from horisontal
  
  * angle is the angles of the positions listed in antpos (in degrees)
  * dist is the distance between the transmitter and receiver position
 
  All units are in meter
 
  Knud S. Cordua (2008)
</fo:block></fo:block></fo:block><fo:block id="disc_freq"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">disc_freq</fo:marker><fo:block font-size="17.28pt">disc_freq</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875009520" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  Discrete frequencies:
  Call: f=disc_freq(N,dt);
  N is the number of elements contained in the signal
  dt is the temporal or spatial sampling interval
 
  Knud S. Cordua, 2010
 
  Verification by symetri:
  
  dt=0.01;
  N=2^nextpow2(1000)+1;
  Tp=1;
  w=gausswavelet(Tp,N,dt);
  wf=fft(w);
  wf=fftshift(wf);
  pwr=real(wf).^2+imag(wf).^2;
  f=disc_freq(N,dt);
  figure, plot(f,pwr)
</fo:block></fo:block></fo:block><fo:block id="distribute_to_cores"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">distribute_to_cores</fo:marker><fo:block font-size="17.28pt">distribute_to_cores</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875007040" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace"/></fo:block></fo:block><fo:block id="freq_int_diff_1D"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">freq_int_diff_1D</fo:marker><fo:block font-size="17.28pt">freq_int_diff_1D</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875005168" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  Call: [odata opwr]=freq_int_diff_1D(idata,order,dt); 
  * "odata" is the output data
  * "opwr" is the log power spectrum of the output data
  * "idata" is the input data given as a matrix
  * "order" A positive value N results in a differentialtion of order N. A
     negative value N results in an integration of order N. (e.g. for N=1/2 the array is half differentiated. N = -2 results in a double integration)
  * "dt" is the sample interval
  
  The code will extend the input signal with zeroes to the next power of two
  
  For finite-difference calculations; if a e.g. Ricker pulse has to propagte in
  the grid then a half-integrated (order = -0.5) Ricker pulse has to be
  used as source pulse.
 
  Knud Cordua 2010
</fo:block></fo:block></fo:block><fo:block id="fwi_ant_geometry"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">fwi_ant_geometry</fo:marker><fo:block font-size="17.28pt">fwi_ant_geometry</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875003024" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  Call: [antpos angle dist]=fwi_ant_geometry(x0,z0,x,z,dtrn,drec,maxang);
  Calculates at antennae geoemtry setup for a typical cross-borehole survey.  
  Additionally, the the angles of the rays connecting the antennae
  positions are given.
 
  * x0 is the origo x-value
  * z0 is the origo z-value
  * x is the width of the profile measured from x0
  * z is the depth of the profile measured from z0
  * dtrn is the increment between the transmitter positions
  * drec is the increment between the receiver positions 
  * maxang is the largest accepted ray angle from horisontal
  
  * angle is the angles of the positions listed in antpos (in degrees)
  * dist is the distance between the transmitter and receiver position
 
  All units are in meter
 
  Knud S. Cordua (2008)
</fo:block></fo:block></fo:block><fo:block id="fwi_execute"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">fwi_execute</fo:marker><fo:block font-size="17.28pt">fwi_execute</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886875000544" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace"/></fo:block></fo:block><fo:block id="fwi_execute_parfor"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">fwi_execute_parfor</fo:marker><fo:block font-size="17.28pt">fwi_execute_parfor</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874999024" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace"/></fo:block></fo:block><fo:block id="image_snapshots"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">image_snapshots</fo:marker><fo:block font-size="17.28pt">image_snapshots</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874997440" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace"> -------------------- Make plot of snapshots ------------------------------
 
  Call: data=image_snapshots(sample_rate,Nplot,Ntrn,Nrow,gain,dx,dt,field);
 
  * sample_rate: The rate of time-steps at which snapshots are written to
    the disk during the FDTD forward modelling
  * Nplot: The number of snapshots to be plotted starting from 1, or the interval of
    snapshots to be plotted given as a vector.
  * Ntrn: The transmitter number (starting with 0) from which the snapshots
    are plotted
  * Nrow: Numer of plots/row
  * gain: A gain factor used to amplify the snapshots as function of the
    snapshot number. The amplification is obtained by scaling the initial
    color axis with the factor g=(i*(gain+1))^-2. For a gain factor of 0
    now amplifcation is applied to the snapshot.
  * dx: The cell size (only needed to obtain the correct axis in the images)
  * dt: Used to determine the time of the snapshots
  * field: The direction of the eletrical field 1: Ez, 2: Ex 
 
  Knud Cordua (2008)
 
 --------------------------------------------------------------------------
</fo:block></fo:block></fo:block><fo:block id="iseven"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">iseven</fo:marker><fo:block font-size="17.28pt">iseven</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874994848" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  Call: eo=iseven(input_array);
  This function outputs 1 if the length of the input array is an even
  number. If on the other hand the length of the input array is odd the
  function outputs 0.
  Knud S. Cordua, 2010
</fo:block></fo:block></fo:block><fo:block id="load2Dbin"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">load2Dbin</fo:marker><fo:block font-size="17.28pt">load2Dbin</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874992928" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  =========================================================================
  FUNCTION [ nx, nz, data] = load2Dbin( fpath, fname);
  This function simply loads a 2D matrix from a binary file. It requires
  the following info: - fpath : location of the binary file
                      - fname : name of the binary file
  Remark: if only one input argument is given, the function assumes that it
  contains info about path AND filename!!
 
  And it returns:     - nx    : amount of elements in x-direction
                      - nz    : amount of elements in z-direction (or y-)
                      - data  : 2-D data stored in the file.
  
  By Jacques Ernst (2006)                                        ETH Zurich
 ==========================================================================
</fo:block></fo:block></fo:block><fo:block id="load_wavelet"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">load_wavelet</fo:marker><fo:block font-size="17.28pt">load_wavelet</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874990624" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  load_wavelet: load wavelet for FDTD_fwi
 
  Call: [data,dt]=load_wavelet(fname);
 
  Input:
     - fname [def='source.E']: name (and optionally full path) of the binary file
  Output
     - data  : 1-D data stored in the file.
     - dt    : sample interval
</fo:block></fo:block></fo:block><fo:block id="resize"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">resize</fo:marker><fo:block font-size="17.28pt">resize</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874988480" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  Call: A_out=resize(A_in,factor);
  * A_in is the input array
  * A_out is the output array
  * factor is the factor by which the sides of the input array cells are refined
    or coarsened: factor &gt; 1 = The array is refined; factor &lt; 1 = The array is coarsened
 
  KSC (2009)

    Other functions named resize

       axisobj/resize
</fo:block></fo:block></fo:block><fo:block id="save1Dbin"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">save1Dbin</fo:marker><fo:block font-size="17.28pt">save1Dbin</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874986480" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  =========================================================================
  FUNCTION save2Dbin( fpath, fname, nx, nz, data);
  This function simply saves a 2D matrix to a binary file. It requires the
  following info: - fpath : location of the binary file
                  - fname : name of the binary file
                  - nx    : amount of elements in x-direction
                  - nz    : amount of elements in z-direction (or y-)
                  - data  : 2-D data stored in the file.
  
  By Jacques Ernst (2006)                                        ETH Zurich
 ==========================================================================
</fo:block></fo:block></fo:block><fo:block id="save2Dbin"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">save2Dbin</fo:marker><fo:block font-size="17.28pt">save2Dbin</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874984384" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  =========================================================================
  FUNCTION save2Dbin( fpath, fname, nx, nz, data);
  This function simply saves a 2D matrix to a binary file. It requires the
  following info: - fpath : location of the binary file
                  - fname : name of the binary file
                  - nx    : amount of elements in x-direction
                  - nz    : amount of elements in z-direction (or y-)
                  - data  : 2-D data stored in the file.
  
  By Jacques Ernst (2006)                                        ETH Zurich
 ==========================================================================
</fo:block></fo:block></fo:block><fo:block id="save_wavelet"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">save_wavelet</fo:marker><fo:block font-size="17.28pt">save_wavelet</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874982032" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  save_wavelet: save wavelet for FDTD_fwi
 
  Call:
     save_wavelet(data,dt,fname)
  Input:
        - data  : 1-D data stored in the file.
        - dt    : sample interval
       - fname : name of the binary file (def='source.E');
  
  By Knud Cordua (2008)                                       
</fo:block></fo:block></fo:block><fo:block id="setup_input_parameters"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">setup_input_parameters</fo:marker><fo:block font-size="17.28pt">setup_input_parameters</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874980288" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace"/></fo:block></fo:block><fo:block id="shift_signal"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">shift_signal</fo:marker><fo:block font-size="17.28pt">shift_signal</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874978576" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  FFT 2D -&gt; 3D:
</fo:block></fo:block></fo:block><fo:block id="sippi_forward_gpr_fd"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_forward_gpr_fd</fo:marker><fo:block font-size="17.28pt">sippi_forward_gpr_fd</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874977152" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_forward_gpr_fd: full waveform gpr forward
 
  Call :
   [d,forward,prior,data]=sippi_forward_gpr_fd(m,forward,prior,data,id,im)
 
   the prior must be such that m{1} relfect the eps field, and (optionally)
   m{2} reflect the sig field (if not set it is trated as constant).
  
  % Mandatory 
  forward.sources and forward.receivers contains the position of sources
     and receives ising the SAME coordinate systrem as prior{im}
 
  forward.sources : [Sx1 Sy1
                     Sx2 Sy2
                     ..]
  forward.receivers: [Rx1 Ry1
                     Rx2 Ry2
                     ..]
 
 
  forward.ant_pos contains the positions in a grid with origin [0,0]
                This is computed from forward.sources and forward.receivers
                if not set.
  forward.ant_pos: antenna postions for receivers and recorders
                   [Sx1, Sy1, Rx1, Ry1    
                    Sx2, Sy2, Rx2, Ry2
                    ..];
 
  ! Note that idential source locations muyst be located in neighboring row
  in forward.ant_pos
 
 
  Optional settings
  forward.T=100*10^-9; % Frequecy of source wavelet
  forward.sig=3; % If not set it is set as a constant field
  forward.output_type='shot'; % each shot gather is output as individual data structures
  forward.output_type='trace'; % each trace is output as individual data structures
  forward.output_it=10; % only output every 'output_it' time sample
 
 
  forward.dx_forward % the spatial sampling used for FDTD modeling
                       If this is different than the spatial sampling
                       density for the prior, then prior realizations are
                       rescaled before forward modeling
 
 
  % Settings for forward modeler
  All seetings for the forward modelling code can be set in the 
  forward.addpar structure. E.g to set the number of threads used:
  forward.addpar.cores=4;%
 
 
  See also FDTD_fwi
 
 
</fo:block></fo:block></fo:block><fo:block id="sippi_gpr_fd_example"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_gpr_fd_example</fo:marker><fo:block font-size="17.28pt">sippi_gpr_fd_example</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874973632" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_setup_gpr_fd: Inversion of full waveform GPR data.
 
 
  /REF/See also
     https://sites.google.com/site/kscordua/downloads/tomographic-full-waveform-inversion
     Ernst, J. R., H. Maurer, A. G. Green, and K. Holliger, 2007, Full-waveform inversion of crosshole radar data based on 2-D finite-difference time domain solutions of Maxwells equations: IEEE Transactions on Geoscience and Remote Sensing, 45, 28072828.
     Cordua, K. S., T. M. Hansen, and K. Mosegaard, 2012. Monte Carlo full waveform inversion of crosshole GPR data using multiple-point geostatistical a priori information. Geophysics, 77(2), H19  H31.
 
 % PRIOR 
</fo:block></fo:block></fo:block><fo:block id="sippi_plot_data_gpr"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_plot_data_gpr</fo:marker><fo:block font-size="17.28pt">sippi_plot_data_gpr</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874971440" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_plot_data_gpr: plot GPR data
                   overwrites sippi_plot_data plot data in SIPPI
 
  Call.
     sippi_plot_data_gpr(d,data);
     sippi_plot_data_gpr(d,data,id_arr);
 
</fo:block></fo:block></fo:block><fo:block id="velocity_to_eps"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">velocity_to_eps</fo:marker><fo:block font-size="17.28pt">velocity_to_eps</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874969520" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  velocity_to_eps
 
  eps_r is the relative dieletric permittivity
  v is the velocity of the phase (m/ns)
 
  sig is the eletrical conductivity measured in mS/m
  f is the frequency. If f is set to 0 a high frequency approxiamtion is
  applied
 
  (C) Knud Cordua, 2016, Thomas Mejer Hansen, 2016
 
</fo:block></fo:block></fo:block><fo:block id="write_parameters_to_screen"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">write_parameters_to_screen</fo:marker><fo:block font-size="17.28pt">write_parameters_to_screen</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874967808" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace"/></fo:block></fo:block></fo:block><fo:block id="idm45886875024048"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">SIPPI toolbox: Covariance inference</fo:marker><fo:block font-size="20.736pt">SIPPI toolbox: Covariance inference</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"/><fo:block id="sippi_forward_covariance_inference"><fo:block><fo:block><fo:block margin-left="0pt" font-family="sans-serif,Symbol,ZapfDingbats" keep-together.within-column="always"><fo:block keep-with-next.within-column="always"><fo:block font-family="sans-serif,Symbol,ZapfDingbats" font-weight="bold" keep-with-next.within-column="always" space-before.minimum="0.8em" space-before.optimum="1.0em" space-before.maximum="1.2em" text-align="start" start-indent="0pt"><fo:marker marker-class-name="section.head.marker">sippi_forward_covariance_inference</fo:marker><fo:block font-size="17.28pt">sippi_forward_covariance_inference</fo:block></fo:block></fo:block></fo:block></fo:block></fo:block><fo:block space-before.optimum="1em" space-before.minimum="0.8em" space-before.maximum="1.2em"><fo:block id="idm45886874965776" text-align="start" wrap-option="no-wrap" space-before.minimum="0.8em" space-before.optimum="1em" space-before.maximum="1.2em" space-after.minimum="0.8em" space-after.optimum="1em" space-after.maximum="1.2em" hyphenate="false" white-space-collapse="false" white-space-treatment="preserve" linefeed-treatment="preserve" font-family="monospace">  sippi_forward_covariance_inference : Probabilitsic covariance inference
 
  Call :
   [d,forward,prior,data]=sippi_forward_covariance_inference(m,forward,prior,data,id,im)
 
 
   forward.pos_known : [x' y' z'],  [ndata,ndim] with position of observed data
   forward.G : Forward operator
 
   Prior covariance model, N(m0,Cm) is chosen as
   forward.m0 : initial mean model
   forward.Cm/forward.Va : inital covariance model
 
   prior{im}.m0
   prior{im}.type (round(type) is itype)
   prior{im}.range_1
   prior{im}.range_2
   prior{im}.range_3
   prior{im}.ang_1
   prior{im}.ang_2
   prior{im}.ang_3
   prior{im}.sill
   prior{im}.nugget_fraction
 
  See Hansen et al. (2014). A general probabilistic approach for inference of Gaussian model parameters from noisy data of point and volume support. 
  Mathematical Geosciences 47(7), pp 843-865. published online 09-2014. doi:10.1007/s11004-014-9567-5 
 
  See also: sippi_forward
 
</fo:block></fo:block></fo:block></fo:block></fo:flow></fo:page-sequence>



</fo:root>