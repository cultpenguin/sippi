<para>
SIPPI can be used as a convenient approach for unconditional an conditional simulation.
</para>
<para>
In ordet to use SIPPI to solve inverse problems, one must provide the solution to the forward problem. Essentially this amounts to implementing a Matlab function that solves the <link linkend="chapforward">forward problem</link> in using a specific input/output format. If a solution to the forward problem allready exist, this can be quite easily done simply using a Matlab wrapper function. 
<!-- <link linkend="sippi_forward">forward problem</link> -->
</para>
<para>
A few implementations of solutions to forward problems are included as examples as part of SIPPI. These will be demonstrated in the following 
</para>

<sect1 xml:id="sec_ex_prior"><title>Examples of A priori models</title>
<para>
A prior model consisting of three independent 1D distributions (a Gaussian, Laplace, and Uniform distribution) can be defined using
</para>
<screen>
ip=1;
prior{ip}.type='GAUSSIAN';
prior{ip}.name='Gaussian';
prior{ip}.m0=10;
prior{ip}.std=2;

ip=2;
prior{ip}.type='GAUSSIAN';
prior{ip}.name='Laplace';
prior{ip}.m0=10;
prior{ip}.std=2;
prior{ip}.norm=1;

ip=3;
prior{ip}.type='GAUSSIAN';
prior{ip}.name='Uniform';
prior{ip}.m0=10;
prior{ip}.std=2;
prior{ip}.norm=60;

m=sippi_prior(prior);

m = 

    [14.3082]    [9.4436]    [10.8294]
</screen>
<para>1D histograms of a sample (consisting of 1000 realizations) of the prior models can be visualized using 
</para>
<screen>
sippi_plot_prior_sample(prior);
</screen>
    <mediaobject>
      <imageobject condition="web">
        <imagedata fileref="figures/prior_gaussian_1d_Gaussian.png" width="4in" depth="3in" scalefit="1"/>
      </imageobject>
      <textobject><phrase></phrase></textobject>
    </mediaobject>
</sect1>

<!-- POLY LINE FITTING -->
<sect1 xml:id="sec_ex_linefit"><title>Polynomial line fitting</title>
<para>
Here simple ploynomial (or order 0, 1 or 2) line-fitting is considered.
</para>
<para>
First, the forward problem is defined. Then examples of stochastic inversion using SIPPI is demonstrated using a a synthetic data set.
</para>

<sect2 xml:id="linefit_forward"><title>The forward problem</title>
<para>
The forward problem consists of computing the y-value as a function of the x-position of the data, and the polynomial coefficients determining the line. <link linkend="sippi_forward_linefit">sippi_forward_linefit.m</link>:
<screen xml:id="sippi_forward_linefit">
% sippi_forward_linefit Line fit forward solver for SIPPI 
%
% [d,forward,prior,data]=sippi_forward_linefit(m,forward,prior,data);
%
function [d,forward,prior,data]=sippi_forward_linefit(m,forward,prior,data);

if length(m)==1;
    d{1}=forward.x*m{1};
elseif length(m)==2;
    d{1}=forward.x*m{1}+m{2};
else
    d{1}=forward.x.^2*m{1}+forward.x*m{2}+m{3};
end
</screen>
the <varname>forward.x</varname> must be an array of the x-locations, for which the y-values of the correspsonding line will be evaluated.
</para>
<para>
Note that the prior must be defined such that <varname>prior{1}</varname> refer to the intercept, <varname>prior{2}</varname> to the gradient, and <varname>prior{3}</varname> to the 2nd order polynomial coefficient.
</para>
<para>
If only one prior type is defined then the forward respons will just be a constant, and if two prior types are defined, then the forward respone will be a straight line.
</para>

</sect2>


<sect2 xml:id="linefit_data"><title>Reference data</title>
<para>
</para>
<screen>
rand('seed',1);randn('seed',1);

grad=2;
intercept=-30;
poly2=0;

nd=40;
x=linspace(1,20,nd)';
d_obs=x.^2.*poly2+x.*grad+intercept;

d_std=10;
d_obs=d_obs+randn(size(d_obs)).*d_std;

%
data{1}.d_obs=d_obs;
data{1}.d_std=d_std;

%% Setup the forward model in the 'forward' structure
forward.x=D.x;
forward.forward_function='sippi_forward_linefit';

%% Set up the 'data' structure
data{1}.d_std=D.d_std;
data{1}.d_obs=D.d_obs;


</screen>
</sect2>

</sect1>

<!--
<sect1 xml:id="sec_ex_covariance_inference"><title>Covariance model inference</title>
<para>
</para>
</sect1>
-->
<sect1 xml:id="sec_ex_tomography"><title>Cross hole tomography</title>
<para>
</para>
</sect1>

<!--
<sect1 xml:id="sec_ex_reflection"><title>Reflection seismic inversion</title>
<para>
</para>
</sect1>
-->
